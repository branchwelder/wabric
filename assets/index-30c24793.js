(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const c of u)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&l(p)}).observe(document,{childList:!0,subtree:!0});function o(u){const c={};return u.integrity&&(c.integrity=u.integrity),u.referrerPolicy&&(c.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?c.credentials="include":u.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(u){if(u.ep)return;u.ep=!0;const c=o(u);fetch(u.href,c)}})();var Fu={value:()=>{}};function xn(){for(var r=0,s=arguments.length,o={},l;r<s;++r){if(!(l=arguments[r]+"")||l in o||/[\s.]/.test(l))throw new Error("illegal type: "+l);o[l]=[]}return new pn(o)}function pn(r){this._=r}function Ku(r,s){return r.trim().split(/^|\s+/).map(function(o){var l="",u=o.indexOf(".");if(u>=0&&(l=o.slice(u+1),o=o.slice(0,u)),o&&!s.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:l}})}pn.prototype=xn.prototype={constructor:pn,on:function(r,s){var o=this._,l=Ku(r+"",o),u,c=-1,p=l.length;if(arguments.length<2){for(;++c<p;)if((u=(r=l[c]).type)&&(u=Uu(o[u],r.name)))return u;return}if(s!=null&&typeof s!="function")throw new Error("invalid callback: "+s);for(;++c<p;)if(u=(r=l[c]).type)o[u]=as(o[u],r.name,s);else if(s==null)for(u in o)o[u]=as(o[u],r.name,null);return this},copy:function(){var r={},s=this._;for(var o in s)r[o]=s[o].slice();return new pn(r)},call:function(r,s){if((u=arguments.length-2)>0)for(var o=new Array(u),l=0,u,c;l<u;++l)o[l]=arguments[l+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(c=this._[r],l=0,u=c.length;l<u;++l)c[l].value.apply(s,o)},apply:function(r,s,o){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var l=this._[r],u=0,c=l.length;u<c;++u)l[u].value.apply(s,o)}};function Uu(r,s){for(var o=0,l=r.length,u;o<l;++o)if((u=r[o]).name===s)return u.value}function as(r,s,o){for(var l=0,u=r.length;l<u;++l)if(r[l].name===s){r[l]=Fu,r=r.slice(0,l).concat(r.slice(l+1));break}return o!=null&&r.push({name:s,value:o}),r}var hr="http://www.w3.org/1999/xhtml";const ls={svg:"http://www.w3.org/2000/svg",xhtml:hr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function yn(r){var s=r+="",o=s.indexOf(":");return o>=0&&(s=r.slice(0,o))!=="xmlns"&&(r=r.slice(o+1)),ls.hasOwnProperty(s)?{space:ls[s],local:r}:r}function Hu(r){return function(){var s=this.ownerDocument,o=this.namespaceURI;return o===hr&&s.documentElement.namespaceURI===hr?s.createElement(r):s.createElementNS(o,r)}}function ju(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function Vs(r){var s=yn(r);return(s.local?ju:Hu)(s)}function zu(){}function xr(r){return r==null?zu:function(){return this.querySelector(r)}}function qu(r){typeof r!="function"&&(r=xr(r));for(var s=this._groups,o=s.length,l=new Array(o),u=0;u<o;++u)for(var c=s[u],p=c.length,d=l[u]=new Array(p),m,f,v=0;v<p;++v)(m=c[v])&&(f=r.call(m,m.__data__,v,c))&&("__data__"in m&&(f.__data__=m.__data__),d[v]=f);return new Z(l,this._parents)}function Ss(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function Gu(){return[]}function As(r){return r==null?Gu:function(){return this.querySelectorAll(r)}}function Yu(r){return function(){return Ss(r.apply(this,arguments))}}function Xu(r){typeof r=="function"?r=Yu(r):r=As(r);for(var s=this._groups,o=s.length,l=[],u=[],c=0;c<o;++c)for(var p=s[c],d=p.length,m,f=0;f<d;++f)(m=p[f])&&(l.push(r.call(m,m.__data__,f,p)),u.push(m));return new Z(l,u)}function Ms(r){return function(){return this.matches(r)}}function Ns(r){return function(s){return s.matches(r)}}var Wu=Array.prototype.find;function Qu(r){return function(){return Wu.call(this.children,r)}}function Ju(){return this.firstElementChild}function Zu(r){return this.select(r==null?Ju:Qu(typeof r=="function"?r:Ns(r)))}var tc=Array.prototype.filter;function ec(){return Array.from(this.children)}function nc(r){return function(){return tc.call(this.children,r)}}function rc(r){return this.selectAll(r==null?ec:nc(typeof r=="function"?r:Ns(r)))}function ic(r){typeof r!="function"&&(r=Ms(r));for(var s=this._groups,o=s.length,l=new Array(o),u=0;u<o;++u)for(var c=s[u],p=c.length,d=l[u]=[],m,f=0;f<p;++f)(m=c[f])&&r.call(m,m.__data__,f,c)&&d.push(m);return new Z(l,this._parents)}function Ls(r){return new Array(r.length)}function sc(){return new Z(this._enter||this._groups.map(Ls),this._parents)}function fn(r,s){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=s}fn.prototype={constructor:fn,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,s){return this._parent.insertBefore(r,s)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function oc(r){return function(){return r}}function ac(r,s,o,l,u,c){for(var p=0,d,m=s.length,f=c.length;p<f;++p)(d=s[p])?(d.__data__=c[p],l[p]=d):o[p]=new fn(r,c[p]);for(;p<m;++p)(d=s[p])&&(u[p]=d)}function lc(r,s,o,l,u,c,p){var d,m,f=new Map,v=s.length,_=c.length,x=new Array(v),y;for(d=0;d<v;++d)(m=s[d])&&(x[d]=y=p.call(m,m.__data__,d,s)+"",f.has(y)?u[d]=m:f.set(y,m));for(d=0;d<_;++d)y=p.call(r,c[d],d,c)+"",(m=f.get(y))?(l[d]=m,m.__data__=c[d],f.delete(y)):o[d]=new fn(r,c[d]);for(d=0;d<v;++d)(m=s[d])&&f.get(x[d])===m&&(u[d]=m)}function uc(r){return r.__data__}function cc(r,s){if(!arguments.length)return Array.from(this,uc);var o=s?lc:ac,l=this._parents,u=this._groups;typeof r!="function"&&(r=oc(r));for(var c=u.length,p=new Array(c),d=new Array(c),m=new Array(c),f=0;f<c;++f){var v=l[f],_=u[f],x=_.length,y=pc(r.call(v,v&&v.__data__,f,l)),S=y.length,w=d[f]=new Array(S),C=p[f]=new Array(S),V=m[f]=new Array(x);o(v,_,w,C,V,y,s);for(var E=0,L=0,g,M;E<S;++E)if(g=w[E]){for(E>=L&&(L=E+1);!(M=C[L])&&++L<S;);g._next=M||null}}return p=new Z(p,l),p._enter=d,p._exit=m,p}function pc(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function hc(){return new Z(this._exit||this._groups.map(Ls),this._parents)}function dc(r,s,o){var l=this.enter(),u=this,c=this.exit();return typeof r=="function"?(l=r(l),l&&(l=l.selection())):l=l.append(r+""),s!=null&&(u=s(u),u&&(u=u.selection())),o==null?c.remove():o(c),l&&u?l.merge(u).order():u}function fc(r){for(var s=r.selection?r.selection():r,o=this._groups,l=s._groups,u=o.length,c=l.length,p=Math.min(u,c),d=new Array(u),m=0;m<p;++m)for(var f=o[m],v=l[m],_=f.length,x=d[m]=new Array(_),y,S=0;S<_;++S)(y=f[S]||v[S])&&(x[S]=y);for(;m<u;++m)d[m]=o[m];return new Z(d,this._parents)}function vc(){for(var r=this._groups,s=-1,o=r.length;++s<o;)for(var l=r[s],u=l.length-1,c=l[u],p;--u>=0;)(p=l[u])&&(c&&p.compareDocumentPosition(c)^4&&c.parentNode.insertBefore(p,c),c=p);return this}function mc(r){r||(r=bc);function s(_,x){return _&&x?r(_.__data__,x.__data__):!_-!x}for(var o=this._groups,l=o.length,u=new Array(l),c=0;c<l;++c){for(var p=o[c],d=p.length,m=u[c]=new Array(d),f,v=0;v<d;++v)(f=p[v])&&(m[v]=f);m.sort(s)}return new Z(u,this._parents).order()}function bc(r,s){return r<s?-1:r>s?1:r>=s?0:NaN}function _c(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function gc(){return Array.from(this)}function wc(){for(var r=this._groups,s=0,o=r.length;s<o;++s)for(var l=r[s],u=0,c=l.length;u<c;++u){var p=l[u];if(p)return p}return null}function xc(){let r=0;for(const s of this)++r;return r}function yc(){return!this.node()}function Cc(r){for(var s=this._groups,o=0,l=s.length;o<l;++o)for(var u=s[o],c=0,p=u.length,d;c<p;++c)(d=u[c])&&r.call(d,d.__data__,c,u);return this}function Pc(r){return function(){this.removeAttribute(r)}}function Ec(r){return function(){this.removeAttributeNS(r.space,r.local)}}function kc(r,s){return function(){this.setAttribute(r,s)}}function Vc(r,s){return function(){this.setAttributeNS(r.space,r.local,s)}}function Sc(r,s){return function(){var o=s.apply(this,arguments);o==null?this.removeAttribute(r):this.setAttribute(r,o)}}function Ac(r,s){return function(){var o=s.apply(this,arguments);o==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,o)}}function Mc(r,s){var o=yn(r);if(arguments.length<2){var l=this.node();return o.local?l.getAttributeNS(o.space,o.local):l.getAttribute(o)}return this.each((s==null?o.local?Ec:Pc:typeof s=="function"?o.local?Ac:Sc:o.local?Vc:kc)(o,s))}function Ds(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function Nc(r){return function(){this.style.removeProperty(r)}}function Lc(r,s,o){return function(){this.style.setProperty(r,s,o)}}function Dc(r,s,o){return function(){var l=s.apply(this,arguments);l==null?this.style.removeProperty(r):this.style.setProperty(r,l,o)}}function Rc(r,s,o){return arguments.length>1?this.each((s==null?Nc:typeof s=="function"?Dc:Lc)(r,s,o??"")):ee(this.node(),r)}function ee(r,s){return r.style.getPropertyValue(s)||Ds(r).getComputedStyle(r,null).getPropertyValue(s)}function Tc(r){return function(){delete this[r]}}function Ic(r,s){return function(){this[r]=s}}function Oc(r,s){return function(){var o=s.apply(this,arguments);o==null?delete this[r]:this[r]=o}}function Bc(r,s){return arguments.length>1?this.each((s==null?Tc:typeof s=="function"?Oc:Ic)(r,s)):this.node()[r]}function Rs(r){return r.trim().split(/^|\s+/)}function yr(r){return r.classList||new Ts(r)}function Ts(r){this._node=r,this._names=Rs(r.getAttribute("class")||"")}Ts.prototype={add:function(r){var s=this._names.indexOf(r);s<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var s=this._names.indexOf(r);s>=0&&(this._names.splice(s,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function Is(r,s){for(var o=yr(r),l=-1,u=s.length;++l<u;)o.add(s[l])}function Os(r,s){for(var o=yr(r),l=-1,u=s.length;++l<u;)o.remove(s[l])}function $c(r){return function(){Is(this,r)}}function Fc(r){return function(){Os(this,r)}}function Kc(r,s){return function(){(s.apply(this,arguments)?Is:Os)(this,r)}}function Uc(r,s){var o=Rs(r+"");if(arguments.length<2){for(var l=yr(this.node()),u=-1,c=o.length;++u<c;)if(!l.contains(o[u]))return!1;return!0}return this.each((typeof s=="function"?Kc:s?$c:Fc)(o,s))}function Hc(){this.textContent=""}function jc(r){return function(){this.textContent=r}}function zc(r){return function(){var s=r.apply(this,arguments);this.textContent=s??""}}function qc(r){return arguments.length?this.each(r==null?Hc:(typeof r=="function"?zc:jc)(r)):this.node().textContent}function Gc(){this.innerHTML=""}function Yc(r){return function(){this.innerHTML=r}}function Xc(r){return function(){var s=r.apply(this,arguments);this.innerHTML=s??""}}function Wc(r){return arguments.length?this.each(r==null?Gc:(typeof r=="function"?Xc:Yc)(r)):this.node().innerHTML}function Qc(){this.nextSibling&&this.parentNode.appendChild(this)}function Jc(){return this.each(Qc)}function Zc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function tp(){return this.each(Zc)}function ep(r){var s=typeof r=="function"?r:Vs(r);return this.select(function(){return this.appendChild(s.apply(this,arguments))})}function np(){return null}function rp(r,s){var o=typeof r=="function"?r:Vs(r),l=s==null?np:typeof s=="function"?s:xr(s);return this.select(function(){return this.insertBefore(o.apply(this,arguments),l.apply(this,arguments)||null)})}function ip(){var r=this.parentNode;r&&r.removeChild(this)}function sp(){return this.each(ip)}function op(){var r=this.cloneNode(!1),s=this.parentNode;return s?s.insertBefore(r,this.nextSibling):r}function ap(){var r=this.cloneNode(!0),s=this.parentNode;return s?s.insertBefore(r,this.nextSibling):r}function lp(r){return this.select(r?ap:op)}function up(r){return arguments.length?this.property("__data__",r):this.node().__data__}function cp(r){return function(s){r.call(this,s,this.__data__)}}function pp(r){return r.trim().split(/^|\s+/).map(function(s){var o="",l=s.indexOf(".");return l>=0&&(o=s.slice(l+1),s=s.slice(0,l)),{type:s,name:o}})}function hp(r){return function(){var s=this.__on;if(s){for(var o=0,l=-1,u=s.length,c;o<u;++o)c=s[o],(!r.type||c.type===r.type)&&c.name===r.name?this.removeEventListener(c.type,c.listener,c.options):s[++l]=c;++l?s.length=l:delete this.__on}}}function dp(r,s,o){return function(){var l=this.__on,u,c=cp(s);if(l){for(var p=0,d=l.length;p<d;++p)if((u=l[p]).type===r.type&&u.name===r.name){this.removeEventListener(u.type,u.listener,u.options),this.addEventListener(u.type,u.listener=c,u.options=o),u.value=s;return}}this.addEventListener(r.type,c,o),u={type:r.type,name:r.name,value:s,listener:c,options:o},l?l.push(u):this.__on=[u]}}function fp(r,s,o){var l=pp(r+""),u,c=l.length,p;if(arguments.length<2){var d=this.node().__on;if(d){for(var m=0,f=d.length,v;m<f;++m)for(u=0,v=d[m];u<c;++u)if((p=l[u]).type===v.type&&p.name===v.name)return v.value}return}for(d=s?dp:hp,u=0;u<c;++u)this.each(d(l[u],s,o));return this}function Bs(r,s,o){var l=Ds(r),u=l.CustomEvent;typeof u=="function"?u=new u(s,o):(u=l.document.createEvent("Event"),o?(u.initEvent(s,o.bubbles,o.cancelable),u.detail=o.detail):u.initEvent(s,!1,!1)),r.dispatchEvent(u)}function vp(r,s){return function(){return Bs(this,r,s)}}function mp(r,s){return function(){return Bs(this,r,s.apply(this,arguments))}}function bp(r,s){return this.each((typeof s=="function"?mp:vp)(r,s))}function*_p(){for(var r=this._groups,s=0,o=r.length;s<o;++s)for(var l=r[s],u=0,c=l.length,p;u<c;++u)(p=l[u])&&(yield p)}var Cr=[null];function Z(r,s){this._groups=r,this._parents=s}function Ke(){return new Z([[document.documentElement]],Cr)}function gp(){return this}Z.prototype=Ke.prototype={constructor:Z,select:qu,selectAll:Xu,selectChild:Zu,selectChildren:rc,filter:ic,data:cc,enter:sc,exit:hc,join:dc,merge:fc,selection:gp,order:vc,sort:mc,call:_c,nodes:gc,node:wc,size:xc,empty:yc,each:Cc,attr:Mc,style:Rc,property:Bc,classed:Uc,text:qc,html:Wc,raise:Jc,lower:tp,append:ep,insert:rp,remove:sp,clone:lp,datum:up,on:fp,dispatch:bp,[Symbol.iterator]:_p};function Ne(r){return typeof r=="string"?new Z([[document.querySelector(r)]],[document.documentElement]):new Z([[r]],Cr)}function wp(r){let s;for(;s=r.sourceEvent;)r=s;return r}function us(r,s){if(r=wp(r),s===void 0&&(s=r.currentTarget),s){var o=s.ownerSVGElement||s;if(o.createSVGPoint){var l=o.createSVGPoint();return l.x=r.clientX,l.y=r.clientY,l=l.matrixTransform(s.getScreenCTM().inverse()),[l.x,l.y]}if(s.getBoundingClientRect){var u=s.getBoundingClientRect();return[r.clientX-u.left-s.clientLeft,r.clientY-u.top-s.clientTop]}}return[r.pageX,r.pageY]}function Ue(r){return typeof r=="string"?new Z([document.querySelectorAll(r)],[document.documentElement]):new Z([Ss(r)],Cr)}const xp={passive:!1},Le={capture:!0,passive:!1};function ur(r){r.stopImmediatePropagation()}function Zt(r){r.preventDefault(),r.stopImmediatePropagation()}function yp(r){var s=r.document.documentElement,o=Ne(r).on("dragstart.drag",Zt,Le);"onselectstart"in s?o.on("selectstart.drag",Zt,Le):(s.__noselect=s.style.MozUserSelect,s.style.MozUserSelect="none")}function Cp(r,s){var o=r.document.documentElement,l=Ne(r).on("dragstart.drag",null);s&&(l.on("click.drag",Zt,Le),setTimeout(function(){l.on("click.drag",null)},0)),"onselectstart"in o?l.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}const an=r=>()=>r;function dr(r,{sourceEvent:s,subject:o,target:l,identifier:u,active:c,x:p,y:d,dx:m,dy:f,dispatch:v}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:s,enumerable:!0,configurable:!0},subject:{value:o,enumerable:!0,configurable:!0},target:{value:l,enumerable:!0,configurable:!0},identifier:{value:u,enumerable:!0,configurable:!0},active:{value:c,enumerable:!0,configurable:!0},x:{value:p,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:m,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:v}})}dr.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function Pp(r){return!r.ctrlKey&&!r.button}function Ep(){return this.parentNode}function kp(r,s){return s??{x:r.x,y:r.y}}function Vp(){return navigator.maxTouchPoints||"ontouchstart"in this}function $s(){var r=Pp,s=Ep,o=kp,l=Vp,u={},c=xn("start","drag","end"),p=0,d,m,f,v,_=0;function x(g){g.on("mousedown.drag",y).filter(l).on("touchstart.drag",C).on("touchmove.drag",V,xp).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(g,M){if(!(v||!r.call(this,g,M))){var O=L(this,s.call(this,g,M),g,M,"mouse");O&&(Ne(g.view).on("mousemove.drag",S,Le).on("mouseup.drag",w,Le),yp(g.view),ur(g),f=!1,d=g.clientX,m=g.clientY,O("start",g))}}function S(g){if(Zt(g),!f){var M=g.clientX-d,O=g.clientY-m;f=M*M+O*O>_}u.mouse("drag",g)}function w(g){Ne(g.view).on("mousemove.drag mouseup.drag",null),Cp(g.view,f),Zt(g),u.mouse("end",g)}function C(g,M){if(r.call(this,g,M)){var O=g.changedTouches,T=s.call(this,g,M),R=O.length,j,B;for(j=0;j<R;++j)(B=L(this,T,g,M,O[j].identifier,O[j]))&&(ur(g),B("start",g,O[j]))}}function V(g){var M=g.changedTouches,O=M.length,T,R;for(T=0;T<O;++T)(R=u[M[T].identifier])&&(Zt(g),R("drag",g,M[T]))}function E(g){var M=g.changedTouches,O=M.length,T,R;for(v&&clearTimeout(v),v=setTimeout(function(){v=null},500),T=0;T<O;++T)(R=u[M[T].identifier])&&(ur(g),R("end",g,M[T]))}function L(g,M,O,T,R,j){var B=c.copy(),H=us(j||O,M),W,nt,Dt;if((Dt=o.call(g,new dr("beforestart",{sourceEvent:O,target:x,identifier:R,active:p,x:H[0],y:H[1],dx:0,dy:0,dispatch:B}),T))!=null)return W=Dt.x-H[0]||0,nt=Dt.y-H[1]||0,function En(ie,z,D){var ze=H,se;switch(ie){case"start":u[R]=En,se=p++;break;case"end":delete u[R],--p;case"drag":H=us(D||z,M),se=p;break}B.call(ie,g,new dr(ie,{sourceEvent:z,subject:Dt,target:x,identifier:R,active:se,x:H[0]+W,y:H[1]+nt,dx:H[0]-ze[0],dy:H[1]-ze[1],dispatch:B}),T)}}return x.filter=function(g){return arguments.length?(r=typeof g=="function"?g:an(!!g),x):r},x.container=function(g){return arguments.length?(s=typeof g=="function"?g:an(g),x):s},x.subject=function(g){return arguments.length?(o=typeof g=="function"?g:an(g),x):o},x.touchable=function(g){return arguments.length?(l=typeof g=="function"?g:an(!!g),x):l},x.on=function(){var g=c.on.apply(c,arguments);return g===c?x:g},x.clickDistance=function(g){return arguments.length?(_=(g=+g)*g,x):Math.sqrt(_)},x}function Pr(r,s,o){r.prototype=s.prototype=o,o.constructor=r}function Fs(r,s){var o=Object.create(r.prototype);for(var l in s)o[l]=s[l];return o}function He(){}var De=.7,vn=1/De,te="\\s*([+-]?\\d+)\\s*",Re="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ht="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Sp=/^#([0-9a-f]{3,8})$/,Ap=new RegExp(`^rgb\\(${te},${te},${te}\\)$`),Mp=new RegExp(`^rgb\\(${ht},${ht},${ht}\\)$`),Np=new RegExp(`^rgba\\(${te},${te},${te},${Re}\\)$`),Lp=new RegExp(`^rgba\\(${ht},${ht},${ht},${Re}\\)$`),Dp=new RegExp(`^hsl\\(${Re},${ht},${ht}\\)$`),Rp=new RegExp(`^hsla\\(${Re},${ht},${ht},${Re}\\)$`),cs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Pr(He,Te,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:ps,formatHex:ps,formatHex8:Tp,formatHsl:Ip,formatRgb:hs,toString:hs});function ps(){return this.rgb().formatHex()}function Tp(){return this.rgb().formatHex8()}function Ip(){return Ks(this).formatHsl()}function hs(){return this.rgb().formatRgb()}function Te(r){var s,o;return r=(r+"").trim().toLowerCase(),(s=Sp.exec(r))?(o=s[1].length,s=parseInt(s[1],16),o===6?ds(s):o===3?new it(s>>8&15|s>>4&240,s>>4&15|s&240,(s&15)<<4|s&15,1):o===8?ln(s>>24&255,s>>16&255,s>>8&255,(s&255)/255):o===4?ln(s>>12&15|s>>8&240,s>>8&15|s>>4&240,s>>4&15|s&240,((s&15)<<4|s&15)/255):null):(s=Ap.exec(r))?new it(s[1],s[2],s[3],1):(s=Mp.exec(r))?new it(s[1]*255/100,s[2]*255/100,s[3]*255/100,1):(s=Np.exec(r))?ln(s[1],s[2],s[3],s[4]):(s=Lp.exec(r))?ln(s[1]*255/100,s[2]*255/100,s[3]*255/100,s[4]):(s=Dp.exec(r))?ms(s[1],s[2]/100,s[3]/100,1):(s=Rp.exec(r))?ms(s[1],s[2]/100,s[3]/100,s[4]):cs.hasOwnProperty(r)?ds(cs[r]):r==="transparent"?new it(NaN,NaN,NaN,0):null}function ds(r){return new it(r>>16&255,r>>8&255,r&255,1)}function ln(r,s,o,l){return l<=0&&(r=s=o=NaN),new it(r,s,o,l)}function Op(r){return r instanceof He||(r=Te(r)),r?(r=r.rgb(),new it(r.r,r.g,r.b,r.opacity)):new it}function fr(r,s,o,l){return arguments.length===1?Op(r):new it(r,s,o,l??1)}function it(r,s,o,l){this.r=+r,this.g=+s,this.b=+o,this.opacity=+l}Pr(it,fr,Fs(He,{brighter(r){return r=r==null?vn:Math.pow(vn,r),new it(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?De:Math.pow(De,r),new it(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new it(Kt(this.r),Kt(this.g),Kt(this.b),mn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fs,formatHex:fs,formatHex8:Bp,formatRgb:vs,toString:vs}));function fs(){return`#${Ft(this.r)}${Ft(this.g)}${Ft(this.b)}`}function Bp(){return`#${Ft(this.r)}${Ft(this.g)}${Ft(this.b)}${Ft((isNaN(this.opacity)?1:this.opacity)*255)}`}function vs(){const r=mn(this.opacity);return`${r===1?"rgb(":"rgba("}${Kt(this.r)}, ${Kt(this.g)}, ${Kt(this.b)}${r===1?")":`, ${r})`}`}function mn(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function Kt(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Ft(r){return r=Kt(r),(r<16?"0":"")+r.toString(16)}function ms(r,s,o,l){return l<=0?r=s=o=NaN:o<=0||o>=1?r=s=NaN:s<=0&&(r=NaN),new lt(r,s,o,l)}function Ks(r){if(r instanceof lt)return new lt(r.h,r.s,r.l,r.opacity);if(r instanceof He||(r=Te(r)),!r)return new lt;if(r instanceof lt)return r;r=r.rgb();var s=r.r/255,o=r.g/255,l=r.b/255,u=Math.min(s,o,l),c=Math.max(s,o,l),p=NaN,d=c-u,m=(c+u)/2;return d?(s===c?p=(o-l)/d+(o<l)*6:o===c?p=(l-s)/d+2:p=(s-o)/d+4,d/=m<.5?c+u:2-c-u,p*=60):d=m>0&&m<1?0:p,new lt(p,d,m,r.opacity)}function $p(r,s,o,l){return arguments.length===1?Ks(r):new lt(r,s,o,l??1)}function lt(r,s,o,l){this.h=+r,this.s=+s,this.l=+o,this.opacity=+l}Pr(lt,$p,Fs(He,{brighter(r){return r=r==null?vn:Math.pow(vn,r),new lt(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?De:Math.pow(De,r),new lt(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,s=isNaN(r)||isNaN(this.s)?0:this.s,o=this.l,l=o+(o<.5?o:1-o)*s,u=2*o-l;return new it(cr(r>=240?r-240:r+120,u,l),cr(r,u,l),cr(r<120?r+240:r-120,u,l),this.opacity)},clamp(){return new lt(bs(this.h),un(this.s),un(this.l),mn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=mn(this.opacity);return`${r===1?"hsl(":"hsla("}${bs(this.h)}, ${un(this.s)*100}%, ${un(this.l)*100}%${r===1?")":`, ${r})`}`}}));function bs(r){return r=(r||0)%360,r<0?r+360:r}function un(r){return Math.max(0,Math.min(1,r||0))}function cr(r,s,o){return(r<60?s+(o-s)*r/60:r<180?o:r<240?s+(o-s)*(240-r)/60:s)*255}const Us=r=>()=>r;function Fp(r,s){return function(o){return r+o*s}}function Kp(r,s,o){return r=Math.pow(r,o),s=Math.pow(s,o)-r,o=1/o,function(l){return Math.pow(r+l*s,o)}}function Up(r){return(r=+r)==1?Hs:function(s,o){return o-s?Kp(s,o,r):Us(isNaN(s)?o:s)}}function Hs(r,s){var o=s-r;return o?Fp(r,o):Us(isNaN(r)?s:r)}const _s=function r(s){var o=Up(s);function l(u,c){var p=o((u=fr(u)).r,(c=fr(c)).r),d=o(u.g,c.g),m=o(u.b,c.b),f=Hs(u.opacity,c.opacity);return function(v){return u.r=p(v),u.g=d(v),u.b=m(v),u.opacity=f(v),u+""}}return l.gamma=r,l}(1);function At(r,s){return r=+r,s=+s,function(o){return r*(1-o)+s*o}}var vr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pr=new RegExp(vr.source,"g");function Hp(r){return function(){return r}}function jp(r){return function(s){return r(s)+""}}function zp(r,s){var o=vr.lastIndex=pr.lastIndex=0,l,u,c,p=-1,d=[],m=[];for(r=r+"",s=s+"";(l=vr.exec(r))&&(u=pr.exec(s));)(c=u.index)>o&&(c=s.slice(o,c),d[p]?d[p]+=c:d[++p]=c),(l=l[0])===(u=u[0])?d[p]?d[p]+=u:d[++p]=u:(d[++p]=null,m.push({i:p,x:At(l,u)})),o=pr.lastIndex;return o<s.length&&(c=s.slice(o),d[p]?d[p]+=c:d[++p]=c),d.length<2?m[0]?jp(m[0].x):Hp(s):(s=m.length,function(f){for(var v=0,_;v<s;++v)d[(_=m[v]).i]=_.x(f);return d.join("")})}var gs=180/Math.PI,mr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function js(r,s,o,l,u,c){var p,d,m;return(p=Math.sqrt(r*r+s*s))&&(r/=p,s/=p),(m=r*o+s*l)&&(o-=r*m,l-=s*m),(d=Math.sqrt(o*o+l*l))&&(o/=d,l/=d,m/=d),r*l<s*o&&(r=-r,s=-s,m=-m,p=-p),{translateX:u,translateY:c,rotate:Math.atan2(s,r)*gs,skewX:Math.atan(m)*gs,scaleX:p,scaleY:d}}var cn;function qp(r){const s=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return s.isIdentity?mr:js(s.a,s.b,s.c,s.d,s.e,s.f)}function Gp(r){return r==null||(cn||(cn=document.createElementNS("http://www.w3.org/2000/svg","g")),cn.setAttribute("transform",r),!(r=cn.transform.baseVal.consolidate()))?mr:(r=r.matrix,js(r.a,r.b,r.c,r.d,r.e,r.f))}function zs(r,s,o,l){function u(f){return f.length?f.pop()+" ":""}function c(f,v,_,x,y,S){if(f!==_||v!==x){var w=y.push("translate(",null,s,null,o);S.push({i:w-4,x:At(f,_)},{i:w-2,x:At(v,x)})}else(_||x)&&y.push("translate("+_+s+x+o)}function p(f,v,_,x){f!==v?(f-v>180?v+=360:v-f>180&&(f+=360),x.push({i:_.push(u(_)+"rotate(",null,l)-2,x:At(f,v)})):v&&_.push(u(_)+"rotate("+v+l)}function d(f,v,_,x){f!==v?x.push({i:_.push(u(_)+"skewX(",null,l)-2,x:At(f,v)}):v&&_.push(u(_)+"skewX("+v+l)}function m(f,v,_,x,y,S){if(f!==_||v!==x){var w=y.push(u(y)+"scale(",null,",",null,")");S.push({i:w-4,x:At(f,_)},{i:w-2,x:At(v,x)})}else(_!==1||x!==1)&&y.push(u(y)+"scale("+_+","+x+")")}return function(f,v){var _=[],x=[];return f=r(f),v=r(v),c(f.translateX,f.translateY,v.translateX,v.translateY,_,x),p(f.rotate,v.rotate,_,x),d(f.skewX,v.skewX,_,x),m(f.scaleX,f.scaleY,v.scaleX,v.scaleY,_,x),f=v=null,function(y){for(var S=-1,w=x.length,C;++S<w;)_[(C=x[S]).i]=C.x(y);return _.join("")}}}var Yp=zs(qp,"px, ","px)","deg)"),Xp=zs(Gp,", ",")",")"),ne=0,Se=0,Ve=0,qs=1e3,bn,Ae,_n=0,Ht=0,Cn=0,Ie=typeof performance=="object"&&performance.now?performance:Date,Gs=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function Er(){return Ht||(Gs(Wp),Ht=Ie.now()+Cn)}function Wp(){Ht=0}function gn(){this._call=this._time=this._next=null}gn.prototype=kr.prototype={constructor:gn,restart:function(r,s,o){if(typeof r!="function")throw new TypeError("callback is not a function");o=(o==null?Er():+o)+(s==null?0:+s),!this._next&&Ae!==this&&(Ae?Ae._next=this:bn=this,Ae=this),this._call=r,this._time=o,br()},stop:function(){this._call&&(this._call=null,this._time=1/0,br())}};function kr(r,s,o){var l=new gn;return l.restart(r,s,o),l}function Qp(){Er(),++ne;for(var r=bn,s;r;)(s=Ht-r._time)>=0&&r._call.call(void 0,s),r=r._next;--ne}function ws(){Ht=(_n=Ie.now())+Cn,ne=Se=0;try{Qp()}finally{ne=0,Zp(),Ht=0}}function Jp(){var r=Ie.now(),s=r-_n;s>qs&&(Cn-=s,_n=r)}function Zp(){for(var r,s=bn,o,l=1/0;s;)s._call?(l>s._time&&(l=s._time),r=s,s=s._next):(o=s._next,s._next=null,s=r?r._next=o:bn=o);Ae=r,br(l)}function br(r){if(!ne){Se&&(Se=clearTimeout(Se));var s=r-Ht;s>24?(r<1/0&&(Se=setTimeout(ws,r-Ie.now()-Cn)),Ve&&(Ve=clearInterval(Ve))):(Ve||(_n=Ie.now(),Ve=setInterval(Jp,qs)),ne=1,Gs(ws))}}function xs(r,s,o){var l=new gn;return s=s==null?0:+s,l.restart(u=>{l.stop(),r(u+s)},s,o),l}var th=xn("start","end","cancel","interrupt"),eh=[],Ys=0,ys=1,_r=2,hn=3,Cs=4,gr=5,dn=6;function Pn(r,s,o,l,u,c){var p=r.__transition;if(!p)r.__transition={};else if(o in p)return;nh(r,o,{name:s,index:l,group:u,on:th,tween:eh,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:Ys})}function Vr(r,s){var o=ut(r,s);if(o.state>Ys)throw new Error("too late; already scheduled");return o}function dt(r,s){var o=ut(r,s);if(o.state>hn)throw new Error("too late; already running");return o}function ut(r,s){var o=r.__transition;if(!o||!(o=o[s]))throw new Error("transition not found");return o}function nh(r,s,o){var l=r.__transition,u;l[s]=o,o.timer=kr(c,0,o.time);function c(f){o.state=ys,o.timer.restart(p,o.delay,o.time),o.delay<=f&&p(f-o.delay)}function p(f){var v,_,x,y;if(o.state!==ys)return m();for(v in l)if(y=l[v],y.name===o.name){if(y.state===hn)return xs(p);y.state===Cs?(y.state=dn,y.timer.stop(),y.on.call("interrupt",r,r.__data__,y.index,y.group),delete l[v]):+v<s&&(y.state=dn,y.timer.stop(),y.on.call("cancel",r,r.__data__,y.index,y.group),delete l[v])}if(xs(function(){o.state===hn&&(o.state=Cs,o.timer.restart(d,o.delay,o.time),d(f))}),o.state=_r,o.on.call("start",r,r.__data__,o.index,o.group),o.state===_r){for(o.state=hn,u=new Array(x=o.tween.length),v=0,_=-1;v<x;++v)(y=o.tween[v].value.call(r,r.__data__,o.index,o.group))&&(u[++_]=y);u.length=_+1}}function d(f){for(var v=f<o.duration?o.ease.call(null,f/o.duration):(o.timer.restart(m),o.state=gr,1),_=-1,x=u.length;++_<x;)u[_].call(r,v);o.state===gr&&(o.on.call("end",r,r.__data__,o.index,o.group),m())}function m(){o.state=dn,o.timer.stop(),delete l[s];for(var f in l)return;delete r.__transition}}function rh(r,s){var o=r.__transition,l,u,c=!0,p;if(o){s=s==null?null:s+"";for(p in o){if((l=o[p]).name!==s){c=!1;continue}u=l.state>_r&&l.state<gr,l.state=dn,l.timer.stop(),l.on.call(u?"interrupt":"cancel",r,r.__data__,l.index,l.group),delete o[p]}c&&delete r.__transition}}function ih(r){return this.each(function(){rh(this,r)})}function sh(r,s){var o,l;return function(){var u=dt(this,r),c=u.tween;if(c!==o){l=o=c;for(var p=0,d=l.length;p<d;++p)if(l[p].name===s){l=l.slice(),l.splice(p,1);break}}u.tween=l}}function oh(r,s,o){var l,u;if(typeof o!="function")throw new Error;return function(){var c=dt(this,r),p=c.tween;if(p!==l){u=(l=p).slice();for(var d={name:s,value:o},m=0,f=u.length;m<f;++m)if(u[m].name===s){u[m]=d;break}m===f&&u.push(d)}c.tween=u}}function ah(r,s){var o=this._id;if(r+="",arguments.length<2){for(var l=ut(this.node(),o).tween,u=0,c=l.length,p;u<c;++u)if((p=l[u]).name===r)return p.value;return null}return this.each((s==null?sh:oh)(o,r,s))}function Sr(r,s,o){var l=r._id;return r.each(function(){var u=dt(this,l);(u.value||(u.value={}))[s]=o.apply(this,arguments)}),function(u){return ut(u,l).value[s]}}function Xs(r,s){var o;return(typeof s=="number"?At:s instanceof Te?_s:(o=Te(s))?(s=o,_s):zp)(r,s)}function lh(r){return function(){this.removeAttribute(r)}}function uh(r){return function(){this.removeAttributeNS(r.space,r.local)}}function ch(r,s,o){var l,u=o+"",c;return function(){var p=this.getAttribute(r);return p===u?null:p===l?c:c=s(l=p,o)}}function ph(r,s,o){var l,u=o+"",c;return function(){var p=this.getAttributeNS(r.space,r.local);return p===u?null:p===l?c:c=s(l=p,o)}}function hh(r,s,o){var l,u,c;return function(){var p,d=o(this),m;return d==null?void this.removeAttribute(r):(p=this.getAttribute(r),m=d+"",p===m?null:p===l&&m===u?c:(u=m,c=s(l=p,d)))}}function dh(r,s,o){var l,u,c;return function(){var p,d=o(this),m;return d==null?void this.removeAttributeNS(r.space,r.local):(p=this.getAttributeNS(r.space,r.local),m=d+"",p===m?null:p===l&&m===u?c:(u=m,c=s(l=p,d)))}}function fh(r,s){var o=yn(r),l=o==="transform"?Xp:Xs;return this.attrTween(r,typeof s=="function"?(o.local?dh:hh)(o,l,Sr(this,"attr."+r,s)):s==null?(o.local?uh:lh)(o):(o.local?ph:ch)(o,l,s))}function vh(r,s){return function(o){this.setAttribute(r,s.call(this,o))}}function mh(r,s){return function(o){this.setAttributeNS(r.space,r.local,s.call(this,o))}}function bh(r,s){var o,l;function u(){var c=s.apply(this,arguments);return c!==l&&(o=(l=c)&&mh(r,c)),o}return u._value=s,u}function _h(r,s){var o,l;function u(){var c=s.apply(this,arguments);return c!==l&&(o=(l=c)&&vh(r,c)),o}return u._value=s,u}function gh(r,s){var o="attr."+r;if(arguments.length<2)return(o=this.tween(o))&&o._value;if(s==null)return this.tween(o,null);if(typeof s!="function")throw new Error;var l=yn(r);return this.tween(o,(l.local?bh:_h)(l,s))}function wh(r,s){return function(){Vr(this,r).delay=+s.apply(this,arguments)}}function xh(r,s){return s=+s,function(){Vr(this,r).delay=s}}function yh(r){var s=this._id;return arguments.length?this.each((typeof r=="function"?wh:xh)(s,r)):ut(this.node(),s).delay}function Ch(r,s){return function(){dt(this,r).duration=+s.apply(this,arguments)}}function Ph(r,s){return s=+s,function(){dt(this,r).duration=s}}function Eh(r){var s=this._id;return arguments.length?this.each((typeof r=="function"?Ch:Ph)(s,r)):ut(this.node(),s).duration}function kh(r,s){if(typeof s!="function")throw new Error;return function(){dt(this,r).ease=s}}function Vh(r){var s=this._id;return arguments.length?this.each(kh(s,r)):ut(this.node(),s).ease}function Sh(r,s){return function(){var o=s.apply(this,arguments);if(typeof o!="function")throw new Error;dt(this,r).ease=o}}function Ah(r){if(typeof r!="function")throw new Error;return this.each(Sh(this._id,r))}function Mh(r){typeof r!="function"&&(r=Ms(r));for(var s=this._groups,o=s.length,l=new Array(o),u=0;u<o;++u)for(var c=s[u],p=c.length,d=l[u]=[],m,f=0;f<p;++f)(m=c[f])&&r.call(m,m.__data__,f,c)&&d.push(m);return new xt(l,this._parents,this._name,this._id)}function Nh(r){if(r._id!==this._id)throw new Error;for(var s=this._groups,o=r._groups,l=s.length,u=o.length,c=Math.min(l,u),p=new Array(l),d=0;d<c;++d)for(var m=s[d],f=o[d],v=m.length,_=p[d]=new Array(v),x,y=0;y<v;++y)(x=m[y]||f[y])&&(_[y]=x);for(;d<l;++d)p[d]=s[d];return new xt(p,this._parents,this._name,this._id)}function Lh(r){return(r+"").trim().split(/^|\s+/).every(function(s){var o=s.indexOf(".");return o>=0&&(s=s.slice(0,o)),!s||s==="start"})}function Dh(r,s,o){var l,u,c=Lh(s)?Vr:dt;return function(){var p=c(this,r),d=p.on;d!==l&&(u=(l=d).copy()).on(s,o),p.on=u}}function Rh(r,s){var o=this._id;return arguments.length<2?ut(this.node(),o).on.on(r):this.each(Dh(o,r,s))}function Th(r){return function(){var s=this.parentNode;for(var o in this.__transition)if(+o!==r)return;s&&s.removeChild(this)}}function Ih(){return this.on("end.remove",Th(this._id))}function Oh(r){var s=this._name,o=this._id;typeof r!="function"&&(r=xr(r));for(var l=this._groups,u=l.length,c=new Array(u),p=0;p<u;++p)for(var d=l[p],m=d.length,f=c[p]=new Array(m),v,_,x=0;x<m;++x)(v=d[x])&&(_=r.call(v,v.__data__,x,d))&&("__data__"in v&&(_.__data__=v.__data__),f[x]=_,Pn(f[x],s,o,x,f,ut(v,o)));return new xt(c,this._parents,s,o)}function Bh(r){var s=this._name,o=this._id;typeof r!="function"&&(r=As(r));for(var l=this._groups,u=l.length,c=[],p=[],d=0;d<u;++d)for(var m=l[d],f=m.length,v,_=0;_<f;++_)if(v=m[_]){for(var x=r.call(v,v.__data__,_,m),y,S=ut(v,o),w=0,C=x.length;w<C;++w)(y=x[w])&&Pn(y,s,o,w,x,S);c.push(x),p.push(v)}return new xt(c,p,s,o)}var $h=Ke.prototype.constructor;function Fh(){return new $h(this._groups,this._parents)}function Kh(r,s){var o,l,u;return function(){var c=ee(this,r),p=(this.style.removeProperty(r),ee(this,r));return c===p?null:c===o&&p===l?u:u=s(o=c,l=p)}}function Ws(r){return function(){this.style.removeProperty(r)}}function Uh(r,s,o){var l,u=o+"",c;return function(){var p=ee(this,r);return p===u?null:p===l?c:c=s(l=p,o)}}function Hh(r,s,o){var l,u,c;return function(){var p=ee(this,r),d=o(this),m=d+"";return d==null&&(m=d=(this.style.removeProperty(r),ee(this,r))),p===m?null:p===l&&m===u?c:(u=m,c=s(l=p,d))}}function jh(r,s){var o,l,u,c="style."+s,p="end."+c,d;return function(){var m=dt(this,r),f=m.on,v=m.value[c]==null?d||(d=Ws(s)):void 0;(f!==o||u!==v)&&(l=(o=f).copy()).on(p,u=v),m.on=l}}function zh(r,s,o){var l=(r+="")=="transform"?Yp:Xs;return s==null?this.styleTween(r,Kh(r,l)).on("end.style."+r,Ws(r)):typeof s=="function"?this.styleTween(r,Hh(r,l,Sr(this,"style."+r,s))).each(jh(this._id,r)):this.styleTween(r,Uh(r,l,s),o).on("end.style."+r,null)}function qh(r,s,o){return function(l){this.style.setProperty(r,s.call(this,l),o)}}function Gh(r,s,o){var l,u;function c(){var p=s.apply(this,arguments);return p!==u&&(l=(u=p)&&qh(r,p,o)),l}return c._value=s,c}function Yh(r,s,o){var l="style."+(r+="");if(arguments.length<2)return(l=this.tween(l))&&l._value;if(s==null)return this.tween(l,null);if(typeof s!="function")throw new Error;return this.tween(l,Gh(r,s,o??""))}function Xh(r){return function(){this.textContent=r}}function Wh(r){return function(){var s=r(this);this.textContent=s??""}}function Qh(r){return this.tween("text",typeof r=="function"?Wh(Sr(this,"text",r)):Xh(r==null?"":r+""))}function Jh(r){return function(s){this.textContent=r.call(this,s)}}function Zh(r){var s,o;function l(){var u=r.apply(this,arguments);return u!==o&&(s=(o=u)&&Jh(u)),s}return l._value=r,l}function td(r){var s="text";if(arguments.length<1)return(s=this.tween(s))&&s._value;if(r==null)return this.tween(s,null);if(typeof r!="function")throw new Error;return this.tween(s,Zh(r))}function ed(){for(var r=this._name,s=this._id,o=Qs(),l=this._groups,u=l.length,c=0;c<u;++c)for(var p=l[c],d=p.length,m,f=0;f<d;++f)if(m=p[f]){var v=ut(m,s);Pn(m,r,o,f,p,{time:v.time+v.delay+v.duration,delay:0,duration:v.duration,ease:v.ease})}return new xt(l,this._parents,r,o)}function nd(){var r,s,o=this,l=o._id,u=o.size();return new Promise(function(c,p){var d={value:p},m={value:function(){--u===0&&c()}};o.each(function(){var f=dt(this,l),v=f.on;v!==r&&(s=(r=v).copy(),s._.cancel.push(d),s._.interrupt.push(d),s._.end.push(m)),f.on=s}),u===0&&c()})}var rd=0;function xt(r,s,o,l){this._groups=r,this._parents=s,this._name=o,this._id=l}function Qs(){return++rd}var wt=Ke.prototype;xt.prototype={constructor:xt,select:Oh,selectAll:Bh,selectChild:wt.selectChild,selectChildren:wt.selectChildren,filter:Mh,merge:Nh,selection:Fh,transition:ed,call:wt.call,nodes:wt.nodes,node:wt.node,size:wt.size,empty:wt.empty,each:wt.each,on:Rh,attr:fh,attrTween:gh,style:zh,styleTween:Yh,text:Qh,textTween:td,remove:Ih,tween:ah,delay:yh,duration:Eh,ease:Vh,easeVarying:Ah,end:nd,[Symbol.iterator]:wt[Symbol.iterator]};function id(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var sd={time:null,delay:0,duration:250,ease:id};function od(r,s){for(var o;!(o=r.__transition)||!(o=o[s]);)if(!(r=r.parentNode))throw new Error(`transition ${s} not found`);return o}function ad(r){var s,o;r instanceof xt?(s=r._id,r=r._name):(s=Qs(),(o=sd).time=Er(),r=r==null?null:r+"");for(var l=this._groups,u=l.length,c=0;c<u;++c)for(var p=l[c],d=p.length,m,f=0;f<d;++f)(m=p[f])&&Pn(m,r,s,f,p,o||od(m,s));return new xt(l,this._parents,r,s)}Ke.prototype.interrupt=ih;Ke.prototype.transition=ad;function ld(r,s){var o,l=1;r==null&&(r=0),s==null&&(s=0);function u(){var c,p=o.length,d,m=0,f=0;for(c=0;c<p;++c)d=o[c],m+=d.x,f+=d.y;for(m=(m/p-r)*l,f=(f/p-s)*l,c=0;c<p;++c)d=o[c],d.x-=m,d.y-=f}return u.initialize=function(c){o=c},u.x=function(c){return arguments.length?(r=+c,u):r},u.y=function(c){return arguments.length?(s=+c,u):s},u.strength=function(c){return arguments.length?(l=+c,u):l},u}function ud(r){const s=+this._x.call(null,r),o=+this._y.call(null,r);return Js(this.cover(s,o),s,o,r)}function Js(r,s,o,l){if(isNaN(s)||isNaN(o))return r;var u,c=r._root,p={data:l},d=r._x0,m=r._y0,f=r._x1,v=r._y1,_,x,y,S,w,C,V,E;if(!c)return r._root=p,r;for(;c.length;)if((w=s>=(_=(d+f)/2))?d=_:f=_,(C=o>=(x=(m+v)/2))?m=x:v=x,u=c,!(c=c[V=C<<1|w]))return u[V]=p,r;if(y=+r._x.call(null,c.data),S=+r._y.call(null,c.data),s===y&&o===S)return p.next=c,u?u[V]=p:r._root=p,r;do u=u?u[V]=new Array(4):r._root=new Array(4),(w=s>=(_=(d+f)/2))?d=_:f=_,(C=o>=(x=(m+v)/2))?m=x:v=x;while((V=C<<1|w)===(E=(S>=x)<<1|y>=_));return u[E]=c,u[V]=p,r}function cd(r){var s,o,l=r.length,u,c,p=new Array(l),d=new Array(l),m=1/0,f=1/0,v=-1/0,_=-1/0;for(o=0;o<l;++o)isNaN(u=+this._x.call(null,s=r[o]))||isNaN(c=+this._y.call(null,s))||(p[o]=u,d[o]=c,u<m&&(m=u),u>v&&(v=u),c<f&&(f=c),c>_&&(_=c));if(m>v||f>_)return this;for(this.cover(m,f).cover(v,_),o=0;o<l;++o)Js(this,p[o],d[o],r[o]);return this}function pd(r,s){if(isNaN(r=+r)||isNaN(s=+s))return this;var o=this._x0,l=this._y0,u=this._x1,c=this._y1;if(isNaN(o))u=(o=Math.floor(r))+1,c=(l=Math.floor(s))+1;else{for(var p=u-o||1,d=this._root,m,f;o>r||r>=u||l>s||s>=c;)switch(f=(s<l)<<1|r<o,m=new Array(4),m[f]=d,d=m,p*=2,f){case 0:u=o+p,c=l+p;break;case 1:o=u-p,c=l+p;break;case 2:u=o+p,l=c-p;break;case 3:o=u-p,l=c-p;break}this._root&&this._root.length&&(this._root=d)}return this._x0=o,this._y0=l,this._x1=u,this._y1=c,this}function hd(){var r=[];return this.visit(function(s){if(!s.length)do r.push(s.data);while(s=s.next)}),r}function dd(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function J(r,s,o,l,u){this.node=r,this.x0=s,this.y0=o,this.x1=l,this.y1=u}function fd(r,s,o){var l,u=this._x0,c=this._y0,p,d,m,f,v=this._x1,_=this._y1,x=[],y=this._root,S,w;for(y&&x.push(new J(y,u,c,v,_)),o==null?o=1/0:(u=r-o,c=s-o,v=r+o,_=s+o,o*=o);S=x.pop();)if(!(!(y=S.node)||(p=S.x0)>v||(d=S.y0)>_||(m=S.x1)<u||(f=S.y1)<c))if(y.length){var C=(p+m)/2,V=(d+f)/2;x.push(new J(y[3],C,V,m,f),new J(y[2],p,V,C,f),new J(y[1],C,d,m,V),new J(y[0],p,d,C,V)),(w=(s>=V)<<1|r>=C)&&(S=x[x.length-1],x[x.length-1]=x[x.length-1-w],x[x.length-1-w]=S)}else{var E=r-+this._x.call(null,y.data),L=s-+this._y.call(null,y.data),g=E*E+L*L;if(g<o){var M=Math.sqrt(o=g);u=r-M,c=s-M,v=r+M,_=s+M,l=y.data}}return l}function vd(r){if(isNaN(v=+this._x.call(null,r))||isNaN(_=+this._y.call(null,r)))return this;var s,o=this._root,l,u,c,p=this._x0,d=this._y0,m=this._x1,f=this._y1,v,_,x,y,S,w,C,V;if(!o)return this;if(o.length)for(;;){if((S=v>=(x=(p+m)/2))?p=x:m=x,(w=_>=(y=(d+f)/2))?d=y:f=y,s=o,!(o=o[C=w<<1|S]))return this;if(!o.length)break;(s[C+1&3]||s[C+2&3]||s[C+3&3])&&(l=s,V=C)}for(;o.data!==r;)if(u=o,!(o=o.next))return this;return(c=o.next)&&delete o.next,u?(c?u.next=c:delete u.next,this):s?(c?s[C]=c:delete s[C],(o=s[0]||s[1]||s[2]||s[3])&&o===(s[3]||s[2]||s[1]||s[0])&&!o.length&&(l?l[V]=o:this._root=o),this):(this._root=c,this)}function md(r){for(var s=0,o=r.length;s<o;++s)this.remove(r[s]);return this}function bd(){return this._root}function _d(){var r=0;return this.visit(function(s){if(!s.length)do++r;while(s=s.next)}),r}function gd(r){var s=[],o,l=this._root,u,c,p,d,m;for(l&&s.push(new J(l,this._x0,this._y0,this._x1,this._y1));o=s.pop();)if(!r(l=o.node,c=o.x0,p=o.y0,d=o.x1,m=o.y1)&&l.length){var f=(c+d)/2,v=(p+m)/2;(u=l[3])&&s.push(new J(u,f,v,d,m)),(u=l[2])&&s.push(new J(u,c,v,f,m)),(u=l[1])&&s.push(new J(u,f,p,d,v)),(u=l[0])&&s.push(new J(u,c,p,f,v))}return this}function wd(r){var s=[],o=[],l;for(this._root&&s.push(new J(this._root,this._x0,this._y0,this._x1,this._y1));l=s.pop();){var u=l.node;if(u.length){var c,p=l.x0,d=l.y0,m=l.x1,f=l.y1,v=(p+m)/2,_=(d+f)/2;(c=u[0])&&s.push(new J(c,p,d,v,_)),(c=u[1])&&s.push(new J(c,v,d,m,_)),(c=u[2])&&s.push(new J(c,p,_,v,f)),(c=u[3])&&s.push(new J(c,v,_,m,f))}o.push(l)}for(;l=o.pop();)r(l.node,l.x0,l.y0,l.x1,l.y1);return this}function xd(r){return r[0]}function yd(r){return arguments.length?(this._x=r,this):this._x}function Cd(r){return r[1]}function Pd(r){return arguments.length?(this._y=r,this):this._y}function Ar(r,s,o){var l=new Mr(s??xd,o??Cd,NaN,NaN,NaN,NaN);return r==null?l:l.addAll(r)}function Mr(r,s,o,l,u,c){this._x=r,this._y=s,this._x0=o,this._y0=l,this._x1=u,this._y1=c,this._root=void 0}function Ps(r){for(var s={data:r.data},o=s;r=r.next;)o=o.next={data:r.data};return s}var tt=Ar.prototype=Mr.prototype;tt.copy=function(){var r=new Mr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),s=this._root,o,l;if(!s)return r;if(!s.length)return r._root=Ps(s),r;for(o=[{source:s,target:r._root=new Array(4)}];s=o.pop();)for(var u=0;u<4;++u)(l=s.source[u])&&(l.length?o.push({source:l,target:s.target[u]=new Array(4)}):s.target[u]=Ps(l));return r};tt.add=ud;tt.addAll=cd;tt.cover=pd;tt.data=hd;tt.extent=dd;tt.find=fd;tt.remove=vd;tt.removeAll=md;tt.root=bd;tt.size=_d;tt.visit=gd;tt.visitAfter=wd;tt.x=yd;tt.y=Pd;function Ut(r){return function(){return r}}function Mt(r){return(r()-.5)*1e-6}function Ed(r){return r.x+r.vx}function kd(r){return r.y+r.vy}function Vd(r){var s,o,l,u=1,c=1;typeof r!="function"&&(r=Ut(r==null?1:+r));function p(){for(var f,v=s.length,_,x,y,S,w,C,V=0;V<c;++V)for(_=Ar(s,Ed,kd).visitAfter(d),f=0;f<v;++f)x=s[f],w=o[x.index],C=w*w,y=x.x+x.vx,S=x.y+x.vy,_.visit(E);function E(L,g,M,O,T){var R=L.data,j=L.r,B=w+j;if(R){if(R.index>x.index){var H=y-R.x-R.vx,W=S-R.y-R.vy,nt=H*H+W*W;nt<B*B&&(H===0&&(H=Mt(l),nt+=H*H),W===0&&(W=Mt(l),nt+=W*W),nt=(B-(nt=Math.sqrt(nt)))/nt*u,x.vx+=(H*=nt)*(B=(j*=j)/(C+j)),x.vy+=(W*=nt)*B,R.vx-=H*(B=1-B),R.vy-=W*B)}return}return g>y+B||O<y-B||M>S+B||T<S-B}}function d(f){if(f.data)return f.r=o[f.data.index];for(var v=f.r=0;v<4;++v)f[v]&&f[v].r>f.r&&(f.r=f[v].r)}function m(){if(s){var f,v=s.length,_;for(o=new Array(v),f=0;f<v;++f)_=s[f],o[_.index]=+r(_,f,s)}}return p.initialize=function(f,v){s=f,l=v,m()},p.iterations=function(f){return arguments.length?(c=+f,p):c},p.strength=function(f){return arguments.length?(u=+f,p):u},p.radius=function(f){return arguments.length?(r=typeof f=="function"?f:Ut(+f),m(),p):r},p}function Sd(r){return r.index}function Es(r,s){var o=r.get(s);if(!o)throw new Error("node not found: "+s);return o}function Nr(r){var s=Sd,o=_,l,u=Ut(30),c,p,d,m,f,v=1;r==null&&(r=[]);function _(C){return 1/Math.min(d[C.source.index],d[C.target.index])}function x(C){for(var V=0,E=r.length;V<v;++V)for(var L=0,g,M,O,T,R,j,B;L<E;++L)g=r[L],M=g.source,O=g.target,T=O.x+O.vx-M.x-M.vx||Mt(f),R=O.y+O.vy-M.y-M.vy||Mt(f),j=Math.sqrt(T*T+R*R),j=(j-c[L])/j*C*l[L],T*=j,R*=j,O.vx-=T*(B=m[L]),O.vy-=R*B,M.vx+=T*(B=1-B),M.vy+=R*B}function y(){if(p){var C,V=p.length,E=r.length,L=new Map(p.map((M,O)=>[s(M,O,p),M])),g;for(C=0,d=new Array(V);C<E;++C)g=r[C],g.index=C,typeof g.source!="object"&&(g.source=Es(L,g.source)),typeof g.target!="object"&&(g.target=Es(L,g.target)),d[g.source.index]=(d[g.source.index]||0)+1,d[g.target.index]=(d[g.target.index]||0)+1;for(C=0,m=new Array(E);C<E;++C)g=r[C],m[C]=d[g.source.index]/(d[g.source.index]+d[g.target.index]);l=new Array(E),S(),c=new Array(E),w()}}function S(){if(p)for(var C=0,V=r.length;C<V;++C)l[C]=+o(r[C],C,r)}function w(){if(p)for(var C=0,V=r.length;C<V;++C)c[C]=+u(r[C],C,r)}return x.initialize=function(C,V){p=C,f=V,y()},x.links=function(C){return arguments.length?(r=C,y(),x):r},x.id=function(C){return arguments.length?(s=C,x):s},x.iterations=function(C){return arguments.length?(v=+C,x):v},x.strength=function(C){return arguments.length?(o=typeof C=="function"?C:Ut(+C),S(),x):o},x.distance=function(C){return arguments.length?(u=typeof C=="function"?C:Ut(+C),w(),x):u},x}const Ad=1664525,Md=1013904223,ks=4294967296;function Nd(){let r=1;return()=>(r=(Ad*r+Md)%ks)/ks}function Ld(r){return r.x}function Dd(r){return r.y}var Rd=10,Td=Math.PI*(3-Math.sqrt(5));function Id(r){var s,o=1,l=.001,u=1-Math.pow(l,1/300),c=0,p=.6,d=new Map,m=kr(_),f=xn("tick","end"),v=Nd();r==null&&(r=[]);function _(){x(),f.call("tick",s),o<l&&(m.stop(),f.call("end",s))}function x(w){var C,V=r.length,E;w===void 0&&(w=1);for(var L=0;L<w;++L)for(o+=(c-o)*u,d.forEach(function(g){g(o)}),C=0;C<V;++C)E=r[C],E.fx==null?E.x+=E.vx*=p:(E.x=E.fx,E.vx=0),E.fy==null?E.y+=E.vy*=p:(E.y=E.fy,E.vy=0);return s}function y(){for(var w=0,C=r.length,V;w<C;++w){if(V=r[w],V.index=w,V.fx!=null&&(V.x=V.fx),V.fy!=null&&(V.y=V.fy),isNaN(V.x)||isNaN(V.y)){var E=Rd*Math.sqrt(.5+w),L=w*Td;V.x=E*Math.cos(L),V.y=E*Math.sin(L)}(isNaN(V.vx)||isNaN(V.vy))&&(V.vx=V.vy=0)}}function S(w){return w.initialize&&w.initialize(r,v),w}return y(),s={tick:x,restart:function(){return m.restart(_),s},stop:function(){return m.stop(),s},nodes:function(w){return arguments.length?(r=w,y(),d.forEach(S),s):r},alpha:function(w){return arguments.length?(o=+w,s):o},alphaMin:function(w){return arguments.length?(l=+w,s):l},alphaDecay:function(w){return arguments.length?(u=+w,s):+u},alphaTarget:function(w){return arguments.length?(c=+w,s):c},velocityDecay:function(w){return arguments.length?(p=1-w,s):1-p},randomSource:function(w){return arguments.length?(v=w,d.forEach(S),s):v},force:function(w,C){return arguments.length>1?(C==null?d.delete(w):d.set(w,S(C)),s):d.get(w)},find:function(w,C,V){var E=0,L=r.length,g,M,O,T,R;for(V==null?V=1/0:V*=V,E=0;E<L;++E)T=r[E],g=w-T.x,M=C-T.y,O=g*g+M*M,O<V&&(R=T,V=O);return R},on:function(w,C){return arguments.length>1?(f.on(w,C),s):f.on(w)}}}function Od(){var r,s,o,l,u=Ut(-30),c,p=1,d=1/0,m=.81;function f(y){var S,w=r.length,C=Ar(r,Ld,Dd).visitAfter(_);for(l=y,S=0;S<w;++S)s=r[S],C.visit(x)}function v(){if(r){var y,S=r.length,w;for(c=new Array(S),y=0;y<S;++y)w=r[y],c[w.index]=+u(w,y,r)}}function _(y){var S=0,w,C,V=0,E,L,g;if(y.length){for(E=L=g=0;g<4;++g)(w=y[g])&&(C=Math.abs(w.value))&&(S+=w.value,V+=C,E+=C*w.x,L+=C*w.y);y.x=E/V,y.y=L/V}else{w=y,w.x=w.data.x,w.y=w.data.y;do S+=c[w.data.index];while(w=w.next)}y.value=S}function x(y,S,w,C){if(!y.value)return!0;var V=y.x-s.x,E=y.y-s.y,L=C-S,g=V*V+E*E;if(L*L/m<g)return g<d&&(V===0&&(V=Mt(o),g+=V*V),E===0&&(E=Mt(o),g+=E*E),g<p&&(g=Math.sqrt(p*g)),s.vx+=V*y.value*l/g,s.vy+=E*y.value*l/g),!0;if(y.length||g>=d)return;(y.data!==s||y.next)&&(V===0&&(V=Mt(o),g+=V*V),E===0&&(E=Mt(o),g+=E*E),g<p&&(g=Math.sqrt(p*g)));do y.data!==s&&(L=c[y.data.index]*l/g,s.vx+=V*L,s.vy+=E*L);while(y=y.next)}return f.initialize=function(y,S){r=y,o=S,v()},f.strength=function(y){return arguments.length?(u=typeof y=="function"?y:Ut(+y),v(),f):u},f.distanceMin=function(y){return arguments.length?(p=y*y,f):Math.sqrt(p)},f.distanceMax=function(y){return arguments.length?(d=y*y,f):Math.sqrt(d)},f.theta=function(y){return arguments.length?(m=y*y,f):Math.sqrt(m)},f}function Me(r,s,o){this.k=r,this.x=s,this.y=o}Me.prototype={constructor:Me,scale:function(r){return r===1?this:new Me(this.k*r,this.x,this.y)},translate:function(r,s){return r===0&s===0?this:new Me(this.k,this.x+this.k*r,this.y+this.k*s)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Me.prototype;var Bd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},wr={exports:{}};/*! Tweakpane 3.1.10 (c) 2016 cocopon, licensed under the MIT license. */(function(r,s){(function(o,l){l(s)})(Bd,function(o){class l{constructor(t){const[e,i]=t.split("-"),a=e.split(".");this.major=parseInt(a[0],10),this.minor=parseInt(a[1],10),this.patch=parseInt(a[2],10),this.prerelease=i??null}toString(){const t=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[t,this.prerelease].join("-"):t}}class u{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class c{constructor(t){this.target=t}}class p extends c{constructor(t,e,i,a){super(t),this.value=e,this.presetKey=i,this.last=a??!0}}class d extends c{constructor(t,e,i){super(t),this.value=e,this.presetKey=i}}class m extends c{constructor(t,e){super(t),this.expanded=e}}class f extends c{constructor(t,e){super(t),this.index=e}}function v(n){return n}function _(n){return n==null}function x(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function y(n,t){let e=n;do{const i=Object.getOwnPropertyDescriptor(e,t);if(i&&(i.set!==void 0||i.writable===!0))return!0;e=Object.getPrototypeOf(e)}while(e!==null);return!1}const S={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class w{static alreadyDisposed(){return new w({type:"alreadydisposed"})}static notBindable(){return new w({type:"notbindable"})}static propertyNotFound(t){return new w({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new w({type:"shouldneverhappen"})}constructor(t){var e;this.message=(e=S[t.type](t.context))!==null&&e!==void 0?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}}class C{constructor(t,e,i){this.obj_=t,this.key_=e,this.presetKey_=i??e}static isBindable(t){return!(t===null||typeof t!="object"&&typeof t!="function")}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const i=this.read();if(!C.isBindable(i))throw w.notBindable();if(!(t in i))throw w.propertyNotFound(t);i[t]=e}}class V extends u{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return(t=this.controller_.valueController.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const i=e.bind(this);return this.controller_.valueController.emitter.on(t,()=>{i(new c(this))}),this}}class E{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter(a=>a.handler!==e)),this}emit(t,e){const i=this.observers_[t];i&&i.forEach(a=>{a.handler(e)})}}const L="tp";function g(n){return(e,i)=>[L,"-",n,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function M(n,t){return e=>t(n(e))}function O(n){return n.rawValue}function T(n,t){n.emitter.on("change",M(O,t)),t(n.rawValue)}function R(n,t,e){T(n.value(t),e)}function j(n,t,e){e?n.classList.add(t):n.classList.remove(t)}function B(n,t){return e=>{j(n,t,e)}}function H(n,t){T(n,e=>{t.textContent=e??""})}const W=g("btn");class nt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(W()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(W("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const a=t.createElement("div");a.classList.add(W("t")),H(e.props.value("title"),a),this.buttonElement.appendChild(a)}}class Dt{constructor(t,e){this.emitter=new E,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new nt(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class En{constructor(t,e){var i;this.constraint_=e==null?void 0:e.constraint,this.equals_=(i=e==null?void 0:e.equals)!==null&&i!==void 0?i:(a,h)=>a===h,this.emitter=new E,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},a=this.constraint_?this.constraint_.constrain(t):t,h=this.rawValue_;this.equals_(h,a)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=a,this.emitter.emit("change",{options:i,previousRawValue:h,rawValue:a,sender:this}))}}class ie{constructor(t){this.emitter=new E,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},a=this.value_;a===t&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:i,previousRawValue:a,rawValue:this.value_,sender:this}))}}function z(n,t){const e=t==null?void 0:t.constraint,i=t==null?void 0:t.equals;return!e&&!i?new ie(n):new En(n,t)}class D{constructor(t){this.emitter=new E,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",()=>{this.emitter.emit("change",{key:e,sender:this})})}static createCore(t){return Object.keys(t).reduce((i,a)=>Object.assign(i,{[a]:z(t[a])}),{})}static fromObject(t){const e=this.createCore(t);return new D(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function ze(n,t){const i=Object.keys(t).reduce((a,h)=>{if(a===void 0)return;const b=t[h],P=b(n[h]);return P.succeeded?Object.assign(Object.assign({},a),{[h]:P.value}):void 0},{});return i}function se(n,t){return n.reduce((e,i)=>{if(e===void 0)return;const a=t(i);if(!(!a.succeeded||a.value===void 0))return[...e,a.value]},[])}function uo(n){return n===null?!1:typeof n=="object"}function ft(n){return t=>e=>{if(!t&&e===void 0)return{succeeded:!1,value:void 0};if(t&&e===void 0)return{succeeded:!0,value:void 0};const i=n(e);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function Ir(n){return{custom:t=>ft(t)(n),boolean:ft(t=>typeof t=="boolean"?t:void 0)(n),number:ft(t=>typeof t=="number"?t:void 0)(n),string:ft(t=>typeof t=="string"?t:void 0)(n),function:ft(t=>typeof t=="function"?t:void 0)(n),constant:t=>ft(e=>e===t?t:void 0)(n),raw:ft(t=>t)(n),object:t=>ft(e=>{if(uo(e))return ze(e,t)})(n),array:t=>ft(e=>{if(Array.isArray(e))return se(e,t)})(n)}}const K={optional:Ir(!0),required:Ir(!1)};function G(n,t){const e=K.required.object(t)(n);return e.succeeded?e.value:void 0}function kn(n){console.warn([`Missing '${n.key}' of ${n.target} in ${n.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function co(n){return n&&n.parentElement&&n.parentElement.removeChild(n),null}class Vn{constructor(t){this.value_=t}static create(t){return[new Vn(t),(e,i)=>{t.setRawValue(e,i)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const po=g("");function Or(n,t){return B(n,po(void 0,t))}class vt extends D{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=Vn.create(z(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,i,a;const h=t??{};return new vt(D.createCore({disabled:(e=h.disabled)!==null&&e!==void 0?e:!1,disposed:!1,hidden:(i=h.hidden)!==null&&i!==void 0?i:!1,parent:(a=h.parent)!==null&&a!==void 0?a:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){T(this.globalDisabled_,Or(t,"disabled")),R(this,"hidden",Or(t,"hidden"))}bindDisabled(t){T(this.globalDisabled_,e=>{t.disabled=e})}bindTabIndex(t){T(this.globalDisabled_,e=>{t.tabIndex=e?-1:0})}handleDispose(t){this.value("disposed").emitter.on("change",e=>{e&&t()})}getGlobalDisabled_(){const t=this.get("parent");return(t?t.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const i=t.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function ho(){return["veryfirst","first","last","verylast"]}const Br=g(""),$r={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class oe{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",()=>{ho().forEach(i=>{e.classList.remove(Br(void 0,$r[i]))}),this.blade.get("positions").forEach(i=>{e.classList.add(Br(void 0,$r[i]))})}),this.viewProps.handleDispose(()=>{co(e)})}get parent(){return this.parent_}set parent(t){if(this.parent_=t,!("parent"in this.viewProps.valMap_)){kn({key:"parent",target:vt.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const ct="http://www.w3.org/2000/svg";function qe(n){n.offsetHeight}function fo(n,t){const e=n.style.transition;n.style.transition="none",t(),n.style.transition=e}function Sn(n){return n.ontouchstart!==void 0}function vo(){return globalThis}function mo(){return vo().document}function bo(n){const t=n.ownerDocument.defaultView;return t&&"document"in t?n.getContext("2d",{willReadFrequently:!0}):null}const _o={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Ge(n,t){const e=n.createElementNS(ct,"svg");return e.innerHTML=_o[t],e}function Fr(n,t,e){n.insertBefore(t,n.children[e])}function Kr(n){n.parentElement&&n.parentElement.removeChild(n)}function Ur(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function go(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function Hr(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}const ae=g("lbl");function wo(n,t){const e=n.createDocumentFragment();return t.split(`
`).map(a=>n.createTextNode(a)).forEach((a,h)=>{h>0&&e.appendChild(n.createElement("br")),e.appendChild(a)}),e}class jr{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ae()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(ae("l")),R(e.props,"label",h=>{_(h)?this.element.classList.add(ae(void 0,"nol")):(this.element.classList.remove(ae(void 0,"nol")),go(i),i.appendChild(wo(t,h)))}),this.element.appendChild(i),this.labelElement=i;const a=t.createElement("div");a.classList.add(ae("v")),this.element.appendChild(a),this.valueElement=a}}class Ye extends oe{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new jr(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const xo={id:"button",type:"blade",accept(n){const t=K,e=G(n,{title:t.required.string,view:t.required.constant("button"),label:t.optional.string});return e?{params:e}:null},controller(n){return new Ye(n.document,{blade:n.blade,props:D.fromObject({label:n.params.label}),valueController:new Dt(n.document,{props:D.fromObject({title:n.params.title}),viewProps:n.viewProps})})},api(n){return!(n.controller instanceof Ye)||!(n.controller.valueController instanceof Dt)?null:new V(n.controller)}};class jt extends oe{constructor(t){super(t),this.value=t.value}}function le(){return new D({positions:z([],{equals:x})})}class ue extends D{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=D.createCore(e);return new ue(i)}get styleExpanded(){var t;return(t=this.get("temporaryExpanded"))!==null&&t!==void 0?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!_(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const i=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};R(this,"expanded",i),R(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function yo(n,t){let e=0;return fo(t,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),qe(t),e=t.clientHeight,n.set("temporaryExpanded",null),qe(t)}),e}function zr(n,t){t.style.height=n.styleHeight}function An(n,t){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),_(n.get("expandedHeight"))){const e=yo(n,t);e>0&&n.set("expandedHeight",e)}n.set("shouldFixHeight",!0),qe(t)}),n.emitter.on("change",()=>{zr(n,t)}),zr(n,t),t.addEventListener("transitionend",e=>{e.propertyName==="height"&&n.cleanUpTransition()})}class Mn extends u{constructor(t,e){super(t),this.rackApi_=e}}function Co(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}function Po(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}function Eo(n,t){const e=t??{};return n.addBlade(Object.assign(Object.assign({},e),{view:"separator"}))}function ko(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}class Nn{constructor(t){this.emitter=new E,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw w.shouldNeverHappen();const i=e!==void 0?e:this.items_.length;this.items_.splice(i,0,t),this.cache_.add(t);const a=this.extract_(t);a&&(a.emitter.on("add",this.onSubListAdd_),a.emitter.on("remove",this.onSubListRemove_),a.allItems().forEach(h=>{this.cache_.add(h)})),this.emitter.emit("add",{index:i,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const i=this.extract_(t);i&&(i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}class Ln extends u{constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new E,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new p(this,e,this.controller_.binding.target.presetKey,t.options.last)})}}class pt extends Ye{constructor(t,e){super(t,e),this.binding=e.binding}}class Dn extends u{constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new E,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new d(this,e,this.controller_.binding.target.presetKey)})}}class yt extends Ye{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function Vo(n){return n instanceof Xe?n.apiSet_:n instanceof Mn?n.rackApi_.apiSet_:null}function ce(n,t){const e=n.find(i=>i.controller_===t);if(!e)throw w.shouldNeverHappen();return e}function qr(n,t,e){if(!C.isBindable(n))throw w.notBindable();return new C(n,t,e)}class Xe extends u{constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new E,this.apiSet_=new Nn(Vo),this.pool_=e;const i=this.controller_.rack;i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),i.emitter.on("inputchange",this.onRackInputChange_),i.emitter.on("monitorupdate",this.onRackMonitorUpdate_),i.children.forEach(a=>{this.setUpApi_(a)})}get children(){return this.controller_.rack.children.map(t=>ce(this.apiSet_,t))}addInput(t,e,i){const a=i??{},h=this.controller_.view.element.ownerDocument,b=this.pool_.createInput(h,qr(t,e,a.presetKey),a),P=new Ln(b);return this.add(P,a.index)}addMonitor(t,e,i){const a=i??{},h=this.controller_.view.element.ownerDocument,b=this.pool_.createMonitor(h,qr(t,e),a),P=new Dn(b);return this.add(P,a.index)}addFolder(t){return Po(this,t)}addButton(t){return Co(this,t)}addSeparator(t){return Eo(this,t)}addTab(t){return ko(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const i=this.apiSet_.find(a=>a.controller_===t.controller_);return i&&this.apiSet_.remove(i),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,i=this.pool_.createBlade(e,t),a=this.pool_.createBladeApi(i);return this.add(a,t.index)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}setUpApi_(t){this.apiSet_.find(i=>i.controller_===t)||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=ce(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof pt){const i=ce(this.apiSet_,e),a=e.binding;this.emitter_.emit("change",{event:new p(i,a.target.read(),a.target.presetKey,t.options.last)})}else if(e instanceof jt){const i=ce(this.apiSet_,e);this.emitter_.emit("change",{event:new p(i,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof yt))throw w.shouldNeverHappen();const e=ce(this.apiSet_,t.bladeController),i=t.bladeController.binding;this.emitter_.emit("update",{event:new d(e,i.target.read(),i.target.presetKey)})}}class Rn extends Mn{constructor(t,e){super(t,new Xe(t.rackController,e)),this.emitter_=new E,this.controller_.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",{event:new m(this,i.sender.rawValue)})}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",{event:i})}),this.rackApi_.on("update",i=>{this.emitter_.emit("update",{event:i})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,i){return this.rackApi_.addInput(t,e,i)}addMonitor(t,e,i){return this.rackApi_.addMonitor(t,e,i)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}}class Tn extends oe{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class So{constructor(t,e){const i=g(e.viewName);this.element=t.createElement("div"),this.element.classList.add(i()),e.viewProps.bindClassModifiers(this.element)}}function Ao(n,t){for(let e=0;e<n.length;e++){const i=n[e];if(i instanceof pt&&i.binding===t)return i}return null}function Mo(n,t){for(let e=0;e<n.length;e++){const i=n[e];if(i instanceof yt&&i.binding===t)return i}return null}function No(n,t){for(let e=0;e<n.length;e++){const i=n[e];if(i instanceof jt&&i.value===t)return i}return null}function In(n){return n instanceof pe?n.rack:n instanceof Tn?n.rackController.rack:null}function Lo(n){const t=In(n);return t?t.bcSet_:null}class Do{constructor(t){var e,i;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new E,this.blade_=(e=t.blade)!==null&&e!==void 0?e:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=t.viewProps,this.bcSet_=new Nn(Lo),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){var i;(i=t.parent)===null||i===void 0||i.remove(t),y(t,"parent")?t.parent=this:(t.parent_=this,kn({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(t,e)}remove(t){y(t,"parent")?t.parent=null:(t.parent_=null,kn({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter(e=>e instanceof t)}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const i=t.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),i instanceof pt)i.binding.emitter.on("change",this.onChildInputChange_);else if(i instanceof yt)i.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(i instanceof jt)i.value.emitter.on("change",this.onChildValueChange_);else{const a=In(i);if(a){const h=a.emitter;h.on("layout",this.onDescendantLayout_),h.on("inputchange",this.onDescendantInputChange_),h.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const i=t.item;if(i instanceof pt)i.binding.emitter.off("change",this.onChildInputChange_);else if(i instanceof yt)i.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(i instanceof jt)i.value.emitter.off("change",this.onChildValueChange_);else{const a=In(i);if(a){const h=a.emitter;h.off("layout",this.onDescendantLayout_),h.off("inputchange",this.onDescendantInputChange_),h.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter(a=>!a.viewProps.get("hidden")),e=t[0],i=t[t.length-1];this.bcSet_.items.forEach(a=>{const h=[];a===e&&(h.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&h.push("veryfirst")),a===i&&(h.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&h.push("verylast")),a.blade.set("positions",h)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(e=>e.viewProps.get("disposed")).forEach(e=>{this.bcSet_.remove(e)})}onChildInputChange_(t){const e=Ao(this.find(pt),t.sender);if(!e)throw w.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=Mo(this.find(yt),t.sender);if(!e)throw w.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=No(this.find(jt),t.sender);if(!e)throw w.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class pe extends oe{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new So(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const i=new Do({blade:e.root?void 0:e.blade,viewProps:e.viewProps});i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),this.rack=i,this.viewProps.handleDispose(()=>{for(let a=this.rack.children.length-1;a>=0;a--)this.rack.children[a].viewProps.set("disposed",!0)})}onRackAdd_(t){t.isRoot&&Fr(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.isRoot&&Kr(t.bladeController.view.element)}}const Gr=g("cnt");class Ro{constructor(t,e){var i;this.className_=g((i=e.viewName)!==null&&i!==void 0?i:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),Gr()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),R(this.foldable_,"completed",B(this.element,this.className_(void 0,"cpl")));const a=t.createElement("button");a.classList.add(this.className_("b")),R(e.props,"title",N=>{_(N)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),e.viewProps.bindDisabled(a),this.element.appendChild(a),this.buttonElement=a;const h=t.createElement("div");h.classList.add(this.className_("i")),this.element.appendChild(h);const b=t.createElement("div");b.classList.add(this.className_("t")),H(e.props.value("title"),b),this.buttonElement.appendChild(b),this.titleElement=b;const P=t.createElement("div");P.classList.add(this.className_("m")),this.buttonElement.appendChild(P);const A=e.containerElement;A.classList.add(this.className_("c")),this.element.appendChild(A),this.containerElement=A}}class On extends Tn{constructor(t,e){var i;const a=ue.create((i=e.expanded)!==null&&i!==void 0?i:!0),h=new pe(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:h,view:new Ro(t,{containerElement:h.view.element,foldable:a,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=a,An(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const To={id:"folder",type:"blade",accept(n){const t=K,e=G(n,{title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean});return e?{params:e}:null},controller(n){return new On(n.document,{blade:n.blade,expanded:n.params.expanded,props:D.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof On?new Rn(n.controller,n.pool):null}};class zt extends jt{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new jr(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Yr extends u{}const Xr=g("spr");class Io{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Xr()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("hr");i.classList.add(Xr("r")),this.element.appendChild(i)}}class Wr extends oe{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Io(t,{viewProps:e.viewProps})}))}}const Oo={id:"separator",type:"blade",accept(n){const e=G(n,{view:K.required.constant("separator")});return e?{params:e}:null},controller(n){return new Wr(n.document,{blade:n.blade,viewProps:n.viewProps})},api(n){return n.controller instanceof Wr?new Yr(n.controller):null}},he=g("tbi");class Bo{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(he()),e.viewProps.bindClassModifiers(this.element),R(e.props,"selected",h=>{h?this.element.classList.add(he(void 0,"sel")):this.element.classList.remove(he(void 0,"sel"))});const i=t.createElement("button");i.classList.add(he("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const a=t.createElement("div");a.classList.add(he("t")),H(e.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a}}class $o{constructor(t,e){this.emitter=new E,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Bo(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Qr{constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new $o(t,{props:e.itemProps,viewProps:vt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new pe(t,{blade:le(),viewProps:vt.create()}),this.props=e.props,R(this.props,"selected",i=>{this.itemController.props.set("selected",i),this.contentController.viewProps.set("hidden",!i)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Jr{constructor(t,e){this.controller_=t,this.rackApi_=e}get title(){var t;return(t=this.controller_.itemController.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,i){return this.rackApi_.addInput(t,e,i)}addMonitor(t,e,i){return this.rackApi_.addMonitor(t,e,i)}addBlade(t){return this.rackApi_.addBlade(t)}}class Zr extends Mn{constructor(t,e){super(t,new Xe(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new E,this.pageApiMap_=new Map,this.rackApi_.on("change",i=>{this.emitter_.emit("change",{event:i})}),this.rackApi_.on("update",i=>{this.emitter_.emit("update",{event:i})}),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(i=>{this.setUpPageApi_(i)})}get pages(){return this.controller_.pageSet.items.map(t=>{const e=this.pageApiMap_.get(t);if(!e)throw w.shouldNeverHappen();return e})}addPage(t){const e=this.controller_.view.element.ownerDocument,i=new Qr(e,{itemProps:D.fromObject({selected:!1,title:t.title}),props:D.fromObject({selected:!1})});this.controller_.add(i,t.index);const a=this.pageApiMap_.get(i);if(!a)throw w.shouldNeverHappen();return a}removePage(t){this.controller_.remove(t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find(a=>a.controller_===t.contentController);if(!e)throw w.shouldNeverHappen();const i=new Jr(t,e);this.pageApiMap_.set(t,i)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw w.shouldNeverHappen();this.pageApiMap_.delete(t.item)}onSelect_(t){this.emitter_.emit("select",{event:new f(this,t.rawValue)})}}const ti=-1;class Fo{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=z(!0),this.selectedIndex=z(ti),this.items_=[]}add(t,e){const i=e??this.items_.length;this.items_.splice(i,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=ti,this.empty.rawValue=!0;return}const t=this.items_.findIndex(e=>e.rawValue);t<0?(this.items_.forEach((e,i)=>{e.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((e,i)=>{e.rawValue=i===t}),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex(i=>i===t.sender);this.items_.forEach((i,a)=>{i.rawValue=a===e}),this.selectedIndex.rawValue=e}else this.keepSelection_()}}const de=g("tab");class Ko{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(de(),Gr()),e.viewProps.bindClassModifiers(this.element),T(e.empty,B(this.element,de(void 0,"nop")));const i=t.createElement("div");i.classList.add(de("t")),this.element.appendChild(i),this.itemsElement=i;const a=t.createElement("div");a.classList.add(de("i")),this.element.appendChild(a);const h=e.contentsElement;h.classList.add(de("c")),this.element.appendChild(h),this.contentsElement=h}}class ei extends Tn{constructor(t,e){const i=new pe(t,{blade:e.blade,viewProps:e.viewProps}),a=new Fo;super({blade:e.blade,rackController:i,view:new Ko(t,{contentsElement:i.view.element,empty:a.empty,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new Nn(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=a}get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,e)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}onPageAdd_(t){const e=t.item;Fr(this.view.itemsElement,e.itemController.view.element,t.index),e.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(e.contentController,t.index),this.tab.add(e.props.value("selected"))}onPageRemove_(t){const e=t.item;Kr(e.itemController.view.element),e.itemController.viewProps.set("parent",null),this.rackController.rack.remove(e.contentController),this.tab.remove(e.props.value("selected"))}}const ni={id:"tab",type:"blade",accept(n){const t=K,e=G(n,{pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")});return!e||e.pages.length===0?null:{params:e}},controller(n){const t=new ei(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(e=>{const i=new Qr(n.document,{itemProps:D.fromObject({selected:!1,title:e.title}),props:D.fromObject({selected:!1})});t.add(i)}),t},api(n){return n.controller instanceof ei?new Zr(n.controller,n.pool):null}};function Uo(n,t){const e=n.accept(t.params);if(!e)return null;const i=K.optional.boolean(t.params.disabled).value,a=K.optional.boolean(t.params.hidden).value;return n.controller({blade:le(),document:t.document,params:Object.assign(Object.assign({},e.params),{disabled:i,hidden:a}),viewProps:vt.create({disabled:i,hidden:a})})}class Ho{constructor(){this.disabled=!1,this.emitter=new E}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class jo{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new E,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class zo{constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new E,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}read(){const t=this.target.read();t!==void 0&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}function ri(n,t){for(;n.length<t;)n.push(void 0)}function qo(n){const t=[];return ri(t,n),z(t)}function Go(n){const t=n.indexOf(void 0);return t<0?n:n.slice(0,t)}function Yo(n,t){const e=[...Go(n),t];return e.length>n.length?e.splice(0,e.length-n.length):ri(e,n.length),e}class Xo{constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new E,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(t===void 0)return;const e=this.value.rawValue,i=this.reader_(t);this.value.rawValue=Yo(e,i),this.emitter.emit("update",{rawValue:i,sender:this})}onTick_(t){this.read()}}class fe{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce((e,i)=>i.constrain(e),t)}}function mt(n,t){if(n instanceof t)return n;if(n instanceof fe){const e=n.constraints.reduce((i,a)=>i||(a instanceof t?a:null),null);if(e)return e}return null}class qt{constructor(t){this.values=D.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(t,i),e)}}class ve{constructor(t){this.values=D.fromObject({options:t})}get options(){return this.values.get("options")}constrain(t){const e=this.values.get("options");return e.length===0||e.filter(a=>a.value===t).length>0?t:e[0].value}}class ii{constructor(t){this.values=D.fromObject({max:t.max,min:t.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(t){const e=this.values.get("max"),i=this.values.get("min");let a=t;return _(i)||(a=Math.max(a,i)),_(e)||(a=Math.min(a,e)),a}}class We{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step,i=Math.round((t-e)/this.step);return e+i*this.step}}const Bn=g("lst");class Wo{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(Bn()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("select");i.classList.add(Bn("s")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const a=t.createElement("div");a.classList.add(Bn("m")),a.appendChild(Ge(t,"dropdown")),this.element.appendChild(a),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,R(this.props_,"options",h=>{Ur(this.selectElement),h.forEach(b=>{const P=t.createElement("option");P.textContent=b.text,this.selectElement.appendChild(P)}),this.update_()})}update_(){const t=this.props_.get("options").map(e=>e.value);this.selectElement.selectedIndex=t.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class me{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Wo(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=t.currentTarget;this.value.rawValue=this.props.get("options")[e.selectedIndex].value}}const si=g("pop");class Qo{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(si()),e.viewProps.bindClassModifiers(this.element),T(e.shows,B(this.element,si(void 0,"v")))}}class oi{constructor(t,e){this.shows=z(!1),this.viewProps=e.viewProps,this.view=new Qo(t,{shows:this.shows,viewProps:this.viewProps})}}const ai=g("txt");class Jo{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ai()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const i=t.createElement("input");i.classList.add(ai("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class Qe{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Jo(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const i=t.currentTarget.value,a=this.parser_(i);_(a)||(this.value.rawValue=a),this.view.refresh()}}function Zo(n){return String(n)}function li(n){return n==="false"?!1:!!n}function ui(n){return Zo(n)}class ta{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const ea={"**":(n,t)=>Math.pow(n,t),"*":(n,t)=>n*t,"/":(n,t)=>n/t,"%":(n,t)=>n%t,"+":(n,t)=>n+t,"-":(n,t)=>n-t,"<<":(n,t)=>n<<t,">>":(n,t)=>n>>t,">>>":(n,t)=>n>>>t,"&":(n,t)=>n&t,"^":(n,t)=>n^t,"|":(n,t)=>n|t};class na{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=ea[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const ra={"+":n=>n,"-":n=>-n,"~":n=>~n};class ia{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=ra[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function $n(n){return(t,e)=>{for(let i=0;i<n.length;i++){const a=n[i](t,e);if(a!=="")return a}return""}}function be(n,t){var e;const i=n.substr(t).match(/^\s+/);return(e=i&&i[0])!==null&&e!==void 0?e:""}function sa(n,t){const e=n.substr(t,1);return e.match(/^[1-9]$/)?e:""}function _e(n,t){var e;const i=n.substr(t).match(/^[0-9]+/);return(e=i&&i[0])!==null&&e!==void 0?e:""}function oa(n,t){const e=_e(n,t);if(e!=="")return e;const i=n.substr(t,1);if(t+=1,i!=="-"&&i!=="+")return"";const a=_e(n,t);return a===""?"":i+a}function Fn(n,t){const e=n.substr(t,1);if(t+=1,e.toLowerCase()!=="e")return"";const i=oa(n,t);return i===""?"":e+i}function ci(n,t){const e=n.substr(t,1);if(e==="0")return e;const i=sa(n,t);return t+=i.length,i===""?"":i+_e(n,t)}function aa(n,t){const e=ci(n,t);if(t+=e.length,e==="")return"";const i=n.substr(t,1);if(t+=i.length,i!==".")return"";const a=_e(n,t);return t+=a.length,e+i+a+Fn(n,t)}function la(n,t){const e=n.substr(t,1);if(t+=e.length,e!==".")return"";const i=_e(n,t);return t+=i.length,i===""?"":e+i+Fn(n,t)}function ua(n,t){const e=ci(n,t);return t+=e.length,e===""?"":e+Fn(n,t)}const ca=$n([aa,la,ua]);function pa(n,t){var e;const i=n.substr(t).match(/^[01]+/);return(e=i&&i[0])!==null&&e!==void 0?e:""}function ha(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0b")return"";const i=pa(n,t);return i===""?"":e+i}function da(n,t){var e;const i=n.substr(t).match(/^[0-7]+/);return(e=i&&i[0])!==null&&e!==void 0?e:""}function fa(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0o")return"";const i=da(n,t);return i===""?"":e+i}function va(n,t){var e;const i=n.substr(t).match(/^[0-9a-f]+/i);return(e=i&&i[0])!==null&&e!==void 0?e:""}function ma(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0x")return"";const i=va(n,t);return i===""?"":e+i}const ba=$n([ha,fa,ma]),_a=$n([ba,ca]);function ga(n,t){const e=_a(n,t);return t+=e.length,e===""?null:{evaluable:new ta(e),cursor:t}}function wa(n,t){const e=n.substr(t,1);if(t+=e.length,e!=="(")return null;const i=hi(n,t);if(!i)return null;t=i.cursor,t+=be(n,t).length;const a=n.substr(t,1);return t+=a.length,a!==")"?null:{evaluable:i.evaluable,cursor:t}}function xa(n,t){var e;return(e=ga(n,t))!==null&&e!==void 0?e:wa(n,t)}function pi(n,t){const e=xa(n,t);if(e)return e;const i=n.substr(t,1);if(t+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const a=pi(n,t);return a?(t=a.cursor,{cursor:t,evaluable:new ia(i,a.evaluable)}):null}function ya(n,t,e){e+=be(t,e).length;const i=n.filter(a=>t.startsWith(a,e))[0];return i?(e+=i.length,e+=be(t,e).length,{cursor:e,operator:i}):null}function Ca(n,t){return(e,i)=>{const a=n(e,i);if(!a)return null;i=a.cursor;let h=a.evaluable;for(;;){const b=ya(t,e,i);if(!b)break;i=b.cursor;const P=n(e,i);if(!P)return null;i=P.cursor,h=new na(b.operator,h,P.evaluable)}return h?{cursor:i,evaluable:h}:null}}const Pa=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,t)=>Ca(n,t),pi);function hi(n,t){return t+=be(n,t).length,Pa(n,t)}function Ea(n){const t=hi(n,0);return!t||t.cursor+be(n,t.cursor).length!==n.length?null:t.evaluable}function bt(n){var t;const e=Ea(n);return(t=e==null?void 0:e.evaluate())!==null&&t!==void 0?t:null}function di(n){if(typeof n=="number")return n;if(typeof n=="string"){const t=bt(n);if(!_(t))return t}return 0}function ka(n){return String(n)}function Y(n){return t=>t.toFixed(Math.max(Math.min(n,20),0))}const Va=Y(0);function Je(n){return Va(n)+"%"}function fi(n){return String(n)}function Kn(n){return n}function ge({primary:n,secondary:t,forward:e,backward:i}){let a=!1;function h(b){a||(a=!0,b(),a=!1)}n.emitter.on("change",b=>{h(()=>{t.setRawValue(e(n,t),b.options)})}),t.emitter.on("change",b=>{h(()=>{n.setRawValue(i(n,t),b.options)}),h(()=>{t.setRawValue(e(n,t),b.options)})}),h(()=>{t.setRawValue(e(n,t),{forceEmit:!1,last:!0})})}function rt(n,t){const e=n*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+e:t.downKey?-e:0}function we(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function _t(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function Sa(n){return n==="ArrowUp"||n==="ArrowDown"}function vi(n){return Sa(n)||n==="ArrowLeft"||n==="ArrowRight"}function Un(n,t){var e,i;const a=t.ownerDocument.defaultView,h=t.getBoundingClientRect();return{x:n.pageX-(((e=a&&a.scrollX)!==null&&e!==void 0?e:0)+h.left),y:n.pageY-(((i=a&&a.scrollY)!==null&&i!==void 0?i:0)+h.top)}}class Rt{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new E,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),(e=t.currentTarget)===null||e===void 0||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Un(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Un(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Un(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const i=(e=t.targetTouches.item(0))!==null&&e!==void 0?e:this.lastTouch_,a=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(i?{x:i.clientX-a.left,y:i.clientY-a.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function U(n,t,e,i,a){const h=(n-t)/(e-t);return i+h*(a-i)}function mi(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function q(n,t,e){return Math.min(Math.max(n,t),e)}function bi(n,t){return(n%t+t)%t}const ot=g("txt");class Aa{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(ot(),ot(void 0,"num")),e.arrayPosition&&this.element.classList.add(ot(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(ot("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ot()),this.inputElement.classList.add(ot("i"));const a=t.createElement("div");a.classList.add(ot("k")),this.element.appendChild(a),this.knobElement=a;const h=t.createElementNS(ct,"svg");h.classList.add(ot("g")),this.knobElement.appendChild(h);const b=t.createElementNS(ct,"path");b.classList.add(ot("gb")),h.appendChild(b),this.guideBodyElem_=b;const P=t.createElementNS(ct,"path");P.classList.add(ot("gh")),h.appendChild(P),this.guideHeadElem_=P;const A=t.createElement("div");A.classList.add(g("tt")()),this.knobElement.appendChild(A),this.tooltipElem_=A,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(t.rawValue===null){this.element.classList.remove(ot(void 0,"drg"));return}this.element.classList.add(ot(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),a=q(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+a},0 L${i},4 L${i+a},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const h=this.props_.get("formatter");this.tooltipElem_.textContent=h(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class xe{constructor(t,e){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=(i=e.sliderProps)!==null&&i!==void 0?i:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=z(null),this.view=new Aa(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const a=new Rt(this.view.knobElement);a.emitter.on("down",this.onPointerDown_),a.emitter.on("move",this.onPointerMove_),a.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,i;const a=(e=this.sliderProps_)===null||e===void 0?void 0:e.get("minValue"),h=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("maxValue");let b=t;return a!==void 0&&(b=Math.max(b,a)),h!==void 0&&(b=Math.min(b,h)),b}onInputChange_(t){const i=t.currentTarget.value,a=this.parser_(i);_(a)||(this.value.rawValue=this.constrainValue_(a)),this.view.refresh()}onInputKeyDown_(t){const e=rt(this.baseStep_,we(t));e!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){rt(this.baseStep_,we(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Hn=g("sld");class Ma{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Hn()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Hn("t")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const a=t.createElement("div");a.classList.add(Hn("k")),this.trackElement.appendChild(a),this.knobElement=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=q(U(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}}class Na{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new Ma(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Rt(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(U(q(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=rt(this.baseStep_,_t(t));e!==0&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){rt(this.baseStep_,_t(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const jn=g("sldtxt");class La{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(jn());const i=t.createElement("div");i.classList.add(jn("s")),this.sliderView_=e.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const a=t.createElement("div");a.classList.add(jn("t")),this.textView_=e.textView,a.appendChild(this.textView_.element),this.element.appendChild(a)}}class zn{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new Na(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new xe(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new La(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function ye(n,t){n.write(t)}function Ze(n){const t=K;if(Array.isArray(n))return t.required.array(t.required.object({text:t.required.string,value:t.required.raw}))(n).value;if(typeof n=="object")return t.required.raw(n).value}function _i(n){if(n==="inline"||n==="popup")return n}function Ct(n){const t=K;return t.required.object({max:t.optional.number,min:t.optional.number,step:t.optional.number})(n).value}function gi(n){if(Array.isArray(n))return n;const t=[];return Object.keys(n).forEach(e=>{t.push({text:e,value:n[e]})}),t}function qn(n){return _(n)?null:new ve(gi(n))}function Da(n){const t=n?mt(n,We):null;return t?t.step:null}function tn(n,t){const e=n&&mt(n,We);return e?mi(e.step):Math.max(mi(t),2)}function Gt(n){const t=Da(n);return t??1}function Yt(n,t){var e;const i=n&&mt(n,We),a=Math.abs((e=i==null?void 0:i.step)!==null&&e!==void 0?e:t);return a===0?.1:Math.pow(10,Math.floor(Math.log10(a))-1)}const en=g("ckb");class Ra{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(en()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("label");i.classList.add(en("l")),this.element.appendChild(i);const a=t.createElement("input");a.classList.add(en("i")),a.type="checkbox",i.appendChild(a),this.inputElement=a,e.viewProps.bindDisabled(this.inputElement);const h=t.createElement("div");h.classList.add(en("w")),i.appendChild(h);const b=Ge(t,"check");h.appendChild(b),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Ta{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Ra(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked}}function Ia(n){const t=[],e=qn(n.options);return e&&t.push(e),new fe(t)}const Oa={id:"input-bool",type:"input",accept:(n,t)=>{if(typeof n!="boolean")return null;const i=G(t,{options:K.optional.custom(Ze)});return i?{initialValue:n,params:i}:null},binding:{reader:n=>li,constraint:n=>Ia(n.params),writer:n=>ye},controller:n=>{const t=n.document,e=n.value,i=n.constraint,a=i&&mt(i,ve);return a?new me(t,{props:new D({options:a.values.value("options")}),value:e,viewProps:n.viewProps}):new Ta(t,{value:e,viewProps:n.viewProps})}},Tt=g("col");class Ba{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Tt()),e.foldable.bindExpandedClass(this.element,Tt(void 0,"expanded")),R(e.foldable,"completed",B(this.element,Tt(void 0,"cpl")));const i=t.createElement("div");i.classList.add(Tt("h")),this.element.appendChild(i);const a=t.createElement("div");a.classList.add(Tt("s")),i.appendChild(a),this.swatchElement=a;const h=t.createElement("div");if(h.classList.add(Tt("t")),i.appendChild(h),this.textElement=h,e.pickerLayout==="inline"){const b=t.createElement("div");b.classList.add(Tt("p")),this.element.appendChild(b),this.pickerElement=b}else this.pickerElement=null}}function $a(n,t,e){const i=q(n/255,0,1),a=q(t/255,0,1),h=q(e/255,0,1),b=Math.max(i,a,h),P=Math.min(i,a,h),A=b-P;let N=0,$=0;const F=(P+b)/2;return A!==0&&($=A/(1-Math.abs(b+P-1)),i===b?N=(a-h)/A:a===b?N=2+(h-i)/A:N=4+(i-a)/A,N=N/6+(N<0?1:0)),[N*360,$*100,F*100]}function Fa(n,t,e){const i=(n%360+360)%360,a=q(t/100,0,1),h=q(e/100,0,1),b=(1-Math.abs(2*h-1))*a,P=b*(1-Math.abs(i/60%2-1)),A=h-b/2;let N,$,F;return i>=0&&i<60?[N,$,F]=[b,P,0]:i>=60&&i<120?[N,$,F]=[P,b,0]:i>=120&&i<180?[N,$,F]=[0,b,P]:i>=180&&i<240?[N,$,F]=[0,P,b]:i>=240&&i<300?[N,$,F]=[P,0,b]:[N,$,F]=[b,0,P],[(N+A)*255,($+A)*255,(F+A)*255]}function Ka(n,t,e){const i=q(n/255,0,1),a=q(t/255,0,1),h=q(e/255,0,1),b=Math.max(i,a,h),P=Math.min(i,a,h),A=b-P;let N;A===0?N=0:b===i?N=60*(((a-h)/A%6+6)%6):b===a?N=60*((h-i)/A+2):N=60*((i-a)/A+4);const $=b===0?0:A/b,F=b;return[N,$*100,F*100]}function wi(n,t,e){const i=bi(n,360),a=q(t/100,0,1),h=q(e/100,0,1),b=h*a,P=b*(1-Math.abs(i/60%2-1)),A=h-b;let N,$,F;return i>=0&&i<60?[N,$,F]=[b,P,0]:i>=60&&i<120?[N,$,F]=[P,b,0]:i>=120&&i<180?[N,$,F]=[0,b,P]:i>=180&&i<240?[N,$,F]=[0,P,b]:i>=240&&i<300?[N,$,F]=[P,0,b]:[N,$,F]=[b,0,P],[(N+A)*255,($+A)*255,(F+A)*255]}function Ua(n,t,e){const i=e+t*(100-Math.abs(2*e-100))/200;return[n,i!==0?t*(100-Math.abs(2*e-100))/i:0,e+t*(100-Math.abs(2*e-100))/(2*100)]}function Ha(n,t,e){const i=100-Math.abs(e*(200-t)/100-100);return[n,i!==0?t*e/i:0,e*(200-t)/(2*100)]}function It(n){return[n[0],n[1],n[2]]}function xi(n,t){return[n[0],n[1],n[2],t]}const ja={hsl:{hsl:(n,t,e)=>[n,t,e],hsv:Ua,rgb:Fa},hsv:{hsl:Ha,hsv:(n,t,e)=>[n,t,e],rgb:wi},rgb:{hsl:$a,hsv:Ka,rgb:(n,t,e)=>[n,t,e]}};function nn(n,t){return[t==="float"?1:n==="rgb"?255:360,t==="float"?1:n==="rgb"?255:100,t==="float"?1:n==="rgb"?255:100]}function za(n,t){return n===t?t:bi(n,t)}function qa(n,t,e){var i;const a=nn(t,e);return[t==="rgb"?q(n[0],0,a[0]):za(n[0],a[0]),q(n[1],0,a[1]),q(n[2],0,a[2]),q((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function yi(n,t,e,i){const a=nn(t,e),h=nn(t,i);return n.map((b,P)=>b/a[P]*h[P])}function Ga(n,t,e){const i=yi(n,t.mode,t.type,"int"),a=ja[t.mode][e.mode](...i);return yi(a,e.mode,"int",e.type)}function rn(n,t){return typeof n!="object"||_(n)?!1:t in n&&typeof n[t]=="number"}class I{static black(t="int"){return new I([0,0,0],"rgb",t)}static fromObject(t,e="int"){const i="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new I(i,"rgb",e)}static toRgbaObject(t,e="int"){return t.toRgbaObject(e)}static isRgbColorObject(t){return rn(t,"r")&&rn(t,"g")&&rn(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&rn(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode!==e.mode)return!1;const i=t.comps_,a=e.comps_;for(let h=0;h<i.length;h++)if(i[h]!==a[h])return!1;return!0}constructor(t,e,i="int"){this.mode=e,this.type=i,this.comps_=qa(t,e,i)}getComponents(t,e="int"){return xi(Ga(It(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:e}),this.comps_[3])}toRgbaObject(t="int"){const e=this.getComponents("rgb",t);return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const Pt=g("colp");class Ya{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(Pt()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Pt("hsv"));const a=t.createElement("div");a.classList.add(Pt("sv")),this.svPaletteView_=e.svPaletteView,a.appendChild(this.svPaletteView_.element),i.appendChild(a);const h=t.createElement("div");h.classList.add(Pt("h")),this.hPaletteView_=e.hPaletteView,h.appendChild(this.hPaletteView_.element),i.appendChild(h),this.element.appendChild(i);const b=t.createElement("div");if(b.classList.add(Pt("rgb")),this.textView_=e.textView,b.appendChild(this.textView_.element),this.element.appendChild(b),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const P=t.createElement("div");P.classList.add(Pt("a"));const A=t.createElement("div");A.classList.add(Pt("ap")),A.appendChild(this.alphaViews_.palette.element),P.appendChild(A);const N=t.createElement("div");N.classList.add(Pt("at")),N.appendChild(this.alphaViews_.text.element),P.appendChild(N),this.element.appendChild(P)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(e=>e.inputElement)];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function Xa(n){return n==="int"?"int":n==="float"?"float":void 0}function Gn(n){const t=K;return G(n,{alpha:t.optional.boolean,color:t.optional.object({alpha:t.optional.boolean,type:t.optional.custom(Xa)}),expanded:t.optional.boolean,picker:t.optional.custom(_i)})}function Ot(n){return n?.1:1}function Bt(n){var t;return(t=n.color)===null||t===void 0?void 0:t.type}function Wa(n,t){return n.alpha===t.alpha&&n.mode===t.mode&&n.notation===t.notation&&n.type===t.type}function at(n,t){const e=n.match(/^(.+)%$/);return Math.min(e?parseFloat(e[1])*.01*t:parseFloat(n),t)}const Qa={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function Ci(n){const t=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(n);const e=parseFloat(t[1]),i=t[2];return Qa[i](e)}function Pi(n){const t=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[at(t[1],255),at(t[2],255),at(t[3],255)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Ei(n){return t=>{const e=Pi(t);return e?new I(e,"rgb",n):null}}function ki(n){const t=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[at(t[1],255),at(t[2],255),at(t[3],255),at(t[4],1)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function Vi(n){return t=>{const e=ki(t);return e?new I(e,"rgb",n):null}}function Si(n){const t=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[Ci(t[1]),at(t[2],100),at(t[3],100)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Ai(n){return t=>{const e=Si(t);return e?new I(e,"hsl",n):null}}function Mi(n){const t=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[Ci(t[1]),at(t[2],100),at(t[3],100),at(t[4],1)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function Ni(n){return t=>{const e=Mi(t);return e?new I(e,"hsl",n):null}}function Li(n){const t=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];const e=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}function Ja(n){const t=Li(n);return t?new I(t,"rgb","int"):null}function Di(n){const t=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),U(parseInt(t[4]+t[4],16),0,255,0,1)];const e=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),U(parseInt(e[4],16),0,255,0,1)]:null}function Za(n){const t=Di(n);return t?new I(t,"rgb","int"):null}function Ri(n){const t=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const e=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Ti(n){return t=>{const e=Ri(t);return e?new I(e,"rgb",n):null}}function Ii(n){const t=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const e=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function Oi(n){return t=>{const e=Ii(t);return e?new I(e,"rgb",n):null}}const tl=[{parser:Li,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Di,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Pi,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:ki,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Si,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Mi,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Ri,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Ii,result:{alpha:!0,mode:"rgb",notation:"object"}}];function el(n){return tl.reduce((t,{parser:e,result:i})=>t||(e(n)?i:null),null)}function Yn(n,t="int"){const e=el(n);return e?e.notation==="hex"&&t!=="float"?Object.assign(Object.assign({},e),{type:"int"}):e.notation==="func"?Object.assign(Object.assign({},e),{type:t}):null:null}const Bi={int:[Ja,Za,Ei("int"),Vi("int"),Ai("int"),Ni("int"),Ti("int"),Oi("int")],float:[Ei("float"),Vi("float"),Ai("float"),Ni("float"),Ti("float"),Oi("float")]};function nl(n){const t=Bi[n];return e=>{if(typeof e!="string")return I.black(n);const i=t.reduce((a,h)=>a||h(e),null);return i??I.black(n)}}function Xn(n){const t=Bi[n];return e=>t.reduce((i,a)=>i||a(e),null)}function $i(n){const t=q(Math.floor(n),0,255).toString(16);return t.length===1?`0${t}`:t}function Fi(n,t="#"){const e=It(n.getComponents("rgb")).map($i).join("");return`${t}${e}`}function Wn(n,t="#"){const e=n.getComponents("rgb"),i=[e[0],e[1],e[2],e[3]*255].map($i).join("");return`${t}${i}`}function Ki(n,t){const e=Y(t==="float"?2:0);return`rgb(${It(n.getComponents("rgb",t)).map(a=>e(a)).join(", ")})`}function rl(n){return t=>Ki(t,n)}function sn(n,t){const e=Y(2),i=Y(t==="float"?2:0);return`rgba(${n.getComponents("rgb",t).map((h,b)=>(b===3?e:i)(h)).join(", ")})`}function il(n){return t=>sn(t,n)}function sl(n){const t=[Y(0),Je,Je];return`hsl(${It(n.getComponents("hsl")).map((i,a)=>t[a](i)).join(", ")})`}function ol(n){const t=[Y(0),Je,Je,Y(2)];return`hsla(${n.getComponents("hsl").map((i,a)=>t[a](i)).join(", ")})`}function Ui(n,t){const e=Y(t==="float"?2:0),i=["r","g","b"];return`{${It(n.getComponents("rgb",t)).map((h,b)=>`${i[b]}: ${e(h)}`).join(", ")}}`}function al(n){return t=>Ui(t,n)}function Hi(n,t){const e=Y(2),i=Y(t==="float"?2:0),a=["r","g","b","a"];return`{${n.getComponents("rgb",t).map((b,P)=>{const A=P===3?e:i;return`${a[P]}: ${A(b)}`}).join(", ")}}`}function ll(n){return t=>Hi(t,n)}const ul=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Fi},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Wn},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:sl},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:ol},...["int","float"].reduce((n,t)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"func",type:t},stringifier:rl(t)},{format:{alpha:!0,mode:"rgb",notation:"func",type:t},stringifier:il(t)},{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:al(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:ll(t)}],[])];function Qn(n){return ul.reduce((t,e)=>t||(Wa(e.format,n)?e.stringifier:null),null)}const Ce=g("apl");class cl{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Ce()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(Ce("b")),this.element.appendChild(i);const a=t.createElement("div");a.classList.add(Ce("c")),i.appendChild(a),this.colorElem_=a;const h=t.createElement("div");h.classList.add(Ce("m")),this.element.appendChild(h),this.markerElem_=h;const b=t.createElement("div");b.classList.add(Ce("p")),this.markerElem_.appendChild(b),this.previewElem_=b,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),i=new I([e[0],e[1],e[2],0],"rgb"),a=new I([e[0],e[1],e[2],255],"rgb"),h=["to right",sn(i),sn(a)];this.colorElem_.style.background=`linear-gradient(${h.join(",")})`,this.previewElem_.style.backgroundColor=sn(t);const b=U(e[3],0,1,0,100);this.markerElem_.style.left=`${b}%`}onValueChange_(){this.update_()}}class pl{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new cl(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Rt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=t.point.x/t.bounds.width,a=this.value.rawValue,[h,b,P]=a.getComponents("hsv");this.value.setRawValue(new I([h,b,P,i],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=rt(Ot(!0),_t(t));if(e===0)return;const i=this.value.rawValue,[a,h,b,P]=i.getComponents("hsv");this.value.setRawValue(new I([a,h,b,P+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){rt(Ot(!0),_t(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Xt=g("coltxt");function hl(n){const t=n.createElement("select"),e=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return t.appendChild(e.reduce((i,a)=>{const h=n.createElement("option");return h.textContent=a.text,h.value=a.value,i.appendChild(h),i},n.createDocumentFragment())),t}class dl{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Xt()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Xt("m")),this.modeElem_=hl(t),this.modeElem_.classList.add(Xt("ms")),i.appendChild(this.modeSelectElement),e.viewProps.bindDisabled(this.modeElem_);const a=t.createElement("div");a.classList.add(Xt("mm")),a.appendChild(Ge(t,"dropdown")),i.appendChild(a),this.element.appendChild(i);const h=t.createElement("div");h.classList.add(Xt("w")),this.element.appendChild(h),this.textsElem_=h,this.textViews_=e.textViews,this.applyTextViews_(),T(e.colorMode,b=>{this.modeElem_.value=b})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){Ur(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach(e=>{const i=t.createElement("div");i.classList.add(Xt("c")),i.appendChild(e.element),this.textsElem_.appendChild(i)})}}function fl(n){return Y(n==="float"?2:0)}function vl(n,t,e){const i=nn(n,t)[e];return new qt({min:0,max:i})}function Jn(n,t,e){return new xe(n,{arrayPosition:e===0?"fst":e===3-1?"lst":"mid",baseStep:Ot(!1),parser:t.parser,props:D.fromObject({draggingScale:t.colorType==="float"?.01:1,formatter:fl(t.colorType)}),value:z(0,{constraint:vl(t.colorMode,t.colorType,e)}),viewProps:t.viewProps})}class ml{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=z(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new dl(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},i=[Jn(t,e,0),Jn(t,e,1),Jn(t,e,2)];return i.forEach((a,h)=>{ge({primary:this.value,secondary:a.value,forward:b=>b.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[h],backward:(b,P)=>{const A=this.colorMode.rawValue,N=b.rawValue.getComponents(A,this.colorType_);return N[h]=P.rawValue,new I(xi(It(N),N[3]),A,this.colorType_)}})}),i}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Zn=g("hpl");class bl{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Zn()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(Zn("c")),this.element.appendChild(i);const a=t.createElement("div");a.classList.add(Zn("m")),this.element.appendChild(a),this.markerElem_=a,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=Ki(new I([e,100,100],"hsv"));const i=U(e,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}}class _l{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new bl(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Rt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=U(q(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),a=this.value.rawValue,[,h,b,P]=a.getComponents("hsv");this.value.setRawValue(new I([i,h,b,P],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=rt(Ot(!1),_t(t));if(e===0)return;const i=this.value.rawValue,[a,h,b,P]=i.getComponents("hsv");this.value.setRawValue(new I([a+e,h,b,P],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){rt(Ot(!1),_t(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const tr=g("svp"),ji=64;class gl{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(tr()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("canvas");i.height=ji,i.width=ji,i.classList.add(tr("c")),this.element.appendChild(i),this.canvasElement=i;const a=t.createElement("div");a.classList.add(tr("m")),this.element.appendChild(a),this.markerElem_=a,this.update_()}update_(){const t=bo(this.canvasElement);if(!t)return;const i=this.value.rawValue.getComponents("hsv"),a=this.canvasElement.width,h=this.canvasElement.height,b=t.getImageData(0,0,a,h),P=b.data;for(let $=0;$<h;$++)for(let F=0;F<a;F++){const $t=U(F,0,a,0,100),Ee=U($,0,h,100,0),ke=wi(i[0],$t,Ee),on=($*a+F)*4;P[on]=ke[0],P[on+1]=ke[1],P[on+2]=ke[2],P[on+3]=255}t.putImageData(b,0,0);const A=U(i[1],0,100,0,100);this.markerElem_.style.left=`${A}%`;const N=U(i[2],0,100,100,0);this.markerElem_.style.top=`${N}%`}onValueChange_(){this.update_()}}class wl{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new gl(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Rt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=U(t.point.x,0,t.bounds.width,0,100),a=U(t.point.y,0,t.bounds.height,100,0),[h,,,b]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new I([h,i,a,b],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){vi(t.key)&&t.preventDefault();const[e,i,a,h]=this.value.rawValue.getComponents("hsv"),b=Ot(!1),P=rt(b,_t(t)),A=rt(b,we(t));P===0&&A===0||this.value.setRawValue(new I([e,i+P,a+A,h],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=Ot(!1),i=rt(e,_t(t)),a=rt(e,we(t));i===0&&a===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class xl{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new _l(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new wl(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new pl(t,{value:this.value,viewProps:this.viewProps}),text:new xe(t,{parser:bt,baseStep:.1,props:D.fromObject({draggingScale:.01,formatter:Y(2)}),value:z(0,{constraint:new qt({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&ge({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.rawValue.getComponents()[3],backward:(i,a)=>{const h=i.rawValue.getComponents();return h[3]=a.rawValue,new I(h,i.rawValue.mode)}}),this.textC_=new ml(t,{colorType:e.colorType,parser:bt,value:this.value,viewProps:this.viewProps}),this.view=new Ya(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}get textController(){return this.textC_}}const er=g("colsw");class yl{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(er()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(er("sw")),this.element.appendChild(i),this.swatchElem_=i;const a=t.createElement("button");a.classList.add(er("b")),e.viewProps.bindDisabled(a),this.element.appendChild(a),this.buttonElement=a,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=Wn(t)}onValueChange_(){this.update_()}}class Cl{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new yl(t,{value:this.value,viewProps:this.viewProps})}}class nr{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=ue.create(e.expanded),this.swatchC_=new Cl(t,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Qe(t,{parser:e.parser,props:D.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Ba(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=e.pickerLayout==="popup"?new oi(t,{viewProps:this.viewProps}):null;const a=new xl(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});a.view.allFocusableElements.forEach(h=>{h.addEventListener("blur",this.onPopupChildBlur_),h.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=a,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(a.view.element),ge({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:h=>h.rawValue,backward:(h,b)=>b.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),An(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=Hr(t);i&&e.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!Sn(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function Pl(n,t){return I.isColorObject(n)?I.fromObject(n,t):I.black(t)}function El(n){return It(n.getComponents("rgb")).reduce((t,e)=>t<<8|Math.floor(e)&255,0)}function kl(n){return n.getComponents("rgb").reduce((t,e,i)=>{const a=Math.floor(i===3?e*255:e)&255;return t<<8|a},0)>>>0}function Vl(n){return new I([n>>16&255,n>>8&255,n&255],"rgb")}function Sl(n){return new I([n>>24&255,n>>16&255,n>>8&255,U(n&255,0,255,0,1)],"rgb")}function Al(n){return typeof n!="number"?I.black():Vl(n)}function Ml(n){return typeof n!="number"?I.black():Sl(n)}function Nl(n){const t=Qn(n);return t?(e,i)=>{ye(e,t(i))}:null}function Ll(n){const t=n?kl:El;return(e,i)=>{ye(e,t(i))}}function Dl(n,t,e){const i=t.toRgbaObject(e);n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b),n.writeProperty("a",i.a)}function Rl(n,t,e){const i=t.toRgbaObject(e);n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b)}function Tl(n,t){return(e,i)=>{n?Dl(e,i,t):Rl(e,i,t)}}function rr(n){var t;return!!(n!=null&&n.alpha||!((t=n==null?void 0:n.color)===null||t===void 0)&&t.alpha)}function Il(n){return n?t=>Wn(t,"0x"):t=>Fi(t,"0x")}function Ol(n){return"color"in n||"view"in n&&n.view==="color"}const Bl={id:"input-color-number",type:"input",accept:(n,t)=>{if(typeof n!="number"||!Ol(t))return null;const e=Gn(t);return e?{initialValue:n,params:e}:null},binding:{reader:n=>rr(n.params)?Ml:Al,equals:I.equals,writer:n=>Ll(rr(n.params))},controller:n=>{const t=rr(n.params),e="expanded"in n.params?n.params.expanded:void 0,i="picker"in n.params?n.params.picker:void 0;return new nr(n.document,{colorType:"int",expanded:e??!1,formatter:Il(t),parser:Xn("int"),pickerLayout:i??"popup",supportsAlpha:t,value:n.value,viewProps:n.viewProps})}};function $l(n){return I.isRgbaColorObject(n)}function Fl(n){return t=>Pl(t,n)}function Kl(n,t){return e=>n?Hi(e,t):Ui(e,t)}const Ul={id:"input-color-object",type:"input",accept:(n,t)=>{if(!I.isColorObject(n))return null;const e=Gn(t);return e?{initialValue:n,params:e}:null},binding:{reader:n=>Fl(Bt(n.params)),equals:I.equals,writer:n=>Tl($l(n.initialValue),Bt(n.params))},controller:n=>{var t;const e=I.isRgbaColorObject(n.initialValue),i="expanded"in n.params?n.params.expanded:void 0,a="picker"in n.params?n.params.picker:void 0,h=(t=Bt(n.params))!==null&&t!==void 0?t:"int";return new nr(n.document,{colorType:h,expanded:i??!1,formatter:Kl(e,h),parser:Xn(h),pickerLayout:a??"popup",supportsAlpha:e,value:n.value,viewProps:n.viewProps})}},Hl={id:"input-color-string",type:"input",accept:(n,t)=>{if(typeof n!="string"||"view"in t&&t.view==="text")return null;const e=Yn(n,Bt(t));if(!e||!Qn(e))return null;const a=Gn(t);return a?{initialValue:n,params:a}:null},binding:{reader:n=>{var t;return nl((t=Bt(n.params))!==null&&t!==void 0?t:"int")},equals:I.equals,writer:n=>{const t=Yn(n.initialValue,Bt(n.params));if(!t)throw w.shouldNeverHappen();const e=Nl(t);if(!e)throw w.notBindable();return e}},controller:n=>{const t=Yn(n.initialValue,Bt(n.params));if(!t)throw w.shouldNeverHappen();const e=Qn(t);if(!e)throw w.shouldNeverHappen();const i="expanded"in n.params?n.params.expanded:void 0,a="picker"in n.params?n.params.picker:void 0;return new nr(n.document,{colorType:t.type,expanded:i??!1,formatter:e,parser:Xn(t.type),pickerLayout:a??"popup",supportsAlpha:t.alpha,value:n.value,viewProps:n.viewProps})}};class Et{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map((i,a)=>{var h,b;return(b=(h=this.components[a])===null||h===void 0?void 0:h.constrain(i))!==null&&b!==void 0?b:i});return this.asm_.fromComponents(e)}}const zi=g("pndtxt");class jl{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(zi()),this.textViews.forEach(i=>{const a=t.createElement("div");a.classList.add(zi("a")),a.appendChild(i.element),this.element.appendChild(a)})}}function zl(n,t,e){return new xe(n,{arrayPosition:e===0?"fst":e===t.axes.length-1?"lst":"mid",baseStep:t.axes[e].baseStep,parser:t.parser,props:t.axes[e].textProps,value:z(0,{constraint:t.axes[e].constraint}),viewProps:t.viewProps})}class ir{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map((i,a)=>zl(t,e,a)),this.acs_.forEach((i,a)=>{ge({primary:this.value,secondary:i.value,forward:h=>e.assembly.toComponents(h.rawValue)[a],backward:(h,b)=>{const P=e.assembly.toComponents(h.rawValue);return P[a]=b.rawValue,e.assembly.fromComponents(P)}})}),this.view=new jl(t,{textViews:this.acs_.map(i=>i.view)})}}function qi(n,t){return"step"in n&&!_(n.step)?new We(n.step,t):null}function Gi(n){return!_(n.max)&&!_(n.min)?new qt({max:n.max,min:n.min}):!_(n.max)||!_(n.min)?new ii({max:n.max,min:n.min}):null}function ql(n){const t=mt(n,qt);if(t)return[t.values.get("min"),t.values.get("max")];const e=mt(n,ii);return e?[e.minValue,e.maxValue]:[void 0,void 0]}function Gl(n,t){const e=[],i=qi(n,t);i&&e.push(i);const a=Gi(n);a&&e.push(a);const h=qn(n.options);return h&&e.push(h),new fe(e)}const Yl={id:"input-number",type:"input",accept:(n,t)=>{if(typeof n!="number")return null;const e=K,i=G(t,{format:e.optional.function,max:e.optional.number,min:e.optional.number,options:e.optional.custom(Ze),step:e.optional.number});return i?{initialValue:n,params:i}:null},binding:{reader:n=>di,constraint:n=>Gl(n.params,n.initialValue),writer:n=>ye},controller:n=>{var t;const e=n.value,i=n.constraint,a=i&&mt(i,ve);if(a)return new me(n.document,{props:new D({options:a.values.value("options")}),value:e,viewProps:n.viewProps});const h=(t="format"in n.params?n.params.format:void 0)!==null&&t!==void 0?t:Y(tn(i,e.rawValue)),b=i&&mt(i,qt);return b?new zn(n.document,{baseStep:Gt(i),parser:bt,sliderProps:new D({maxValue:b.values.value("max"),minValue:b.values.value("min")}),textProps:D.fromObject({draggingScale:Yt(i,e.rawValue),formatter:h}),value:e,viewProps:n.viewProps}):new xe(n.document,{baseStep:Gt(i),parser:bt,props:D.fromObject({draggingScale:Yt(i,e.rawValue),formatter:h}),value:e,viewProps:n.viewProps})}};class kt{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(_(t))return!1;const e=t.x,i=t.y;return!(typeof e!="number"||typeof i!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const Yi={toComponents:n=>n.getComponents(),fromComponents:n=>new kt(...n)},Wt=g("p2d");class Xl{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Wt()),e.viewProps.bindClassModifiers(this.element),T(e.expanded,B(this.element,Wt(void 0,"expanded")));const i=t.createElement("div");i.classList.add(Wt("h")),this.element.appendChild(i);const a=t.createElement("button");a.classList.add(Wt("b")),a.appendChild(Ge(t,"p2dpad")),e.viewProps.bindDisabled(a),i.appendChild(a),this.buttonElement=a;const h=t.createElement("div");if(h.classList.add(Wt("t")),i.appendChild(h),this.textElement=h,e.pickerLayout==="inline"){const b=t.createElement("div");b.classList.add(Wt("p")),this.element.appendChild(b),this.pickerElement=b}else this.pickerElement=null}}const Vt=g("p2dp");class Wl{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(Vt()),e.layout==="popup"&&this.element.classList.add(Vt(void 0,"p")),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Vt("p")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const a=t.createElementNS(ct,"svg");a.classList.add(Vt("g")),this.padElement.appendChild(a),this.svgElem_=a;const h=t.createElementNS(ct,"line");h.classList.add(Vt("ax")),h.setAttributeNS(null,"x1","0"),h.setAttributeNS(null,"y1","50%"),h.setAttributeNS(null,"x2","100%"),h.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(h);const b=t.createElementNS(ct,"line");b.classList.add(Vt("ax")),b.setAttributeNS(null,"x1","50%"),b.setAttributeNS(null,"y1","0"),b.setAttributeNS(null,"x2","50%"),b.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(b);const P=t.createElementNS(ct,"line");P.classList.add(Vt("l")),P.setAttributeNS(null,"x1","50%"),P.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(P),this.lineElem_=P;const A=t.createElement("div");A.classList.add(Vt("m")),this.padElement.appendChild(A),this.markerElem_=A,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),i=this.maxValue_,a=U(t,-i,+i,0,100),h=U(e,-i,+i,0,100),b=this.invertsY_?100-h:h;this.lineElem_.setAttributeNS(null,"x2",`${a}%`),this.lineElem_.setAttributeNS(null,"y2",`${b}%`),this.markerElem_.style.left=`${a}%`,this.markerElem_.style.top=`${b}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Xi(n,t,e){return[rt(t[0],_t(n)),rt(t[1],we(n))*(e?1:-1)]}class Ql{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new Wl(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Rt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=this.maxValue_,a=U(t.point.x,0,t.bounds.width,-i,+i),h=U(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-i,+i);this.value.setRawValue(new kt(a,h),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){vi(t.key)&&t.preventDefault();const[e,i]=Xi(t,this.baseSteps_,this.invertsY_);e===0&&i===0||this.value.setRawValue(new kt(this.value.rawValue.x+e,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,i]=Xi(t,this.baseSteps_,this.invertsY_);e===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Jl{constructor(t,e){var i,a;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=ue.create(e.expanded),this.popC_=e.pickerLayout==="popup"?new oi(t,{viewProps:this.viewProps}):null;const h=new Ql(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});h.view.allFocusableElements.forEach(b=>{b.addEventListener("blur",this.onPopupChildBlur_),b.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=h,this.textC_=new ir(t,{assembly:Yi,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Xl(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(a=this.view.buttonElement)===null||a===void 0||a.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),ge({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:b=>b.rawValue,backward:(b,P)=>P.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),An(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=Hr(t);i&&e.contains(i)||i&&i===this.view.buttonElement&&!Sn(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.view.buttonElement.focus()}}class Qt{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(_(t))return!1;const e=t.x,i=t.y,a=t.z;return!(typeof e!="number"||typeof i!="number"||typeof a!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Wi={toComponents:n=>n.getComponents(),fromComponents:n=>new Qt(...n)};function Zl(n){return Qt.isObject(n)?new Qt(n.x,n.y,n.z):new Qt}function tu(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y),n.writeProperty("z",t.z)}function eu(n,t){return new Et({assembly:Wi,components:[gt("x"in n?n.x:void 0,t.x),gt("y"in n?n.y:void 0,t.y),gt("z"in n?n.z:void 0,t.z)]})}function sr(n,t){return{baseStep:Gt(t),constraint:t,textProps:D.fromObject({draggingScale:Yt(t,n),formatter:Y(tn(t,n))})}}const nu={id:"input-point3d",type:"input",accept:(n,t)=>{if(!Qt.isObject(n))return null;const e=K,i=G(t,{x:e.optional.custom(Ct),y:e.optional.custom(Ct),z:e.optional.custom(Ct)});return i?{initialValue:n,params:i}:null},binding:{reader:n=>Zl,constraint:n=>eu(n.params,n.initialValue),equals:Qt.equals,writer:n=>tu},controller:n=>{const t=n.value,e=n.constraint;if(!(e instanceof Et))throw w.shouldNeverHappen();return new ir(n.document,{assembly:Wi,axes:[sr(t.rawValue.x,e.components[0]),sr(t.rawValue.y,e.components[1]),sr(t.rawValue.z,e.components[2])],parser:bt,value:t,viewProps:n.viewProps})}};class Jt{constructor(t=0,e=0,i=0,a=0){this.x=t,this.y=e,this.z=i,this.w=a}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(_(t))return!1;const e=t.x,i=t.y,a=t.z,h=t.w;return!(typeof e!="number"||typeof i!="number"||typeof a!="number"||typeof h!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Qi={toComponents:n=>n.getComponents(),fromComponents:n=>new Jt(...n)};function ru(n){return Jt.isObject(n)?new Jt(n.x,n.y,n.z,n.w):new Jt}function iu(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y),n.writeProperty("z",t.z),n.writeProperty("w",t.w)}function su(n,t){return new Et({assembly:Qi,components:[gt("x"in n?n.x:void 0,t.x),gt("y"in n?n.y:void 0,t.y),gt("z"in n?n.z:void 0,t.z),gt("w"in n?n.w:void 0,t.w)]})}function ou(n,t){return{baseStep:Gt(t),constraint:t,textProps:D.fromObject({draggingScale:Yt(t,n),formatter:Y(tn(t,n))})}}const au={id:"input-point4d",type:"input",accept:(n,t)=>{if(!Jt.isObject(n))return null;const e=K,i=G(t,{x:e.optional.custom(Ct),y:e.optional.custom(Ct),z:e.optional.custom(Ct),w:e.optional.custom(Ct)});return i?{initialValue:n,params:i}:null},binding:{reader:n=>ru,constraint:n=>su(n.params,n.initialValue),equals:Jt.equals,writer:n=>iu},controller:n=>{const t=n.value,e=n.constraint;if(!(e instanceof Et))throw w.shouldNeverHappen();return new ir(n.document,{assembly:Qi,axes:t.rawValue.getComponents().map((i,a)=>ou(i,e.components[a])),parser:bt,value:t,viewProps:n.viewProps})}};function lu(n){const t=[],e=qn(n.options);return e&&t.push(e),new fe(t)}const uu={id:"input-string",type:"input",accept:(n,t)=>{if(typeof n!="string")return null;const i=G(t,{options:K.optional.custom(Ze)});return i?{initialValue:n,params:i}:null},binding:{reader:n=>fi,constraint:n=>lu(n.params),writer:n=>ye},controller:n=>{const t=n.document,e=n.value,i=n.constraint,a=i&&mt(i,ve);return a?new me(t,{props:new D({options:a.values.value("options")}),value:e,viewProps:n.viewProps}):new Qe(t,{parser:h=>h,props:D.fromObject({formatter:Kn}),value:e,viewProps:n.viewProps})}},Pe={monitor:{defaultInterval:200,defaultLineCount:3}},Ji=g("mll");class cu{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Ji()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("textarea");i.classList.add(Ji("i")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,i.readOnly=!0,e.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,i=[];this.value.rawValue.forEach(a=>{a!==void 0&&i.push(this.formatter_(a))}),t.textContent=i.join(`
`),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class or{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new cu(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const Zi=g("sgl");class pu{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Zi()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(Zi("i")),i.readOnly=!0,i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=e!==void 0?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class ar{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new pu(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const hu={id:"monitor-bool",type:"monitor",accept:(n,t)=>{if(typeof n!="boolean")return null;const i=G(t,{lineCount:K.optional.number});return i?{initialValue:n,params:i}:null},binding:{reader:n=>li},controller:n=>{var t;return n.value.rawValue.length===1?new ar(n.document,{formatter:ui,value:n.value,viewProps:n.viewProps}):new or(n.document,{formatter:ui,lineCount:(t=n.params.lineCount)!==null&&t!==void 0?t:Pe.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}},St=g("grl");class du{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(St()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=t.createElementNS(ct,"svg");i.classList.add(St("g")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const a=t.createElementNS(ct,"polyline");this.svgElem_.appendChild(a),this.lineElem_=a;const h=t.createElement("div");h.classList.add(St("t"),g("tt")()),this.element.appendChild(h),this.tooltipElem_=h,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,i=this.props_.get("minValue"),a=this.props_.get("maxValue"),h=[];this.value.rawValue.forEach(($,F)=>{if($===void 0)return;const $t=U(F,0,e,0,t.width),Ee=U($,i,a,t.height,0);h.push([$t,Ee].join(","))}),this.lineElem_.setAttributeNS(null,"points",h.join(" "));const b=this.tooltipElem_,P=this.value.rawValue[this.cursor_.rawValue];if(P===void 0){b.classList.remove(St("t","a"));return}const A=U(this.cursor_.rawValue,0,e,0,t.width),N=U(P,i,a,t.height,0);b.style.left=`${A}px`,b.style.top=`${N}px`,b.textContent=`${this.formatter_(P)}`,b.classList.contains(St("t","a"))||(b.classList.add(St("t","a"),St("t","in")),qe(b),b.classList.remove(St("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class fu{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=z(-1),this.view=new du(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!Sn(t))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Rt(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(U(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){if(!t.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(U(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function lr(n){return"format"in n&&!_(n.format)?n.format:Y(2)}function vu(n){var t;return n.value.rawValue.length===1?new ar(n.document,{formatter:lr(n.params),value:n.value,viewProps:n.viewProps}):new or(n.document,{formatter:lr(n.params),lineCount:(t=n.params.lineCount)!==null&&t!==void 0?t:Pe.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}function mu(n){var t,e,i;return new fu(n.document,{formatter:lr(n.params),lineCount:(t=n.params.lineCount)!==null&&t!==void 0?t:Pe.monitor.defaultLineCount,props:D.fromObject({maxValue:(e="max"in n.params?n.params.max:null)!==null&&e!==void 0?e:100,minValue:(i="min"in n.params?n.params.min:null)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function ts(n){return"view"in n&&n.view==="graph"}const bu={id:"monitor-number",type:"monitor",accept:(n,t)=>{if(typeof n!="number")return null;const e=K,i=G(t,{format:e.optional.function,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number,view:e.optional.string});return i?{initialValue:n,params:i}:null},binding:{defaultBufferSize:n=>ts(n)?64:1,reader:n=>di},controller:n=>ts(n.params)?mu(n):vu(n)},_u={id:"monitor-string",type:"monitor",accept:(n,t)=>{if(typeof n!="string")return null;const e=K,i=G(t,{lineCount:e.optional.number,multiline:e.optional.boolean});return i?{initialValue:n,params:i}:null},binding:{reader:n=>fi},controller:n=>{var t;const e=n.value;return e.rawValue.length>1||"multiline"in n.params&&n.params.multiline?new or(n.document,{formatter:Kn,lineCount:(t=n.params.lineCount)!==null&&t!==void 0?t:Pe.monitor.defaultLineCount,value:e,viewProps:n.viewProps}):new ar(n.document,{formatter:Kn,value:e,viewProps:n.viewProps})}};function gu(n,t){var e;const i=n.accept(t.target.read(),t.params);if(_(i))return null;const a=K,h={target:t.target,initialValue:i.initialValue,params:i.params},b=n.binding.reader(h),P=n.binding.constraint?n.binding.constraint(h):void 0,A=z(b(i.initialValue),{constraint:P,equals:n.binding.equals}),N=new zo({reader:b,target:t.target,value:A,writer:n.binding.writer(h)}),$=a.optional.boolean(t.params.disabled).value,F=a.optional.boolean(t.params.hidden).value,$t=n.controller({constraint:P,document:t.document,initialValue:i.initialValue,params:i.params,value:N.value,viewProps:vt.create({disabled:$,hidden:F})});return new pt(t.document,{binding:N,blade:le(),props:D.fromObject({label:"label"in t.params?(e=a.optional.string(t.params.label).value)!==null&&e!==void 0?e:null:t.target.key}),valueController:$t})}function wu(n,t){return t===0?new Ho:new jo(n,t??Pe.monitor.defaultInterval)}function xu(n,t){var e,i,a;const h=K,b=n.accept(t.target.read(),t.params);if(_(b))return null;const P={target:t.target,initialValue:b.initialValue,params:b.params},A=n.binding.reader(P),N=(i=(e=h.optional.number(t.params.bufferSize).value)!==null&&e!==void 0?e:n.binding.defaultBufferSize&&n.binding.defaultBufferSize(b.params))!==null&&i!==void 0?i:1,$=h.optional.number(t.params.interval).value,F=new Xo({reader:A,target:t.target,ticker:wu(t.document,$),value:qo(N)}),$t=h.optional.boolean(t.params.disabled).value,Ee=h.optional.boolean(t.params.hidden).value,ke=n.controller({document:t.document,params:b.params,value:F.value,viewProps:vt.create({disabled:$t,hidden:Ee})});return new yt(t.document,{binding:F,blade:le(),props:D.fromObject({label:"label"in t.params?(a=h.optional.string(t.params.label).value)!==null&&a!==void 0?a:null:t.target.key}),valueController:ke})}class yu{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){t.type==="blade"?this.pluginsMap_.blades.unshift(t):t.type==="input"?this.pluginsMap_.inputs.unshift(t):t.type==="monitor"&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,i){const a=e.read();if(_(a))throw new w({context:{key:e.key},type:"nomatchingcontroller"});const h=this.pluginsMap_.inputs.reduce((b,P)=>b??gu(P,{document:t,target:e,params:i}),null);if(h)return h;throw new w({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,i){const a=this.pluginsMap_.monitors.reduce((h,b)=>h??xu(b,{document:t,params:i,target:e}),null);if(a)return a;throw new w({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const i=this.pluginsMap_.blades.reduce((a,h)=>a??Uo(h,{document:t,params:e}),null);if(!i)throw new w({type:"nomatchingview",context:{params:e}});return i}createBladeApi(t){if(t instanceof pt)return new Ln(t);if(t instanceof yt)return new Dn(t);if(t instanceof pe)return new Xe(t,this);const e=this.pluginsMap_.blades.reduce((i,a)=>i??a.api({controller:t,pool:this}),null);if(!e)throw w.shouldNeverHappen();return e}}function Cu(){const n=new yu;return[Au,nu,au,uu,Yl,Hl,Ul,Bl,Oa,hu,_u,bu,xo,To,Oo,ni].forEach(t=>{n.register(t)}),n}function Pu(n){return kt.isObject(n)?new kt(n.x,n.y):new kt}function Eu(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y)}function gt(n,t){if(!n)return;const e=[],i=qi(n,t);i&&e.push(i);const a=Gi(n);return a&&e.push(a),new fe(e)}function ku(n,t){return new Et({assembly:Yi,components:[gt("x"in n?n.x:void 0,t.x),gt("y"in n?n.y:void 0,t.y)]})}function es(n,t){const[e,i]=n?ql(n):[];if(!_(e)||!_(i))return Math.max(Math.abs(e??0),Math.abs(i??0));const a=Gt(n);return Math.max(Math.abs(a)*10,Math.abs(t)*10)}function Vu(n,t){const e=t instanceof Et?t.components[0]:void 0,i=t instanceof Et?t.components[1]:void 0,a=es(e,n.x),h=es(i,n.y);return Math.max(a,h)}function ns(n,t){return{baseStep:Gt(t),constraint:t,textProps:D.fromObject({draggingScale:Yt(t,n),formatter:Y(tn(t,n))})}}function Su(n){if(!("y"in n))return!1;const t=n.y;return t&&"inverted"in t?!!t.inverted:!1}const Au={id:"input-point2d",type:"input",accept:(n,t)=>{if(!kt.isObject(n))return null;const e=K,i=G(t,{expanded:e.optional.boolean,picker:e.optional.custom(_i),x:e.optional.custom(Ct),y:e.optional.object({inverted:e.optional.boolean,max:e.optional.number,min:e.optional.number,step:e.optional.number})});return i?{initialValue:n,params:i}:null},binding:{reader:n=>Pu,constraint:n=>ku(n.params,n.initialValue),equals:kt.equals,writer:n=>Eu},controller:n=>{const t=n.document,e=n.value,i=n.constraint;if(!(i instanceof Et))throw w.shouldNeverHappen();const a="expanded"in n.params?n.params.expanded:void 0,h="picker"in n.params?n.params.picker:void 0;return new Jl(t,{axes:[ns(e.rawValue.x,i.components[0]),ns(e.rawValue.y,i.components[1])],expanded:a??!1,invertsY:Su(n.params),maxValue:Vu(e.rawValue,i),parser:bt,pickerLayout:h??"popup",value:e,viewProps:n.viewProps})}};class rs extends u{constructor(t){super(t),this.emitter_=new E,this.controller_.valueController.value.emitter.on("change",e=>{this.emitter_.emit("change",{event:new p(this,e.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}}class is extends u{constructor(t){super(t),this.emitter_=new E,this.controller_.valueController.value.emitter.on("change",e=>{this.emitter_.emit("change",{event:new p(this,e.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}}class ss extends u{constructor(t){super(t),this.emitter_=new E,this.controller_.valueController.value.emitter.on("change",e=>{this.emitter_.emit("change",{event:new p(this,e.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}}const Mu=function(){return{id:"list",type:"blade",accept(n){const t=K,e=G(n,{options:t.required.custom(Ze),value:t.required.raw,view:t.required.constant("list"),label:t.optional.string});return e?{params:e}:null},controller(n){const t=new ve(gi(n.params.options)),e=z(n.params.value,{constraint:t}),i=new me(n.document,{props:new D({options:t.values.value("options")}),value:e,viewProps:n.viewProps});return new zt(n.document,{blade:n.blade,props:D.fromObject({label:n.params.label}),valueController:i})},api(n){return!(n.controller instanceof zt)||!(n.controller.valueController instanceof me)?null:new rs(n.controller)}}}();function Nu(n){return n.reduce((t,e)=>Object.assign(t,{[e.presetKey]:e.read()}),{})}function Lu(n,t){n.forEach(e=>{const i=t[e.target.presetKey];i!==void 0&&e.writer(e.target,e.reader(i))})}class Du extends Rn{constructor(t,e){super(t,e)}get element(){return this.controller_.view.element}importPreset(t){const e=this.controller_.rackController.rack.find(pt).map(i=>i.binding);Lu(e,t),this.refresh()}exportPreset(){const t=this.controller_.rackController.rack.find(pt).map(e=>e.binding.target);return Nu(t)}refresh(){this.controller_.rackController.rack.find(pt).forEach(t=>{t.binding.read()}),this.controller_.rackController.rack.find(yt).forEach(t=>{t.binding.read()})}}class Ru extends On{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const Tu={id:"slider",type:"blade",accept(n){const t=K,e=G(n,{max:t.required.number,min:t.required.number,view:t.required.constant("slider"),format:t.optional.function,label:t.optional.string,value:t.optional.number});return e?{params:e}:null},controller(n){var t,e;const i=(t=n.params.value)!==null&&t!==void 0?t:0,a=new qt({max:n.params.max,min:n.params.min}),h=new zn(n.document,{baseStep:1,parser:bt,sliderProps:new D({maxValue:a.values.value("max"),minValue:a.values.value("min")}),textProps:D.fromObject({draggingScale:Yt(void 0,i),formatter:(e=n.params.format)!==null&&e!==void 0?e:ka}),value:z(i,{constraint:a}),viewProps:n.viewProps});return new zt(n.document,{blade:n.blade,props:D.fromObject({label:n.params.label}),valueController:h})},api(n){return!(n.controller instanceof zt)||!(n.controller.valueController instanceof zn)?null:new is(n.controller)}},Iu=function(){return{id:"text",type:"blade",accept(n){const t=K,e=G(n,{parse:t.required.function,value:t.required.raw,view:t.required.constant("text"),format:t.optional.function,label:t.optional.string});return e?{params:e}:null},controller(n){var t;const e=new Qe(n.document,{parser:n.params.parse,props:D.fromObject({formatter:(t=n.params.format)!==null&&t!==void 0?t:i=>String(i)}),value:z(n.params.value),viewProps:n.viewProps});return new zt(n.document,{blade:n.blade,props:D.fromObject({label:n.params.label}),valueController:e})},api(n){return!(n.controller instanceof zt)||!(n.controller.valueController instanceof Qe)?null:new ss(n.controller)}}}();function Ou(n){const t=n.createElement("div");return t.classList.add(g("dfw")()),n.body&&n.body.appendChild(t),t}function os(n,t,e){if(n.querySelector(`style[data-tp-style=${t}]`))return;const i=n.createElement("style");i.dataset.tpStyle=t,i.textContent=e,n.head.appendChild(i)}class Bu extends Du{constructor(t){var e,i;const a=t??{},h=(e=a.document)!==null&&e!==void 0?e:mo(),b=Cu(),P=new Ru(h,{expanded:a.expanded,blade:le(),props:D.fromObject({title:a.title}),viewProps:vt.create()});super(P,b),this.pool_=b,this.containerElem_=(i=a.container)!==null&&i!==void 0?i:Ou(h),this.containerElem_.appendChild(this.element),this.doc_=h,this.usesDefaultWrapper_=!a.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw w.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw w.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach(i=>{this.pool_.register(i),this.embedPluginStyle_(i)})}embedPluginStyle_(t){t.css&&os(this.document,`plugin-${t.id}`,t.css)}setUpDefaultPlugins_(){os(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(t=>{this.embedPluginStyle_(t)}),this.registerPlugin({plugins:[Tu,Mu,ni,Iu]})}}const $u=new l("3.1.10");o.BladeApi=u,o.ButtonApi=V,o.FolderApi=Rn,o.InputBindingApi=Ln,o.ListApi=rs,o.MonitorBindingApi=Dn,o.Pane=Bu,o.SeparatorApi=Yr,o.SliderApi=is,o.TabApi=Zr,o.TabPageApi=Jr,o.TextApi=ss,o.TpChangeEvent=p,o.VERSION=$u,Object.defineProperty(o,"__esModule",{value:!0})})})(wr,wr.exports);var $d=wr.exports;function Fd(r,s){const o=r+1,l=s+1,u=Array.from({length:o*l},(v,_)=>({index:_})),c=[];for(let v=0;v<s;v++)for(let _=0;_<r;_++){const x=v*r+_;c.push({index:x,vertices:[x+v,x+v+1,x+v+r+2,x+v+r+1]})}function p(v,_){return _*o+v}const d=[],m=[],f=[];for(let v=0;v<l;v++)for(let _=0;_<o;_++)_>0&&(f.push({source:p(_-1,v),target:p(_,v),linkType:"course"}),v<l-1&&m.push({source:p(_-1,v),target:p(_,v+1),linkType:"shear",stitch:p(_,v)-(v+1)}),v<l-1&&m.push({source:p(_,v),target:p(_-1,v+1),linkType:2,stitch:p(_,v)-(v+1)}),_<o-1&&d.push({source:p(_-1,v),target:p(_+1,v),linkType:"strut"})),v>0&&(f.push({source:p(_,v-1),target:p(_,v),linkType:"wale"}),v<l-1&&d.push({source:p(_,v-1),target:p(_,v+1),linkType:"strut"}));return{faces:c,vertices:u,strutLinks:d,shearLinks:m,stretchLinks:f}}const je=Ne("svg");let Q,Zs,Nt,Lr,Dr,Rr,Oe,Be,$e,wn,Fe,to=window.innerWidth,eo=window.innerHeight;const k={width:20,height:20,enableShear:!0,K_SHEAR:.5,shear_ratio:.5,enableStretch:!0,K_STRETCH:2.5,edge_length:20,enableStrut:!0,K_STRUT:2.5,enableCharge:!0,chargeStrength:-25,maxChargeDistance:.5,showFaces:!0,showVertices:!1,backgroundColor:"#192d3a",faceColor:"#327aa87c",vertexColor:"#16363867",vertexRadius:3,showStretch:!0,stretchColor:"#3078a67c",showStrut:!1,strutColor:"#b062a57c",showShear:!1,shearColor:"#3a7d227c",forceStrokeWidth:1,enableCollision:!1,iterations:3},Lt=new $d.Pane({title:"Wabric"});Lt.exportPreset();Lt.addInput(k,"width",{min:5,step:1}).on("change",Tr);Lt.addInput(k,"height",{min:5,step:1}).on("change",Tr);const et=Lt.addFolder({title:"Forces"});et.addInput(k,"enableStretch",{label:"Stretch Forces"}).on("change",st);et.addInput(k,"edge_length",{label:"Edge Length",min:10,max:200,step:1}).on("change",st);et.addInput(k,"K_STRETCH",{label:"K_stretch"}).on("change",st);et.addSeparator();et.addInput(k,"enableShear",{label:"Shear Forces"}).on("change",st);et.addInput(k,"shear_ratio",{label:"Shear Ratio"}).on("change",st);et.addInput(k,"K_SHEAR",{label:"K_shear"}).on("change",st);et.addSeparator();et.addInput(k,"enableStrut",{label:"Strut Forces"}).on("change",st);et.addInput(k,"K_STRUT",{label:"K_strut"}).on("change",st);et.addSeparator();et.addInput(k,"enableCharge",{label:"Charge"}).on("change",st);et.addInput(k,"chargeStrength",{label:"Charge Strength",min:-1e3,max:0,step:5}).on("change",st);et.addInput(k,"maxChargeDistance",{label:"Max Charge Distance",min:0,max:10,step:.1}).on("change",st);const X=Lt.addFolder({title:"Viz"});X.addInput(k,"backgroundColor",{label:"Background Color"}).on("change",lo);X.addInput(k,"showFaces",{label:"Draw Faces"}).on("change",()=>{io(),re()});X.addInput(k,"faceColor",{label:"Face Color"}).on("change",()=>wn.attr("fill",k.faceColor));X.addSeparator();X.addInput(k,"showVertices",{label:"Draw Vertices"}).on("change",()=>{ro(),re()});X.addInput(k,"vertexColor",{label:"Vertex Color"}).on("change",()=>Fe.attr("fill",k.vertexColor));X.addInput(k,"vertexRadius",{label:"Vertex Radius",min:2,max:30,step:1}).on("change",()=>Fe.attr("r",k.vertexRadius));X.addSeparator();X.addInput(k,"showStretch",{label:"Draw Stretch"}).on("change",()=>{so(),re()});X.addInput(k,"stretchColor",{label:"Stretch Color"}).on("change",()=>Oe.attr("stroke",k.stretchColor));X.addInput(k,"showShear",{label:"Draw Shear"}).on("change",()=>{oo(),re()});X.addInput(k,"shearColor",{label:"Shear Color"}).on("change",()=>Be.attr("stroke",k.shearColor));X.addInput(k,"showStrut",{label:"Draw Strut"}).on("change",()=>{ao(),re()});X.addInput(k,"strutColor",{label:"Strut Color"}).on("change",()=>$e.attr("stroke",k.strutColor));X.addInput(k,"forceStrokeWidth",{label:"Link Stroke Width",min:1,max:30,step:1}).on("change",()=>{Oe&&Oe.attr("stroke-width",k.forceStrokeWidth),Be&&Be.attr("stroke-width",k.forceStrokeWidth),$e&&$e.attr("stroke-width",k.forceStrokeWidth)});(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&(Lt.expanded=!1,et.expanded=!1,X.expanded=!1);const no=Lt.addFolder({title:"Advanced",expanded:!1});no.addInput(k,"enableCollision",{label:"Vertex Collision"}).on("change",st);no.addInput(k,"iterations",{label:"Iterations",min:1,max:15,step:1}).on("change",st);function Kd(r){return Nr(r).distance(2*k.edge_length).strength(k.K_STRUT).iterations(k.iterations)}function Ud(r){return Nr(r).distance(k.shear_ratio*Math.sqrt(2*Math.pow(k.edge_length,2))).strength(k.K_SHEAR).iterations(k.iterations)}function Hd(r){return Nr(r).distance(k.edge_length).strength(k.K_STRETCH).iterations(k.iterations)}function jd(){return ld(to/2,eo/2)}function zd(){return Od().strength(k.chargeStrength).distanceMax(k.maxChargeDistance*k.edge_length)}function qd(){return Vd().radius(k.vertexRadius)}function st(){Q.force("strut",k.enableStrut?Kd(Rr):null),Q.force("shear",k.enableShear?Ud(Dr):null),Q.force("stretch",k.enableStretch?Hd(Lr):null),Q.force("charge",k.enableCharge?zd():null),Q.force("collision",k.enableCollision?qd():null),Q.restart(),Q.alpha(.4)}function ro(){k.showVertices?(Fe=je.append("g").attr("class","vertices").selectAll().data(Nt).join("circle").attr("r",k.vertexRadius).attr("fill",k.vertexColor),Fe.call($s().on("start",Wd).on("drag",Qd).on("end",Jd))):Ue(".vertices").remove()}function io(){k.showFaces?(wn=je.append("g").attr("class","faces").selectAll().data(Zs).join("polygon").attr("fill",k.faceColor),wn.call($s().on("start",Gd).on("drag",Yd).on("end",Xd))):Ue(".faces").remove()}function so(){k.showStretch?Oe=je.append("g").attr("class","stretch").selectAll("line").data(Lr).enter().append("line").attr("stroke-linecap","round").attr("stroke",k.stretchColor).attr("stroke-width",k.forceStrokeWidth):Ue(".stretch").remove()}function oo(){k.showShear?Be=je.append("g").attr("class","shear").selectAll("line").data(Dr).enter().append("line").attr("stroke-linecap","round").attr("stroke",k.shearColor).attr("stroke-width",k.forceStrokeWidth):Ue(".shear").remove()}function ao(){k.showStrut?$e=je.append("g").attr("class","strut").selectAll("line").data(Rr).enter().append("line").attr("stroke-linecap","round").attr("stroke",k.strutColor).attr("stroke-width",k.forceStrokeWidth):Ue(".strut").remove()}function re(){k.showStretch&&Oe.attr("x1",r=>r.source.x).attr("y1",r=>r.source.y).attr("x2",r=>r.target.x).attr("y2",r=>r.target.y),k.showShear&&Be.attr("x1",r=>r.source.x).attr("y1",r=>r.source.y).attr("x2",r=>r.target.x).attr("y2",r=>r.target.y),k.showStrut&&$e.attr("x1",r=>r.source.x).attr("y1",r=>r.source.y).attr("x2",r=>r.target.x).attr("y2",r=>r.target.y),k.showVertices&&Fe.attr("cx",r=>r.x).attr("cy",r=>r.y),k.showFaces&&wn.attr("points",r=>r.vertices.reduce((s,o)=>`${s} ${Nt[o].x},${Nt[o].y}`,""))}function Gd(r){r.active||Q.alphaTarget(.5).restart(),r.subject.vertices.forEach(s=>{const o=Nt[s];o.fx=o.x,o.fy=o.y})}function Yd(r){r.subject.vertices.forEach(s=>{const o=Nt[s];o.fx+=r.dx,o.fy+=r.dy})}function Xd(r){r.active||Q.alphaTarget(0),r.subject.vertices.forEach(s=>{const o=Nt[s];o.fx=null,o.fy=null})}function Wd(r){r.active||Q.alphaTarget(.3).restart(),r.subject.fx=r.subject.x,r.subject.fy=r.subject.y}function Qd(r){r.subject.fx=r.x,r.subject.fy=r.y}function Jd(r){r.active||Q.alphaTarget(0),r.subject.fx=null,r.subject.fy=null}function lo(){document.body.style.backgroundColor=k.backgroundColor}function Zd(){k.edge_length=Math.min(eo,to)/Math.min(k.width,k.height)}function Tr(){Q&&(Q.stop(),Q=null),Zd(),{faces:Zs,vertices:Nt,stretchLinks:Lr,shearLinks:Dr,strutLinks:Rr}=Fd(k.width,k.height),Q=Id(Nt).force("center",jd()).on("tick",re),lo(),oo(),ao(),so(),io(),ro(),st(),Lt.refresh()}window.onload=()=>{Tr()};
