(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const c of u)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function o(u){const c={};return u.integrity&&(c.integrity=u.integrity),u.referrerPolicy&&(c.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?c.credentials="include":u.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(u){if(u.ep)return;u.ep=!0;const c=o(u);fetch(u.href,c)}})();var Yu={value:()=>{}};function kn(){for(var r=0,s=arguments.length,o={},l;r<s;++r){if(!(l=arguments[r]+"")||l in o||/[\s.]/.test(l))throw new Error("illegal type: "+l);o[l]=[]}return new bn(o)}function bn(r){this._=r}function Xu(r,s){return r.trim().split(/^|\s+/).map(function(o){var l="",u=o.indexOf(".");if(u>=0&&(l=o.slice(u+1),o=o.slice(0,u)),o&&!s.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:l}})}bn.prototype=kn.prototype={constructor:bn,on:function(r,s){var o=this._,l=Xu(r+"",o),u,c=-1,h=l.length;if(arguments.length<2){for(;++c<h;)if((u=(r=l[c]).type)&&(u=Wu(o[u],r.name)))return u;return}if(s!=null&&typeof s!="function")throw new Error("invalid callback: "+s);for(;++c<h;)if(u=(r=l[c]).type)o[u]=fs(o[u],r.name,s);else if(s==null)for(u in o)o[u]=fs(o[u],r.name,null);return this},copy:function(){var r={},s=this._;for(var o in s)r[o]=s[o].slice();return new bn(r)},call:function(r,s){if((u=arguments.length-2)>0)for(var o=new Array(u),l=0,u,c;l<u;++l)o[l]=arguments[l+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(c=this._[r],l=0,u=c.length;l<u;++l)c[l].value.apply(s,o)},apply:function(r,s,o){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var l=this._[r],u=0,c=l.length;u<c;++u)l[u].value.apply(s,o)}};function Wu(r,s){for(var o=0,l=r.length,u;o<l;++o)if((u=r[o]).name===s)return u.value}function fs(r,s,o){for(var l=0,u=r.length;l<u;++l)if(r[l].name===s){r[l]=Yu,r=r.slice(0,l).concat(r.slice(l+1));break}return o!=null&&r.push({name:s,value:o}),r}var gr="http://www.w3.org/1999/xhtml";const vs={svg:"http://www.w3.org/2000/svg",xhtml:gr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Sn(r){var s=r+="",o=s.indexOf(":");return o>=0&&(s=r.slice(0,o))!=="xmlns"&&(r=r.slice(o+1)),vs.hasOwnProperty(s)?{space:vs[s],local:r}:r}function Qu(r){return function(){var s=this.ownerDocument,o=this.namespaceURI;return o===gr&&s.documentElement.namespaceURI===gr?s.createElement(r):s.createElementNS(o,r)}}function Ju(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function Ts(r){var s=Sn(r);return(s.local?Ju:Qu)(s)}function Zu(){}function Vr(r){return r==null?Zu:function(){return this.querySelector(r)}}function tc(r){typeof r!="function"&&(r=Vr(r));for(var s=this._groups,o=s.length,l=new Array(o),u=0;u<o;++u)for(var c=s[u],h=c.length,d=l[u]=new Array(h),m,f,v=0;v<h;++v)(m=c[v])&&(f=r.call(m,m.__data__,v,c))&&("__data__"in m&&(f.__data__=m.__data__),d[v]=f);return new Z(l,this._parents)}function Ds(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function ec(){return[]}function Is(r){return r==null?ec:function(){return this.querySelectorAll(r)}}function nc(r){return function(){return Ds(r.apply(this,arguments))}}function rc(r){typeof r=="function"?r=nc(r):r=Is(r);for(var s=this._groups,o=s.length,l=[],u=[],c=0;c<o;++c)for(var h=s[c],d=h.length,m,f=0;f<d;++f)(m=h[f])&&(l.push(r.call(m,m.__data__,f,h)),u.push(m));return new Z(l,u)}function Os(r){return function(){return this.matches(r)}}function Fs(r){return function(s){return s.matches(r)}}var ic=Array.prototype.find;function sc(r){return function(){return ic.call(this.children,r)}}function oc(){return this.firstElementChild}function ac(r){return this.select(r==null?oc:sc(typeof r=="function"?r:Fs(r)))}var lc=Array.prototype.filter;function uc(){return Array.from(this.children)}function cc(r){return function(){return lc.call(this.children,r)}}function hc(r){return this.selectAll(r==null?uc:cc(typeof r=="function"?r:Fs(r)))}function pc(r){typeof r!="function"&&(r=Os(r));for(var s=this._groups,o=s.length,l=new Array(o),u=0;u<o;++u)for(var c=s[u],h=c.length,d=l[u]=[],m,f=0;f<h;++f)(m=c[f])&&r.call(m,m.__data__,f,c)&&d.push(m);return new Z(l,this._parents)}function Bs(r){return new Array(r.length)}function dc(){return new Z(this._enter||this._groups.map(Bs),this._parents)}function wn(r,s){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=s}wn.prototype={constructor:wn,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,s){return this._parent.insertBefore(r,s)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function fc(r){return function(){return r}}function vc(r,s,o,l,u,c){for(var h=0,d,m=s.length,f=c.length;h<f;++h)(d=s[h])?(d.__data__=c[h],l[h]=d):o[h]=new wn(r,c[h]);for(;h<m;++h)(d=s[h])&&(u[h]=d)}function mc(r,s,o,l,u,c,h){var d,m,f=new Map,v=s.length,_=c.length,x=new Array(v),y;for(d=0;d<v;++d)(m=s[d])&&(x[d]=y=h.call(m,m.__data__,d,s)+"",f.has(y)?u[d]=m:f.set(y,m));for(d=0;d<_;++d)y=h.call(r,c[d],d,c)+"",(m=f.get(y))?(l[d]=m,m.__data__=c[d],f.delete(y)):o[d]=new wn(r,c[d]);for(d=0;d<v;++d)(m=s[d])&&f.get(x[d])===m&&(u[d]=m)}function bc(r){return r.__data__}function _c(r,s){if(!arguments.length)return Array.from(this,bc);var o=s?mc:vc,l=this._parents,u=this._groups;typeof r!="function"&&(r=fc(r));for(var c=u.length,h=new Array(c),d=new Array(c),m=new Array(c),f=0;f<c;++f){var v=l[f],_=u[f],x=_.length,y=gc(r.call(v,v&&v.__data__,f,l)),V=y.length,w=d[f]=new Array(V),C=h[f]=new Array(V),S=m[f]=new Array(x);o(v,_,w,C,S,y,s);for(var E=0,L=0,g,M;E<V;++E)if(g=w[E]){for(E>=L&&(L=E+1);!(M=C[L])&&++L<V;);g._next=M||null}}return h=new Z(h,l),h._enter=d,h._exit=m,h}function gc(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function wc(){return new Z(this._exit||this._groups.map(Bs),this._parents)}function xc(r,s,o){var l=this.enter(),u=this,c=this.exit();return typeof r=="function"?(l=r(l),l&&(l=l.selection())):l=l.append(r+""),s!=null&&(u=s(u),u&&(u=u.selection())),o==null?c.remove():o(c),l&&u?l.merge(u).order():u}function yc(r){for(var s=r.selection?r.selection():r,o=this._groups,l=s._groups,u=o.length,c=l.length,h=Math.min(u,c),d=new Array(u),m=0;m<h;++m)for(var f=o[m],v=l[m],_=f.length,x=d[m]=new Array(_),y,V=0;V<_;++V)(y=f[V]||v[V])&&(x[V]=y);for(;m<u;++m)d[m]=o[m];return new Z(d,this._parents)}function Cc(){for(var r=this._groups,s=-1,o=r.length;++s<o;)for(var l=r[s],u=l.length-1,c=l[u],h;--u>=0;)(h=l[u])&&(c&&h.compareDocumentPosition(c)^4&&c.parentNode.insertBefore(h,c),c=h);return this}function Pc(r){r||(r=Ec);function s(_,x){return _&&x?r(_.__data__,x.__data__):!_-!x}for(var o=this._groups,l=o.length,u=new Array(l),c=0;c<l;++c){for(var h=o[c],d=h.length,m=u[c]=new Array(d),f,v=0;v<d;++v)(f=h[v])&&(m[v]=f);m.sort(s)}return new Z(u,this._parents).order()}function Ec(r,s){return r<s?-1:r>s?1:r>=s?0:NaN}function kc(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function Sc(){return Array.from(this)}function Vc(){for(var r=this._groups,s=0,o=r.length;s<o;++s)for(var l=r[s],u=0,c=l.length;u<c;++u){var h=l[u];if(h)return h}return null}function Ac(){let r=0;for(const s of this)++r;return r}function Mc(){return!this.node()}function Nc(r){for(var s=this._groups,o=0,l=s.length;o<l;++o)for(var u=s[o],c=0,h=u.length,d;c<h;++c)(d=u[c])&&r.call(d,d.__data__,c,u);return this}function Lc(r){return function(){this.removeAttribute(r)}}function Rc(r){return function(){this.removeAttributeNS(r.space,r.local)}}function Tc(r,s){return function(){this.setAttribute(r,s)}}function Dc(r,s){return function(){this.setAttributeNS(r.space,r.local,s)}}function Ic(r,s){return function(){var o=s.apply(this,arguments);o==null?this.removeAttribute(r):this.setAttribute(r,o)}}function Oc(r,s){return function(){var o=s.apply(this,arguments);o==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,o)}}function Fc(r,s){var o=Sn(r);if(arguments.length<2){var l=this.node();return o.local?l.getAttributeNS(o.space,o.local):l.getAttribute(o)}return this.each((s==null?o.local?Rc:Lc:typeof s=="function"?o.local?Oc:Ic:o.local?Dc:Tc)(o,s))}function $s(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function Bc(r){return function(){this.style.removeProperty(r)}}function $c(r,s,o){return function(){this.style.setProperty(r,s,o)}}function Kc(r,s,o){return function(){var l=s.apply(this,arguments);l==null?this.style.removeProperty(r):this.style.setProperty(r,l,o)}}function Uc(r,s,o){return arguments.length>1?this.each((s==null?Bc:typeof s=="function"?Kc:$c)(r,s,o??"")):oe(this.node(),r)}function oe(r,s){return r.style.getPropertyValue(s)||$s(r).getComputedStyle(r,null).getPropertyValue(s)}function Hc(r){return function(){delete this[r]}}function jc(r,s){return function(){this[r]=s}}function zc(r,s){return function(){var o=s.apply(this,arguments);o==null?delete this[r]:this[r]=o}}function qc(r,s){return arguments.length>1?this.each((s==null?Hc:typeof s=="function"?zc:jc)(r,s)):this.node()[r]}function Ks(r){return r.trim().split(/^|\s+/)}function Ar(r){return r.classList||new Us(r)}function Us(r){this._node=r,this._names=Ks(r.getAttribute("class")||"")}Us.prototype={add:function(r){var s=this._names.indexOf(r);s<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var s=this._names.indexOf(r);s>=0&&(this._names.splice(s,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function Hs(r,s){for(var o=Ar(r),l=-1,u=s.length;++l<u;)o.add(s[l])}function js(r,s){for(var o=Ar(r),l=-1,u=s.length;++l<u;)o.remove(s[l])}function Gc(r){return function(){Hs(this,r)}}function Yc(r){return function(){js(this,r)}}function Xc(r,s){return function(){(s.apply(this,arguments)?Hs:js)(this,r)}}function Wc(r,s){var o=Ks(r+"");if(arguments.length<2){for(var l=Ar(this.node()),u=-1,c=o.length;++u<c;)if(!l.contains(o[u]))return!1;return!0}return this.each((typeof s=="function"?Xc:s?Gc:Yc)(o,s))}function Qc(){this.textContent=""}function Jc(r){return function(){this.textContent=r}}function Zc(r){return function(){var s=r.apply(this,arguments);this.textContent=s??""}}function th(r){return arguments.length?this.each(r==null?Qc:(typeof r=="function"?Zc:Jc)(r)):this.node().textContent}function eh(){this.innerHTML=""}function nh(r){return function(){this.innerHTML=r}}function rh(r){return function(){var s=r.apply(this,arguments);this.innerHTML=s??""}}function ih(r){return arguments.length?this.each(r==null?eh:(typeof r=="function"?rh:nh)(r)):this.node().innerHTML}function sh(){this.nextSibling&&this.parentNode.appendChild(this)}function oh(){return this.each(sh)}function ah(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function lh(){return this.each(ah)}function uh(r){var s=typeof r=="function"?r:Ts(r);return this.select(function(){return this.appendChild(s.apply(this,arguments))})}function ch(){return null}function hh(r,s){var o=typeof r=="function"?r:Ts(r),l=s==null?ch:typeof s=="function"?s:Vr(s);return this.select(function(){return this.insertBefore(o.apply(this,arguments),l.apply(this,arguments)||null)})}function ph(){var r=this.parentNode;r&&r.removeChild(this)}function dh(){return this.each(ph)}function fh(){var r=this.cloneNode(!1),s=this.parentNode;return s?s.insertBefore(r,this.nextSibling):r}function vh(){var r=this.cloneNode(!0),s=this.parentNode;return s?s.insertBefore(r,this.nextSibling):r}function mh(r){return this.select(r?vh:fh)}function bh(r){return arguments.length?this.property("__data__",r):this.node().__data__}function _h(r){return function(s){r.call(this,s,this.__data__)}}function gh(r){return r.trim().split(/^|\s+/).map(function(s){var o="",l=s.indexOf(".");return l>=0&&(o=s.slice(l+1),s=s.slice(0,l)),{type:s,name:o}})}function wh(r){return function(){var s=this.__on;if(s){for(var o=0,l=-1,u=s.length,c;o<u;++o)c=s[o],(!r.type||c.type===r.type)&&c.name===r.name?this.removeEventListener(c.type,c.listener,c.options):s[++l]=c;++l?s.length=l:delete this.__on}}}function xh(r,s,o){return function(){var l=this.__on,u,c=_h(s);if(l){for(var h=0,d=l.length;h<d;++h)if((u=l[h]).type===r.type&&u.name===r.name){this.removeEventListener(u.type,u.listener,u.options),this.addEventListener(u.type,u.listener=c,u.options=o),u.value=s;return}}this.addEventListener(r.type,c,o),u={type:r.type,name:r.name,value:s,listener:c,options:o},l?l.push(u):this.__on=[u]}}function yh(r,s,o){var l=gh(r+""),u,c=l.length,h;if(arguments.length<2){var d=this.node().__on;if(d){for(var m=0,f=d.length,v;m<f;++m)for(u=0,v=d[m];u<c;++u)if((h=l[u]).type===v.type&&h.name===v.name)return v.value}return}for(d=s?xh:wh,u=0;u<c;++u)this.each(d(l[u],s,o));return this}function zs(r,s,o){var l=$s(r),u=l.CustomEvent;typeof u=="function"?u=new u(s,o):(u=l.document.createEvent("Event"),o?(u.initEvent(s,o.bubbles,o.cancelable),u.detail=o.detail):u.initEvent(s,!1,!1)),r.dispatchEvent(u)}function Ch(r,s){return function(){return zs(this,r,s)}}function Ph(r,s){return function(){return zs(this,r,s.apply(this,arguments))}}function Eh(r,s){return this.each((typeof s=="function"?Ph:Ch)(r,s))}function*kh(){for(var r=this._groups,s=0,o=r.length;s<o;++s)for(var l=r[s],u=0,c=l.length,h;u<c;++u)(h=l[u])&&(yield h)}var Mr=[null];function Z(r,s){this._groups=r,this._parents=s}function je(){return new Z([[document.documentElement]],Mr)}function Sh(){return this}Z.prototype=je.prototype={constructor:Z,select:tc,selectAll:rc,selectChild:ac,selectChildren:hc,filter:pc,data:_c,enter:dc,exit:wc,join:xc,merge:yc,selection:Sh,order:Cc,sort:Pc,call:kc,nodes:Sc,node:Vc,size:Ac,empty:Mc,each:Nc,attr:Fc,style:Uc,property:qc,classed:Wc,text:th,html:ih,raise:oh,lower:lh,append:uh,insert:hh,remove:dh,clone:mh,datum:bh,on:yh,dispatch:Eh,[Symbol.iterator]:kh};function Oe(r){return typeof r=="string"?new Z([[document.querySelector(r)]],[document.documentElement]):new Z([[r]],Mr)}function Vh(r){let s;for(;s=r.sourceEvent;)r=s;return r}function ms(r,s){if(r=Vh(r),s===void 0&&(s=r.currentTarget),s){var o=s.ownerSVGElement||s;if(o.createSVGPoint){var l=o.createSVGPoint();return l.x=r.clientX,l.y=r.clientY,l=l.matrixTransform(s.getScreenCTM().inverse()),[l.x,l.y]}if(s.getBoundingClientRect){var u=s.getBoundingClientRect();return[r.clientX-u.left-s.clientLeft,r.clientY-u.top-s.clientTop]}}return[r.pageX,r.pageY]}function ze(r){return typeof r=="string"?new Z([document.querySelectorAll(r)],[document.documentElement]):new Z([Ds(r)],Mr)}const Ah={passive:!1},Fe={capture:!0,passive:!1};function vr(r){r.stopImmediatePropagation()}function ie(r){r.preventDefault(),r.stopImmediatePropagation()}function Mh(r){var s=r.document.documentElement,o=Oe(r).on("dragstart.drag",ie,Fe);"onselectstart"in s?o.on("selectstart.drag",ie,Fe):(s.__noselect=s.style.MozUserSelect,s.style.MozUserSelect="none")}function Nh(r,s){var o=r.document.documentElement,l=Oe(r).on("dragstart.drag",null);s&&(l.on("click.drag",ie,Fe),setTimeout(function(){l.on("click.drag",null)},0)),"onselectstart"in o?l.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}const dn=r=>()=>r;function wr(r,{sourceEvent:s,subject:o,target:l,identifier:u,active:c,x:h,y:d,dx:m,dy:f,dispatch:v}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:s,enumerable:!0,configurable:!0},subject:{value:o,enumerable:!0,configurable:!0},target:{value:l,enumerable:!0,configurable:!0},identifier:{value:u,enumerable:!0,configurable:!0},active:{value:c,enumerable:!0,configurable:!0},x:{value:h,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:m,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:v}})}wr.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function Lh(r){return!r.ctrlKey&&!r.button}function Rh(){return this.parentNode}function Th(r,s){return s??{x:r.x,y:r.y}}function Dh(){return navigator.maxTouchPoints||"ontouchstart"in this}function qe(){var r=Lh,s=Rh,o=Th,l=Dh,u={},c=kn("start","drag","end"),h=0,d,m,f,v,_=0;function x(g){g.on("mousedown.drag",y).filter(l).on("touchstart.drag",C).on("touchmove.drag",S,Ah).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(g,M){if(!(v||!r.call(this,g,M))){var O=L(this,s.call(this,g,M),g,M,"mouse");O&&(Oe(g.view).on("mousemove.drag",V,Fe).on("mouseup.drag",w,Fe),Mh(g.view),vr(g),f=!1,d=g.clientX,m=g.clientY,O("start",g))}}function V(g){if(ie(g),!f){var M=g.clientX-d,O=g.clientY-m;f=M*M+O*O>_}u.mouse("drag",g)}function w(g){Oe(g.view).on("mousemove.drag mouseup.drag",null),Nh(g.view,f),ie(g),u.mouse("end",g)}function C(g,M){if(r.call(this,g,M)){var O=g.changedTouches,D=s.call(this,g,M),T=O.length,j,F;for(j=0;j<T;++j)(F=L(this,D,g,M,O[j].identifier,O[j]))&&(vr(g),F("start",g,O[j]))}}function S(g){var M=g.changedTouches,O=M.length,D,T;for(D=0;D<O;++D)(T=u[M[D].identifier])&&(ie(g),T("drag",g,M[D]))}function E(g){var M=g.changedTouches,O=M.length,D,T;for(v&&clearTimeout(v),v=setTimeout(function(){v=null},500),D=0;D<O;++D)(T=u[M[D].identifier])&&(vr(g),T("end",g,M[D]))}function L(g,M,O,D,T,j){var F=c.copy(),H=ms(j||O,M),Q,nt,Tt;if((Tt=o.call(g,new wr("beforestart",{sourceEvent:O,target:x,identifier:T,active:h,x:H[0],y:H[1],dx:0,dy:0,dispatch:F}),D))!=null)return Q=Tt.x-H[0]||0,nt=Tt.y-H[1]||0,function Nn(ce,z,R){var Qe=H,he;switch(ce){case"start":u[T]=Nn,he=h++;break;case"end":delete u[T],--h;case"drag":H=ms(R||z,M),he=h;break}F.call(ce,g,new wr(ce,{sourceEvent:z,subject:Tt,target:x,identifier:T,active:he,x:H[0]+Q,y:H[1]+nt,dx:H[0]-Qe[0],dy:H[1]-Qe[1],dispatch:F}),D)}}return x.filter=function(g){return arguments.length?(r=typeof g=="function"?g:dn(!!g),x):r},x.container=function(g){return arguments.length?(s=typeof g=="function"?g:dn(g),x):s},x.subject=function(g){return arguments.length?(o=typeof g=="function"?g:dn(g),x):o},x.touchable=function(g){return arguments.length?(l=typeof g=="function"?g:dn(!!g),x):l},x.on=function(){var g=c.on.apply(c,arguments);return g===c?x:g},x.clickDistance=function(g){return arguments.length?(_=(g=+g)*g,x):Math.sqrt(_)},x}function Nr(r,s,o){r.prototype=s.prototype=o,o.constructor=r}function qs(r,s){var o=Object.create(r.prototype);for(var l in s)o[l]=s[l];return o}function Ge(){}var Be=.7,xn=1/Be,se="\\s*([+-]?\\d+)\\s*",$e="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",pt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ih=/^#([0-9a-f]{3,8})$/,Oh=new RegExp(`^rgb\\(${se},${se},${se}\\)$`),Fh=new RegExp(`^rgb\\(${pt},${pt},${pt}\\)$`),Bh=new RegExp(`^rgba\\(${se},${se},${se},${$e}\\)$`),$h=new RegExp(`^rgba\\(${pt},${pt},${pt},${$e}\\)$`),Kh=new RegExp(`^hsl\\(${$e},${pt},${pt}\\)$`),Uh=new RegExp(`^hsla\\(${$e},${pt},${pt},${$e}\\)$`),bs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Nr(Ge,Ke,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:_s,formatHex:_s,formatHex8:Hh,formatHsl:jh,formatRgb:gs,toString:gs});function _s(){return this.rgb().formatHex()}function Hh(){return this.rgb().formatHex8()}function jh(){return Gs(this).formatHsl()}function gs(){return this.rgb().formatRgb()}function Ke(r){var s,o;return r=(r+"").trim().toLowerCase(),(s=Ih.exec(r))?(o=s[1].length,s=parseInt(s[1],16),o===6?ws(s):o===3?new it(s>>8&15|s>>4&240,s>>4&15|s&240,(s&15)<<4|s&15,1):o===8?fn(s>>24&255,s>>16&255,s>>8&255,(s&255)/255):o===4?fn(s>>12&15|s>>8&240,s>>8&15|s>>4&240,s>>4&15|s&240,((s&15)<<4|s&15)/255):null):(s=Oh.exec(r))?new it(s[1],s[2],s[3],1):(s=Fh.exec(r))?new it(s[1]*255/100,s[2]*255/100,s[3]*255/100,1):(s=Bh.exec(r))?fn(s[1],s[2],s[3],s[4]):(s=$h.exec(r))?fn(s[1]*255/100,s[2]*255/100,s[3]*255/100,s[4]):(s=Kh.exec(r))?Cs(s[1],s[2]/100,s[3]/100,1):(s=Uh.exec(r))?Cs(s[1],s[2]/100,s[3]/100,s[4]):bs.hasOwnProperty(r)?ws(bs[r]):r==="transparent"?new it(NaN,NaN,NaN,0):null}function ws(r){return new it(r>>16&255,r>>8&255,r&255,1)}function fn(r,s,o,l){return l<=0&&(r=s=o=NaN),new it(r,s,o,l)}function zh(r){return r instanceof Ge||(r=Ke(r)),r?(r=r.rgb(),new it(r.r,r.g,r.b,r.opacity)):new it}function xr(r,s,o,l){return arguments.length===1?zh(r):new it(r,s,o,l??1)}function it(r,s,o,l){this.r=+r,this.g=+s,this.b=+o,this.opacity=+l}Nr(it,xr,qs(Ge,{brighter(r){return r=r==null?xn:Math.pow(xn,r),new it(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Be:Math.pow(Be,r),new it(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new it(Ut(this.r),Ut(this.g),Ut(this.b),yn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xs,formatHex:xs,formatHex8:qh,formatRgb:ys,toString:ys}));function xs(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}`}function qh(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}${Kt((isNaN(this.opacity)?1:this.opacity)*255)}`}function ys(){const r=yn(this.opacity);return`${r===1?"rgb(":"rgba("}${Ut(this.r)}, ${Ut(this.g)}, ${Ut(this.b)}${r===1?")":`, ${r})`}`}function yn(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function Ut(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Kt(r){return r=Ut(r),(r<16?"0":"")+r.toString(16)}function Cs(r,s,o,l){return l<=0?r=s=o=NaN:o<=0||o>=1?r=s=NaN:s<=0&&(r=NaN),new lt(r,s,o,l)}function Gs(r){if(r instanceof lt)return new lt(r.h,r.s,r.l,r.opacity);if(r instanceof Ge||(r=Ke(r)),!r)return new lt;if(r instanceof lt)return r;r=r.rgb();var s=r.r/255,o=r.g/255,l=r.b/255,u=Math.min(s,o,l),c=Math.max(s,o,l),h=NaN,d=c-u,m=(c+u)/2;return d?(s===c?h=(o-l)/d+(o<l)*6:o===c?h=(l-s)/d+2:h=(s-o)/d+4,d/=m<.5?c+u:2-c-u,h*=60):d=m>0&&m<1?0:h,new lt(h,d,m,r.opacity)}function Gh(r,s,o,l){return arguments.length===1?Gs(r):new lt(r,s,o,l??1)}function lt(r,s,o,l){this.h=+r,this.s=+s,this.l=+o,this.opacity=+l}Nr(lt,Gh,qs(Ge,{brighter(r){return r=r==null?xn:Math.pow(xn,r),new lt(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Be:Math.pow(Be,r),new lt(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,s=isNaN(r)||isNaN(this.s)?0:this.s,o=this.l,l=o+(o<.5?o:1-o)*s,u=2*o-l;return new it(mr(r>=240?r-240:r+120,u,l),mr(r,u,l),mr(r<120?r+240:r-120,u,l),this.opacity)},clamp(){return new lt(Ps(this.h),vn(this.s),vn(this.l),yn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=yn(this.opacity);return`${r===1?"hsl(":"hsla("}${Ps(this.h)}, ${vn(this.s)*100}%, ${vn(this.l)*100}%${r===1?")":`, ${r})`}`}}));function Ps(r){return r=(r||0)%360,r<0?r+360:r}function vn(r){return Math.max(0,Math.min(1,r||0))}function mr(r,s,o){return(r<60?s+(o-s)*r/60:r<180?o:r<240?s+(o-s)*(240-r)/60:s)*255}const Ys=r=>()=>r;function Yh(r,s){return function(o){return r+o*s}}function Xh(r,s,o){return r=Math.pow(r,o),s=Math.pow(s,o)-r,o=1/o,function(l){return Math.pow(r+l*s,o)}}function Wh(r){return(r=+r)==1?Xs:function(s,o){return o-s?Xh(s,o,r):Ys(isNaN(s)?o:s)}}function Xs(r,s){var o=s-r;return o?Yh(r,o):Ys(isNaN(r)?s:r)}const Es=function r(s){var o=Wh(s);function l(u,c){var h=o((u=xr(u)).r,(c=xr(c)).r),d=o(u.g,c.g),m=o(u.b,c.b),f=Xs(u.opacity,c.opacity);return function(v){return u.r=h(v),u.g=d(v),u.b=m(v),u.opacity=f(v),u+""}}return l.gamma=r,l}(1);function Nt(r,s){return r=+r,s=+s,function(o){return r*(1-o)+s*o}}var yr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,br=new RegExp(yr.source,"g");function Qh(r){return function(){return r}}function Jh(r){return function(s){return r(s)+""}}function Zh(r,s){var o=yr.lastIndex=br.lastIndex=0,l,u,c,h=-1,d=[],m=[];for(r=r+"",s=s+"";(l=yr.exec(r))&&(u=br.exec(s));)(c=u.index)>o&&(c=s.slice(o,c),d[h]?d[h]+=c:d[++h]=c),(l=l[0])===(u=u[0])?d[h]?d[h]+=u:d[++h]=u:(d[++h]=null,m.push({i:h,x:Nt(l,u)})),o=br.lastIndex;return o<s.length&&(c=s.slice(o),d[h]?d[h]+=c:d[++h]=c),d.length<2?m[0]?Jh(m[0].x):Qh(s):(s=m.length,function(f){for(var v=0,_;v<s;++v)d[(_=m[v]).i]=_.x(f);return d.join("")})}var ks=180/Math.PI,Cr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ws(r,s,o,l,u,c){var h,d,m;return(h=Math.sqrt(r*r+s*s))&&(r/=h,s/=h),(m=r*o+s*l)&&(o-=r*m,l-=s*m),(d=Math.sqrt(o*o+l*l))&&(o/=d,l/=d,m/=d),r*l<s*o&&(r=-r,s=-s,m=-m,h=-h),{translateX:u,translateY:c,rotate:Math.atan2(s,r)*ks,skewX:Math.atan(m)*ks,scaleX:h,scaleY:d}}var mn;function tp(r){const s=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return s.isIdentity?Cr:Ws(s.a,s.b,s.c,s.d,s.e,s.f)}function ep(r){return r==null||(mn||(mn=document.createElementNS("http://www.w3.org/2000/svg","g")),mn.setAttribute("transform",r),!(r=mn.transform.baseVal.consolidate()))?Cr:(r=r.matrix,Ws(r.a,r.b,r.c,r.d,r.e,r.f))}function Qs(r,s,o,l){function u(f){return f.length?f.pop()+" ":""}function c(f,v,_,x,y,V){if(f!==_||v!==x){var w=y.push("translate(",null,s,null,o);V.push({i:w-4,x:Nt(f,_)},{i:w-2,x:Nt(v,x)})}else(_||x)&&y.push("translate("+_+s+x+o)}function h(f,v,_,x){f!==v?(f-v>180?v+=360:v-f>180&&(f+=360),x.push({i:_.push(u(_)+"rotate(",null,l)-2,x:Nt(f,v)})):v&&_.push(u(_)+"rotate("+v+l)}function d(f,v,_,x){f!==v?x.push({i:_.push(u(_)+"skewX(",null,l)-2,x:Nt(f,v)}):v&&_.push(u(_)+"skewX("+v+l)}function m(f,v,_,x,y,V){if(f!==_||v!==x){var w=y.push(u(y)+"scale(",null,",",null,")");V.push({i:w-4,x:Nt(f,_)},{i:w-2,x:Nt(v,x)})}else(_!==1||x!==1)&&y.push(u(y)+"scale("+_+","+x+")")}return function(f,v){var _=[],x=[];return f=r(f),v=r(v),c(f.translateX,f.translateY,v.translateX,v.translateY,_,x),h(f.rotate,v.rotate,_,x),d(f.skewX,v.skewX,_,x),m(f.scaleX,f.scaleY,v.scaleX,v.scaleY,_,x),f=v=null,function(y){for(var V=-1,w=x.length,C;++V<w;)_[(C=x[V]).i]=C.x(y);return _.join("")}}}var np=Qs(tp,"px, ","px)","deg)"),rp=Qs(ep,", ",")",")"),ae=0,Te=0,Re=0,Js=1e3,Cn,De,Pn=0,jt=0,Vn=0,Ue=typeof performance=="object"&&performance.now?performance:Date,Zs=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function Lr(){return jt||(Zs(ip),jt=Ue.now()+Vn)}function ip(){jt=0}function En(){this._call=this._time=this._next=null}En.prototype=Rr.prototype={constructor:En,restart:function(r,s,o){if(typeof r!="function")throw new TypeError("callback is not a function");o=(o==null?Lr():+o)+(s==null?0:+s),!this._next&&De!==this&&(De?De._next=this:Cn=this,De=this),this._call=r,this._time=o,Pr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Pr())}};function Rr(r,s,o){var l=new En;return l.restart(r,s,o),l}function sp(){Lr(),++ae;for(var r=Cn,s;r;)(s=jt-r._time)>=0&&r._call.call(void 0,s),r=r._next;--ae}function Ss(){jt=(Pn=Ue.now())+Vn,ae=Te=0;try{sp()}finally{ae=0,ap(),jt=0}}function op(){var r=Ue.now(),s=r-Pn;s>Js&&(Vn-=s,Pn=r)}function ap(){for(var r,s=Cn,o,l=1/0;s;)s._call?(l>s._time&&(l=s._time),r=s,s=s._next):(o=s._next,s._next=null,s=r?r._next=o:Cn=o);De=r,Pr(l)}function Pr(r){if(!ae){Te&&(Te=clearTimeout(Te));var s=r-jt;s>24?(r<1/0&&(Te=setTimeout(Ss,r-Ue.now()-Vn)),Re&&(Re=clearInterval(Re))):(Re||(Pn=Ue.now(),Re=setInterval(op,Js)),ae=1,Zs(Ss))}}function Vs(r,s,o){var l=new En;return s=s==null?0:+s,l.restart(u=>{l.stop(),r(u+s)},s,o),l}var lp=kn("start","end","cancel","interrupt"),up=[],to=0,As=1,Er=2,_n=3,Ms=4,kr=5,gn=6;function An(r,s,o,l,u,c){var h=r.__transition;if(!h)r.__transition={};else if(o in h)return;cp(r,o,{name:s,index:l,group:u,on:lp,tween:up,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:to})}function Tr(r,s){var o=ut(r,s);if(o.state>to)throw new Error("too late; already scheduled");return o}function ft(r,s){var o=ut(r,s);if(o.state>_n)throw new Error("too late; already running");return o}function ut(r,s){var o=r.__transition;if(!o||!(o=o[s]))throw new Error("transition not found");return o}function cp(r,s,o){var l=r.__transition,u;l[s]=o,o.timer=Rr(c,0,o.time);function c(f){o.state=As,o.timer.restart(h,o.delay,o.time),o.delay<=f&&h(f-o.delay)}function h(f){var v,_,x,y;if(o.state!==As)return m();for(v in l)if(y=l[v],y.name===o.name){if(y.state===_n)return Vs(h);y.state===Ms?(y.state=gn,y.timer.stop(),y.on.call("interrupt",r,r.__data__,y.index,y.group),delete l[v]):+v<s&&(y.state=gn,y.timer.stop(),y.on.call("cancel",r,r.__data__,y.index,y.group),delete l[v])}if(Vs(function(){o.state===_n&&(o.state=Ms,o.timer.restart(d,o.delay,o.time),d(f))}),o.state=Er,o.on.call("start",r,r.__data__,o.index,o.group),o.state===Er){for(o.state=_n,u=new Array(x=o.tween.length),v=0,_=-1;v<x;++v)(y=o.tween[v].value.call(r,r.__data__,o.index,o.group))&&(u[++_]=y);u.length=_+1}}function d(f){for(var v=f<o.duration?o.ease.call(null,f/o.duration):(o.timer.restart(m),o.state=kr,1),_=-1,x=u.length;++_<x;)u[_].call(r,v);o.state===kr&&(o.on.call("end",r,r.__data__,o.index,o.group),m())}function m(){o.state=gn,o.timer.stop(),delete l[s];for(var f in l)return;delete r.__transition}}function hp(r,s){var o=r.__transition,l,u,c=!0,h;if(o){s=s==null?null:s+"";for(h in o){if((l=o[h]).name!==s){c=!1;continue}u=l.state>Er&&l.state<kr,l.state=gn,l.timer.stop(),l.on.call(u?"interrupt":"cancel",r,r.__data__,l.index,l.group),delete o[h]}c&&delete r.__transition}}function pp(r){return this.each(function(){hp(this,r)})}function dp(r,s){var o,l;return function(){var u=ft(this,r),c=u.tween;if(c!==o){l=o=c;for(var h=0,d=l.length;h<d;++h)if(l[h].name===s){l=l.slice(),l.splice(h,1);break}}u.tween=l}}function fp(r,s,o){var l,u;if(typeof o!="function")throw new Error;return function(){var c=ft(this,r),h=c.tween;if(h!==l){u=(l=h).slice();for(var d={name:s,value:o},m=0,f=u.length;m<f;++m)if(u[m].name===s){u[m]=d;break}m===f&&u.push(d)}c.tween=u}}function vp(r,s){var o=this._id;if(r+="",arguments.length<2){for(var l=ut(this.node(),o).tween,u=0,c=l.length,h;u<c;++u)if((h=l[u]).name===r)return h.value;return null}return this.each((s==null?dp:fp)(o,r,s))}function Dr(r,s,o){var l=r._id;return r.each(function(){var u=ft(this,l);(u.value||(u.value={}))[s]=o.apply(this,arguments)}),function(u){return ut(u,l).value[s]}}function eo(r,s){var o;return(typeof s=="number"?Nt:s instanceof Ke?Es:(o=Ke(s))?(s=o,Es):Zh)(r,s)}function mp(r){return function(){this.removeAttribute(r)}}function bp(r){return function(){this.removeAttributeNS(r.space,r.local)}}function _p(r,s,o){var l,u=o+"",c;return function(){var h=this.getAttribute(r);return h===u?null:h===l?c:c=s(l=h,o)}}function gp(r,s,o){var l,u=o+"",c;return function(){var h=this.getAttributeNS(r.space,r.local);return h===u?null:h===l?c:c=s(l=h,o)}}function wp(r,s,o){var l,u,c;return function(){var h,d=o(this),m;return d==null?void this.removeAttribute(r):(h=this.getAttribute(r),m=d+"",h===m?null:h===l&&m===u?c:(u=m,c=s(l=h,d)))}}function xp(r,s,o){var l,u,c;return function(){var h,d=o(this),m;return d==null?void this.removeAttributeNS(r.space,r.local):(h=this.getAttributeNS(r.space,r.local),m=d+"",h===m?null:h===l&&m===u?c:(u=m,c=s(l=h,d)))}}function yp(r,s){var o=Sn(r),l=o==="transform"?rp:eo;return this.attrTween(r,typeof s=="function"?(o.local?xp:wp)(o,l,Dr(this,"attr."+r,s)):s==null?(o.local?bp:mp)(o):(o.local?gp:_p)(o,l,s))}function Cp(r,s){return function(o){this.setAttribute(r,s.call(this,o))}}function Pp(r,s){return function(o){this.setAttributeNS(r.space,r.local,s.call(this,o))}}function Ep(r,s){var o,l;function u(){var c=s.apply(this,arguments);return c!==l&&(o=(l=c)&&Pp(r,c)),o}return u._value=s,u}function kp(r,s){var o,l;function u(){var c=s.apply(this,arguments);return c!==l&&(o=(l=c)&&Cp(r,c)),o}return u._value=s,u}function Sp(r,s){var o="attr."+r;if(arguments.length<2)return(o=this.tween(o))&&o._value;if(s==null)return this.tween(o,null);if(typeof s!="function")throw new Error;var l=Sn(r);return this.tween(o,(l.local?Ep:kp)(l,s))}function Vp(r,s){return function(){Tr(this,r).delay=+s.apply(this,arguments)}}function Ap(r,s){return s=+s,function(){Tr(this,r).delay=s}}function Mp(r){var s=this._id;return arguments.length?this.each((typeof r=="function"?Vp:Ap)(s,r)):ut(this.node(),s).delay}function Np(r,s){return function(){ft(this,r).duration=+s.apply(this,arguments)}}function Lp(r,s){return s=+s,function(){ft(this,r).duration=s}}function Rp(r){var s=this._id;return arguments.length?this.each((typeof r=="function"?Np:Lp)(s,r)):ut(this.node(),s).duration}function Tp(r,s){if(typeof s!="function")throw new Error;return function(){ft(this,r).ease=s}}function Dp(r){var s=this._id;return arguments.length?this.each(Tp(s,r)):ut(this.node(),s).ease}function Ip(r,s){return function(){var o=s.apply(this,arguments);if(typeof o!="function")throw new Error;ft(this,r).ease=o}}function Op(r){if(typeof r!="function")throw new Error;return this.each(Ip(this._id,r))}function Fp(r){typeof r!="function"&&(r=Os(r));for(var s=this._groups,o=s.length,l=new Array(o),u=0;u<o;++u)for(var c=s[u],h=c.length,d=l[u]=[],m,f=0;f<h;++f)(m=c[f])&&r.call(m,m.__data__,f,c)&&d.push(m);return new yt(l,this._parents,this._name,this._id)}function Bp(r){if(r._id!==this._id)throw new Error;for(var s=this._groups,o=r._groups,l=s.length,u=o.length,c=Math.min(l,u),h=new Array(l),d=0;d<c;++d)for(var m=s[d],f=o[d],v=m.length,_=h[d]=new Array(v),x,y=0;y<v;++y)(x=m[y]||f[y])&&(_[y]=x);for(;d<l;++d)h[d]=s[d];return new yt(h,this._parents,this._name,this._id)}function $p(r){return(r+"").trim().split(/^|\s+/).every(function(s){var o=s.indexOf(".");return o>=0&&(s=s.slice(0,o)),!s||s==="start"})}function Kp(r,s,o){var l,u,c=$p(s)?Tr:ft;return function(){var h=c(this,r),d=h.on;d!==l&&(u=(l=d).copy()).on(s,o),h.on=u}}function Up(r,s){var o=this._id;return arguments.length<2?ut(this.node(),o).on.on(r):this.each(Kp(o,r,s))}function Hp(r){return function(){var s=this.parentNode;for(var o in this.__transition)if(+o!==r)return;s&&s.removeChild(this)}}function jp(){return this.on("end.remove",Hp(this._id))}function zp(r){var s=this._name,o=this._id;typeof r!="function"&&(r=Vr(r));for(var l=this._groups,u=l.length,c=new Array(u),h=0;h<u;++h)for(var d=l[h],m=d.length,f=c[h]=new Array(m),v,_,x=0;x<m;++x)(v=d[x])&&(_=r.call(v,v.__data__,x,d))&&("__data__"in v&&(_.__data__=v.__data__),f[x]=_,An(f[x],s,o,x,f,ut(v,o)));return new yt(c,this._parents,s,o)}function qp(r){var s=this._name,o=this._id;typeof r!="function"&&(r=Is(r));for(var l=this._groups,u=l.length,c=[],h=[],d=0;d<u;++d)for(var m=l[d],f=m.length,v,_=0;_<f;++_)if(v=m[_]){for(var x=r.call(v,v.__data__,_,m),y,V=ut(v,o),w=0,C=x.length;w<C;++w)(y=x[w])&&An(y,s,o,w,x,V);c.push(x),h.push(v)}return new yt(c,h,s,o)}var Gp=je.prototype.constructor;function Yp(){return new Gp(this._groups,this._parents)}function Xp(r,s){var o,l,u;return function(){var c=oe(this,r),h=(this.style.removeProperty(r),oe(this,r));return c===h?null:c===o&&h===l?u:u=s(o=c,l=h)}}function no(r){return function(){this.style.removeProperty(r)}}function Wp(r,s,o){var l,u=o+"",c;return function(){var h=oe(this,r);return h===u?null:h===l?c:c=s(l=h,o)}}function Qp(r,s,o){var l,u,c;return function(){var h=oe(this,r),d=o(this),m=d+"";return d==null&&(m=d=(this.style.removeProperty(r),oe(this,r))),h===m?null:h===l&&m===u?c:(u=m,c=s(l=h,d))}}function Jp(r,s){var o,l,u,c="style."+s,h="end."+c,d;return function(){var m=ft(this,r),f=m.on,v=m.value[c]==null?d||(d=no(s)):void 0;(f!==o||u!==v)&&(l=(o=f).copy()).on(h,u=v),m.on=l}}function Zp(r,s,o){var l=(r+="")=="transform"?np:eo;return s==null?this.styleTween(r,Xp(r,l)).on("end.style."+r,no(r)):typeof s=="function"?this.styleTween(r,Qp(r,l,Dr(this,"style."+r,s))).each(Jp(this._id,r)):this.styleTween(r,Wp(r,l,s),o).on("end.style."+r,null)}function td(r,s,o){return function(l){this.style.setProperty(r,s.call(this,l),o)}}function ed(r,s,o){var l,u;function c(){var h=s.apply(this,arguments);return h!==u&&(l=(u=h)&&td(r,h,o)),l}return c._value=s,c}function nd(r,s,o){var l="style."+(r+="");if(arguments.length<2)return(l=this.tween(l))&&l._value;if(s==null)return this.tween(l,null);if(typeof s!="function")throw new Error;return this.tween(l,ed(r,s,o??""))}function rd(r){return function(){this.textContent=r}}function id(r){return function(){var s=r(this);this.textContent=s??""}}function sd(r){return this.tween("text",typeof r=="function"?id(Dr(this,"text",r)):rd(r==null?"":r+""))}function od(r){return function(s){this.textContent=r.call(this,s)}}function ad(r){var s,o;function l(){var u=r.apply(this,arguments);return u!==o&&(s=(o=u)&&od(u)),s}return l._value=r,l}function ld(r){var s="text";if(arguments.length<1)return(s=this.tween(s))&&s._value;if(r==null)return this.tween(s,null);if(typeof r!="function")throw new Error;return this.tween(s,ad(r))}function ud(){for(var r=this._name,s=this._id,o=ro(),l=this._groups,u=l.length,c=0;c<u;++c)for(var h=l[c],d=h.length,m,f=0;f<d;++f)if(m=h[f]){var v=ut(m,s);An(m,r,o,f,h,{time:v.time+v.delay+v.duration,delay:0,duration:v.duration,ease:v.ease})}return new yt(l,this._parents,r,o)}function cd(){var r,s,o=this,l=o._id,u=o.size();return new Promise(function(c,h){var d={value:h},m={value:function(){--u===0&&c()}};o.each(function(){var f=ft(this,l),v=f.on;v!==r&&(s=(r=v).copy(),s._.cancel.push(d),s._.interrupt.push(d),s._.end.push(m)),f.on=s}),u===0&&c()})}var hd=0;function yt(r,s,o,l){this._groups=r,this._parents=s,this._name=o,this._id=l}function ro(){return++hd}var xt=je.prototype;yt.prototype={constructor:yt,select:zp,selectAll:qp,selectChild:xt.selectChild,selectChildren:xt.selectChildren,filter:Fp,merge:Bp,selection:Yp,transition:ud,call:xt.call,nodes:xt.nodes,node:xt.node,size:xt.size,empty:xt.empty,each:xt.each,on:Up,attr:yp,attrTween:Sp,style:Zp,styleTween:nd,text:sd,textTween:ld,remove:jp,tween:vp,delay:Mp,duration:Rp,ease:Dp,easeVarying:Op,end:cd,[Symbol.iterator]:xt[Symbol.iterator]};function pd(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var dd={time:null,delay:0,duration:250,ease:pd};function fd(r,s){for(var o;!(o=r.__transition)||!(o=o[s]);)if(!(r=r.parentNode))throw new Error(`transition ${s} not found`);return o}function vd(r){var s,o;r instanceof yt?(s=r._id,r=r._name):(s=ro(),(o=dd).time=Lr(),r=r==null?null:r+"");for(var l=this._groups,u=l.length,c=0;c<u;++c)for(var h=l[c],d=h.length,m,f=0;f<d;++f)(m=h[f])&&An(m,r,s,f,h,o||fd(m,s));return new yt(l,this._parents,r,s)}je.prototype.interrupt=pp;je.prototype.transition=vd;function md(r,s){var o,l=1;r==null&&(r=0),s==null&&(s=0);function u(){var c,h=o.length,d,m=0,f=0;for(c=0;c<h;++c)d=o[c],m+=d.x,f+=d.y;for(m=(m/h-r)*l,f=(f/h-s)*l,c=0;c<h;++c)d=o[c],d.x-=m,d.y-=f}return u.initialize=function(c){o=c},u.x=function(c){return arguments.length?(r=+c,u):r},u.y=function(c){return arguments.length?(s=+c,u):s},u.strength=function(c){return arguments.length?(l=+c,u):l},u}function bd(r){const s=+this._x.call(null,r),o=+this._y.call(null,r);return io(this.cover(s,o),s,o,r)}function io(r,s,o,l){if(isNaN(s)||isNaN(o))return r;var u,c=r._root,h={data:l},d=r._x0,m=r._y0,f=r._x1,v=r._y1,_,x,y,V,w,C,S,E;if(!c)return r._root=h,r;for(;c.length;)if((w=s>=(_=(d+f)/2))?d=_:f=_,(C=o>=(x=(m+v)/2))?m=x:v=x,u=c,!(c=c[S=C<<1|w]))return u[S]=h,r;if(y=+r._x.call(null,c.data),V=+r._y.call(null,c.data),s===y&&o===V)return h.next=c,u?u[S]=h:r._root=h,r;do u=u?u[S]=new Array(4):r._root=new Array(4),(w=s>=(_=(d+f)/2))?d=_:f=_,(C=o>=(x=(m+v)/2))?m=x:v=x;while((S=C<<1|w)===(E=(V>=x)<<1|y>=_));return u[E]=c,u[S]=h,r}function _d(r){var s,o,l=r.length,u,c,h=new Array(l),d=new Array(l),m=1/0,f=1/0,v=-1/0,_=-1/0;for(o=0;o<l;++o)isNaN(u=+this._x.call(null,s=r[o]))||isNaN(c=+this._y.call(null,s))||(h[o]=u,d[o]=c,u<m&&(m=u),u>v&&(v=u),c<f&&(f=c),c>_&&(_=c));if(m>v||f>_)return this;for(this.cover(m,f).cover(v,_),o=0;o<l;++o)io(this,h[o],d[o],r[o]);return this}function gd(r,s){if(isNaN(r=+r)||isNaN(s=+s))return this;var o=this._x0,l=this._y0,u=this._x1,c=this._y1;if(isNaN(o))u=(o=Math.floor(r))+1,c=(l=Math.floor(s))+1;else{for(var h=u-o||1,d=this._root,m,f;o>r||r>=u||l>s||s>=c;)switch(f=(s<l)<<1|r<o,m=new Array(4),m[f]=d,d=m,h*=2,f){case 0:u=o+h,c=l+h;break;case 1:o=u-h,c=l+h;break;case 2:u=o+h,l=c-h;break;case 3:o=u-h,l=c-h;break}this._root&&this._root.length&&(this._root=d)}return this._x0=o,this._y0=l,this._x1=u,this._y1=c,this}function wd(){var r=[];return this.visit(function(s){if(!s.length)do r.push(s.data);while(s=s.next)}),r}function xd(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function J(r,s,o,l,u){this.node=r,this.x0=s,this.y0=o,this.x1=l,this.y1=u}function yd(r,s,o){var l,u=this._x0,c=this._y0,h,d,m,f,v=this._x1,_=this._y1,x=[],y=this._root,V,w;for(y&&x.push(new J(y,u,c,v,_)),o==null?o=1/0:(u=r-o,c=s-o,v=r+o,_=s+o,o*=o);V=x.pop();)if(!(!(y=V.node)||(h=V.x0)>v||(d=V.y0)>_||(m=V.x1)<u||(f=V.y1)<c))if(y.length){var C=(h+m)/2,S=(d+f)/2;x.push(new J(y[3],C,S,m,f),new J(y[2],h,S,C,f),new J(y[1],C,d,m,S),new J(y[0],h,d,C,S)),(w=(s>=S)<<1|r>=C)&&(V=x[x.length-1],x[x.length-1]=x[x.length-1-w],x[x.length-1-w]=V)}else{var E=r-+this._x.call(null,y.data),L=s-+this._y.call(null,y.data),g=E*E+L*L;if(g<o){var M=Math.sqrt(o=g);u=r-M,c=s-M,v=r+M,_=s+M,l=y.data}}return l}function Cd(r){if(isNaN(v=+this._x.call(null,r))||isNaN(_=+this._y.call(null,r)))return this;var s,o=this._root,l,u,c,h=this._x0,d=this._y0,m=this._x1,f=this._y1,v,_,x,y,V,w,C,S;if(!o)return this;if(o.length)for(;;){if((V=v>=(x=(h+m)/2))?h=x:m=x,(w=_>=(y=(d+f)/2))?d=y:f=y,s=o,!(o=o[C=w<<1|V]))return this;if(!o.length)break;(s[C+1&3]||s[C+2&3]||s[C+3&3])&&(l=s,S=C)}for(;o.data!==r;)if(u=o,!(o=o.next))return this;return(c=o.next)&&delete o.next,u?(c?u.next=c:delete u.next,this):s?(c?s[C]=c:delete s[C],(o=s[0]||s[1]||s[2]||s[3])&&o===(s[3]||s[2]||s[1]||s[0])&&!o.length&&(l?l[S]=o:this._root=o),this):(this._root=c,this)}function Pd(r){for(var s=0,o=r.length;s<o;++s)this.remove(r[s]);return this}function Ed(){return this._root}function kd(){var r=0;return this.visit(function(s){if(!s.length)do++r;while(s=s.next)}),r}function Sd(r){var s=[],o,l=this._root,u,c,h,d,m;for(l&&s.push(new J(l,this._x0,this._y0,this._x1,this._y1));o=s.pop();)if(!r(l=o.node,c=o.x0,h=o.y0,d=o.x1,m=o.y1)&&l.length){var f=(c+d)/2,v=(h+m)/2;(u=l[3])&&s.push(new J(u,f,v,d,m)),(u=l[2])&&s.push(new J(u,c,v,f,m)),(u=l[1])&&s.push(new J(u,f,h,d,v)),(u=l[0])&&s.push(new J(u,c,h,f,v))}return this}function Vd(r){var s=[],o=[],l;for(this._root&&s.push(new J(this._root,this._x0,this._y0,this._x1,this._y1));l=s.pop();){var u=l.node;if(u.length){var c,h=l.x0,d=l.y0,m=l.x1,f=l.y1,v=(h+m)/2,_=(d+f)/2;(c=u[0])&&s.push(new J(c,h,d,v,_)),(c=u[1])&&s.push(new J(c,v,d,m,_)),(c=u[2])&&s.push(new J(c,h,_,v,f)),(c=u[3])&&s.push(new J(c,v,_,m,f))}o.push(l)}for(;l=o.pop();)r(l.node,l.x0,l.y0,l.x1,l.y1);return this}function Ad(r){return r[0]}function Md(r){return arguments.length?(this._x=r,this):this._x}function Nd(r){return r[1]}function Ld(r){return arguments.length?(this._y=r,this):this._y}function Ir(r,s,o){var l=new Or(s??Ad,o??Nd,NaN,NaN,NaN,NaN);return r==null?l:l.addAll(r)}function Or(r,s,o,l,u,c){this._x=r,this._y=s,this._x0=o,this._y0=l,this._x1=u,this._y1=c,this._root=void 0}function Ns(r){for(var s={data:r.data},o=s;r=r.next;)o=o.next={data:r.data};return s}var tt=Ir.prototype=Or.prototype;tt.copy=function(){var r=new Or(this._x,this._y,this._x0,this._y0,this._x1,this._y1),s=this._root,o,l;if(!s)return r;if(!s.length)return r._root=Ns(s),r;for(o=[{source:s,target:r._root=new Array(4)}];s=o.pop();)for(var u=0;u<4;++u)(l=s.source[u])&&(l.length?o.push({source:l,target:s.target[u]=new Array(4)}):s.target[u]=Ns(l));return r};tt.add=bd;tt.addAll=_d;tt.cover=gd;tt.data=wd;tt.extent=xd;tt.find=yd;tt.remove=Cd;tt.removeAll=Pd;tt.root=Ed;tt.size=kd;tt.visit=Sd;tt.visitAfter=Vd;tt.x=Md;tt.y=Ld;function Ht(r){return function(){return r}}function Lt(r){return(r()-.5)*1e-6}function Rd(r){return r.x+r.vx}function Td(r){return r.y+r.vy}function Dd(r){var s,o,l,u=1,c=1;typeof r!="function"&&(r=Ht(r==null?1:+r));function h(){for(var f,v=s.length,_,x,y,V,w,C,S=0;S<c;++S)for(_=Ir(s,Rd,Td).visitAfter(d),f=0;f<v;++f)x=s[f],w=o[x.index],C=w*w,y=x.x+x.vx,V=x.y+x.vy,_.visit(E);function E(L,g,M,O,D){var T=L.data,j=L.r,F=w+j;if(T){if(T.index>x.index){var H=y-T.x-T.vx,Q=V-T.y-T.vy,nt=H*H+Q*Q;nt<F*F&&(H===0&&(H=Lt(l),nt+=H*H),Q===0&&(Q=Lt(l),nt+=Q*Q),nt=(F-(nt=Math.sqrt(nt)))/nt*u,x.vx+=(H*=nt)*(F=(j*=j)/(C+j)),x.vy+=(Q*=nt)*F,T.vx-=H*(F=1-F),T.vy-=Q*F)}return}return g>y+F||O<y-F||M>V+F||D<V-F}}function d(f){if(f.data)return f.r=o[f.data.index];for(var v=f.r=0;v<4;++v)f[v]&&f[v].r>f.r&&(f.r=f[v].r)}function m(){if(s){var f,v=s.length,_;for(o=new Array(v),f=0;f<v;++f)_=s[f],o[_.index]=+r(_,f,s)}}return h.initialize=function(f,v){s=f,l=v,m()},h.iterations=function(f){return arguments.length?(c=+f,h):c},h.strength=function(f){return arguments.length?(u=+f,h):u},h.radius=function(f){return arguments.length?(r=typeof f=="function"?f:Ht(+f),m(),h):r},h}function Id(r){return r.index}function Ls(r,s){var o=r.get(s);if(!o)throw new Error("node not found: "+s);return o}function Fr(r){var s=Id,o=_,l,u=Ht(30),c,h,d,m,f,v=1;r==null&&(r=[]);function _(C){return 1/Math.min(d[C.source.index],d[C.target.index])}function x(C){for(var S=0,E=r.length;S<v;++S)for(var L=0,g,M,O,D,T,j,F;L<E;++L)g=r[L],M=g.source,O=g.target,D=O.x+O.vx-M.x-M.vx||Lt(f),T=O.y+O.vy-M.y-M.vy||Lt(f),j=Math.sqrt(D*D+T*T),j=(j-c[L])/j*C*l[L],D*=j,T*=j,O.vx-=D*(F=m[L]),O.vy-=T*F,M.vx+=D*(F=1-F),M.vy+=T*F}function y(){if(h){var C,S=h.length,E=r.length,L=new Map(h.map((M,O)=>[s(M,O,h),M])),g;for(C=0,d=new Array(S);C<E;++C)g=r[C],g.index=C,typeof g.source!="object"&&(g.source=Ls(L,g.source)),typeof g.target!="object"&&(g.target=Ls(L,g.target)),d[g.source.index]=(d[g.source.index]||0)+1,d[g.target.index]=(d[g.target.index]||0)+1;for(C=0,m=new Array(E);C<E;++C)g=r[C],m[C]=d[g.source.index]/(d[g.source.index]+d[g.target.index]);l=new Array(E),V(),c=new Array(E),w()}}function V(){if(h)for(var C=0,S=r.length;C<S;++C)l[C]=+o(r[C],C,r)}function w(){if(h)for(var C=0,S=r.length;C<S;++C)c[C]=+u(r[C],C,r)}return x.initialize=function(C,S){h=C,f=S,y()},x.links=function(C){return arguments.length?(r=C,y(),x):r},x.id=function(C){return arguments.length?(s=C,x):s},x.iterations=function(C){return arguments.length?(v=+C,x):v},x.strength=function(C){return arguments.length?(o=typeof C=="function"?C:Ht(+C),V(),x):o},x.distance=function(C){return arguments.length?(u=typeof C=="function"?C:Ht(+C),w(),x):u},x}const Od=1664525,Fd=1013904223,Rs=4294967296;function Bd(){let r=1;return()=>(r=(Od*r+Fd)%Rs)/Rs}function $d(r){return r.x}function Kd(r){return r.y}var Ud=10,Hd=Math.PI*(3-Math.sqrt(5));function jd(r){var s,o=1,l=.001,u=1-Math.pow(l,1/300),c=0,h=.6,d=new Map,m=Rr(_),f=kn("tick","end"),v=Bd();r==null&&(r=[]);function _(){x(),f.call("tick",s),o<l&&(m.stop(),f.call("end",s))}function x(w){var C,S=r.length,E;w===void 0&&(w=1);for(var L=0;L<w;++L)for(o+=(c-o)*u,d.forEach(function(g){g(o)}),C=0;C<S;++C)E=r[C],E.fx==null?E.x+=E.vx*=h:(E.x=E.fx,E.vx=0),E.fy==null?E.y+=E.vy*=h:(E.y=E.fy,E.vy=0);return s}function y(){for(var w=0,C=r.length,S;w<C;++w){if(S=r[w],S.index=w,S.fx!=null&&(S.x=S.fx),S.fy!=null&&(S.y=S.fy),isNaN(S.x)||isNaN(S.y)){var E=Ud*Math.sqrt(.5+w),L=w*Hd;S.x=E*Math.cos(L),S.y=E*Math.sin(L)}(isNaN(S.vx)||isNaN(S.vy))&&(S.vx=S.vy=0)}}function V(w){return w.initialize&&w.initialize(r,v),w}return y(),s={tick:x,restart:function(){return m.restart(_),s},stop:function(){return m.stop(),s},nodes:function(w){return arguments.length?(r=w,y(),d.forEach(V),s):r},alpha:function(w){return arguments.length?(o=+w,s):o},alphaMin:function(w){return arguments.length?(l=+w,s):l},alphaDecay:function(w){return arguments.length?(u=+w,s):+u},alphaTarget:function(w){return arguments.length?(c=+w,s):c},velocityDecay:function(w){return arguments.length?(h=1-w,s):1-h},randomSource:function(w){return arguments.length?(v=w,d.forEach(V),s):v},force:function(w,C){return arguments.length>1?(C==null?d.delete(w):d.set(w,V(C)),s):d.get(w)},find:function(w,C,S){var E=0,L=r.length,g,M,O,D,T;for(S==null?S=1/0:S*=S,E=0;E<L;++E)D=r[E],g=w-D.x,M=C-D.y,O=g*g+M*M,O<S&&(T=D,S=O);return T},on:function(w,C){return arguments.length>1?(f.on(w,C),s):f.on(w)}}}function so(){var r,s,o,l,u=Ht(-30),c,h=1,d=1/0,m=.81;function f(y){var V,w=r.length,C=Ir(r,$d,Kd).visitAfter(_);for(l=y,V=0;V<w;++V)s=r[V],C.visit(x)}function v(){if(r){var y,V=r.length,w;for(c=new Array(V),y=0;y<V;++y)w=r[y],c[w.index]=+u(w,y,r)}}function _(y){var V=0,w,C,S=0,E,L,g;if(y.length){for(E=L=g=0;g<4;++g)(w=y[g])&&(C=Math.abs(w.value))&&(V+=w.value,S+=C,E+=C*w.x,L+=C*w.y);y.x=E/S,y.y=L/S}else{w=y,w.x=w.data.x,w.y=w.data.y;do V+=c[w.data.index];while(w=w.next)}y.value=V}function x(y,V,w,C){if(!y.value)return!0;var S=y.x-s.x,E=y.y-s.y,L=C-V,g=S*S+E*E;if(L*L/m<g)return g<d&&(S===0&&(S=Lt(o),g+=S*S),E===0&&(E=Lt(o),g+=E*E),g<h&&(g=Math.sqrt(h*g)),s.vx+=S*y.value*l/g,s.vy+=E*y.value*l/g),!0;if(y.length||g>=d)return;(y.data!==s||y.next)&&(S===0&&(S=Lt(o),g+=S*S),E===0&&(E=Lt(o),g+=E*E),g<h&&(g=Math.sqrt(h*g)));do y.data!==s&&(L=c[y.data.index]*l/g,s.vx+=S*L,s.vy+=E*L);while(y=y.next)}return f.initialize=function(y,V){r=y,o=V,v()},f.strength=function(y){return arguments.length?(u=typeof y=="function"?y:Ht(+y),v(),f):u},f.distanceMin=function(y){return arguments.length?(h=y*y,f):Math.sqrt(h)},f.distanceMax=function(y){return arguments.length?(d=y*y,f):Math.sqrt(d)},f.theta=function(y){return arguments.length?(m=y*y,f):Math.sqrt(m)},f}function Ie(r,s,o){this.k=r,this.x=s,this.y=o}Ie.prototype={constructor:Ie,scale:function(r){return r===1?this:new Ie(this.k*r,this.x,this.y)},translate:function(r,s){return r===0&s===0?this:new Ie(this.k,this.x+this.k*r,this.y+this.k*s)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Ie.prototype;var zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sr={exports:{}};/*! Tweakpane 3.1.10 (c) 2016 cocopon, licensed under the MIT license. */(function(r,s){(function(o,l){l(s)})(zd,function(o){class l{constructor(t){const[e,i]=t.split("-"),a=e.split(".");this.major=parseInt(a[0],10),this.minor=parseInt(a[1],10),this.patch=parseInt(a[2],10),this.prerelease=i??null}toString(){const t=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[t,this.prerelease].join("-"):t}}class u{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class c{constructor(t){this.target=t}}class h extends c{constructor(t,e,i,a){super(t),this.value=e,this.presetKey=i,this.last=a??!0}}class d extends c{constructor(t,e,i){super(t),this.value=e,this.presetKey=i}}class m extends c{constructor(t,e){super(t),this.expanded=e}}class f extends c{constructor(t,e){super(t),this.index=e}}function v(n){return n}function _(n){return n==null}function x(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function y(n,t){let e=n;do{const i=Object.getOwnPropertyDescriptor(e,t);if(i&&(i.set!==void 0||i.writable===!0))return!0;e=Object.getPrototypeOf(e)}while(e!==null);return!1}const V={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class w{static alreadyDisposed(){return new w({type:"alreadydisposed"})}static notBindable(){return new w({type:"notbindable"})}static propertyNotFound(t){return new w({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new w({type:"shouldneverhappen"})}constructor(t){var e;this.message=(e=V[t.type](t.context))!==null&&e!==void 0?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}}class C{constructor(t,e,i){this.obj_=t,this.key_=e,this.presetKey_=i??e}static isBindable(t){return!(t===null||typeof t!="object"&&typeof t!="function")}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const i=this.read();if(!C.isBindable(i))throw w.notBindable();if(!(t in i))throw w.propertyNotFound(t);i[t]=e}}class S extends u{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return(t=this.controller_.valueController.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const i=e.bind(this);return this.controller_.valueController.emitter.on(t,()=>{i(new c(this))}),this}}class E{constructor(){this.observers_={}}on(t,e){let i=this.observers_[t];return i||(i=this.observers_[t]=[]),i.push({handler:e}),this}off(t,e){const i=this.observers_[t];return i&&(this.observers_[t]=i.filter(a=>a.handler!==e)),this}emit(t,e){const i=this.observers_[t];i&&i.forEach(a=>{a.handler(e)})}}const L="tp";function g(n){return(e,i)=>[L,"-",n,"v",e?`_${e}`:"",i?`-${i}`:""].join("")}function M(n,t){return e=>t(n(e))}function O(n){return n.rawValue}function D(n,t){n.emitter.on("change",M(O,t)),t(n.rawValue)}function T(n,t,e){D(n.value(t),e)}function j(n,t,e){e?n.classList.add(t):n.classList.remove(t)}function F(n,t){return e=>{j(n,t,e)}}function H(n,t){D(n,e=>{t.textContent=e??""})}const Q=g("btn");class nt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Q()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("button");i.classList.add(Q("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const a=t.createElement("div");a.classList.add(Q("t")),H(e.props.value("title"),a),this.buttonElement.appendChild(a)}}class Tt{constructor(t,e){this.emitter=new E,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new nt(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Nn{constructor(t,e){var i;this.constraint_=e==null?void 0:e.constraint,this.equals_=(i=e==null?void 0:e.equals)!==null&&i!==void 0?i:(a,p)=>a===p,this.emitter=new E,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},a=this.constraint_?this.constraint_.constrain(t):t,p=this.rawValue_;this.equals_(p,a)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=a,this.emitter.emit("change",{options:i,previousRawValue:p,rawValue:a,sender:this}))}}class ce{constructor(t){this.emitter=new E,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const i=e??{forceEmit:!1,last:!0},a=this.value_;a===t&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:i,previousRawValue:a,rawValue:this.value_,sender:this}))}}function z(n,t){const e=t==null?void 0:t.constraint,i=t==null?void 0:t.equals;return!e&&!i?new ce(n):new Nn(n,t)}class R{constructor(t){this.emitter=new E,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",()=>{this.emitter.emit("change",{key:e,sender:this})})}static createCore(t){return Object.keys(t).reduce((i,a)=>Object.assign(i,{[a]:z(t[a])}),{})}static fromObject(t){const e=this.createCore(t);return new R(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function Qe(n,t){const i=Object.keys(t).reduce((a,p)=>{if(a===void 0)return;const b=t[p],P=b(n[p]);return P.succeeded?Object.assign(Object.assign({},a),{[p]:P.value}):void 0},{});return i}function he(n,t){return n.reduce((e,i)=>{if(e===void 0)return;const a=t(i);if(!(!a.succeeded||a.value===void 0))return[...e,a.value]},[])}function _o(n){return n===null?!1:typeof n=="object"}function vt(n){return t=>e=>{if(!t&&e===void 0)return{succeeded:!1,value:void 0};if(t&&e===void 0)return{succeeded:!0,value:void 0};const i=n(e);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function Hr(n){return{custom:t=>vt(t)(n),boolean:vt(t=>typeof t=="boolean"?t:void 0)(n),number:vt(t=>typeof t=="number"?t:void 0)(n),string:vt(t=>typeof t=="string"?t:void 0)(n),function:vt(t=>typeof t=="function"?t:void 0)(n),constant:t=>vt(e=>e===t?t:void 0)(n),raw:vt(t=>t)(n),object:t=>vt(e=>{if(_o(e))return Qe(e,t)})(n),array:t=>vt(e=>{if(Array.isArray(e))return he(e,t)})(n)}}const K={optional:Hr(!0),required:Hr(!1)};function G(n,t){const e=K.required.object(t)(n);return e.succeeded?e.value:void 0}function Ln(n){console.warn([`Missing '${n.key}' of ${n.target} in ${n.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function go(n){return n&&n.parentElement&&n.parentElement.removeChild(n),null}class Rn{constructor(t){this.value_=t}static create(t){return[new Rn(t),(e,i)=>{t.setRawValue(e,i)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const wo=g("");function jr(n,t){return F(n,wo(void 0,t))}class mt extends R{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=Rn.create(z(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,i,a;const p=t??{};return new mt(R.createCore({disabled:(e=p.disabled)!==null&&e!==void 0?e:!1,disposed:!1,hidden:(i=p.hidden)!==null&&i!==void 0?i:!1,parent:(a=p.parent)!==null&&a!==void 0?a:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){D(this.globalDisabled_,jr(t,"disabled")),T(this,"hidden",jr(t,"hidden"))}bindDisabled(t){D(this.globalDisabled_,e=>{t.disabled=e})}bindTabIndex(t){D(this.globalDisabled_,e=>{t.tabIndex=e?-1:0})}handleDispose(t){this.value("disposed").emitter.on("change",e=>{e&&t()})}getGlobalDisabled_(){const t=this.get("parent");return(t?t.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const i=t.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function xo(){return["veryfirst","first","last","verylast"]}const zr=g(""),qr={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class pe{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",()=>{xo().forEach(i=>{e.classList.remove(zr(void 0,qr[i]))}),this.blade.get("positions").forEach(i=>{e.classList.add(zr(void 0,qr[i]))})}),this.viewProps.handleDispose(()=>{go(e)})}get parent(){return this.parent_}set parent(t){if(this.parent_=t,!("parent"in this.viewProps.valMap_)){Ln({key:"parent",target:mt.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const ct="http://www.w3.org/2000/svg";function Je(n){n.offsetHeight}function yo(n,t){const e=n.style.transition;n.style.transition="none",t(),n.style.transition=e}function Tn(n){return n.ontouchstart!==void 0}function Co(){return globalThis}function Po(){return Co().document}function Eo(n){const t=n.ownerDocument.defaultView;return t&&"document"in t?n.getContext("2d",{willReadFrequently:!0}):null}const ko={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Ze(n,t){const e=n.createElementNS(ct,"svg");return e.innerHTML=ko[t],e}function Gr(n,t,e){n.insertBefore(t,n.children[e])}function Yr(n){n.parentElement&&n.parentElement.removeChild(n)}function Xr(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function So(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function Wr(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}const de=g("lbl");function Vo(n,t){const e=n.createDocumentFragment();return t.split(`
`).map(a=>n.createTextNode(a)).forEach((a,p)=>{p>0&&e.appendChild(n.createElement("br")),e.appendChild(a)}),e}class Qr{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(de()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(de("l")),T(e.props,"label",p=>{_(p)?this.element.classList.add(de(void 0,"nol")):(this.element.classList.remove(de(void 0,"nol")),So(i),i.appendChild(Vo(t,p)))}),this.element.appendChild(i),this.labelElement=i;const a=t.createElement("div");a.classList.add(de("v")),this.element.appendChild(a),this.valueElement=a}}class tn extends pe{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new Qr(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const Ao={id:"button",type:"blade",accept(n){const t=K,e=G(n,{title:t.required.string,view:t.required.constant("button"),label:t.optional.string});return e?{params:e}:null},controller(n){return new tn(n.document,{blade:n.blade,props:R.fromObject({label:n.params.label}),valueController:new Tt(n.document,{props:R.fromObject({title:n.params.title}),viewProps:n.viewProps})})},api(n){return!(n.controller instanceof tn)||!(n.controller.valueController instanceof Tt)?null:new S(n.controller)}};class Xt extends pe{constructor(t){super(t),this.value=t.value}}function fe(){return new R({positions:z([],{equals:x})})}class ve extends R{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=R.createCore(e);return new ve(i)}get styleExpanded(){var t;return(t=this.get("temporaryExpanded"))!==null&&t!==void 0?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!_(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const i=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};T(this,"expanded",i),T(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Mo(n,t){let e=0;return yo(t,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),Je(t),e=t.clientHeight,n.set("temporaryExpanded",null),Je(t)}),e}function Jr(n,t){t.style.height=n.styleHeight}function Dn(n,t){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),_(n.get("expandedHeight"))){const e=Mo(n,t);e>0&&n.set("expandedHeight",e)}n.set("shouldFixHeight",!0),Je(t)}),n.emitter.on("change",()=>{Jr(n,t)}),Jr(n,t),t.addEventListener("transitionend",e=>{e.propertyName==="height"&&n.cleanUpTransition()})}class In extends u{constructor(t,e){super(t),this.rackApi_=e}}function No(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}function Lo(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}function Ro(n,t){const e=t??{};return n.addBlade(Object.assign(Object.assign({},e),{view:"separator"}))}function To(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}class On{constructor(t){this.emitter=new E,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw w.shouldNeverHappen();const i=e!==void 0?e:this.items_.length;this.items_.splice(i,0,t),this.cache_.add(t);const a=this.extract_(t);a&&(a.emitter.on("add",this.onSubListAdd_),a.emitter.on("remove",this.onSubListRemove_),a.allItems().forEach(p=>{this.cache_.add(p)})),this.emitter.emit("add",{index:i,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const i=this.extract_(t);i&&(i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}class Fn extends u{constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new E,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new h(this,e,this.controller_.binding.target.presetKey,t.options.last)})}}class ht extends tn{constructor(t,e){super(t,e),this.binding=e.binding}}class Bn extends u{constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new E,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new d(this,e,this.controller_.binding.target.presetKey)})}}class Pt extends tn{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function Do(n){return n instanceof en?n.apiSet_:n instanceof In?n.rackApi_.apiSet_:null}function me(n,t){const e=n.find(i=>i.controller_===t);if(!e)throw w.shouldNeverHappen();return e}function Zr(n,t,e){if(!C.isBindable(n))throw w.notBindable();return new C(n,t,e)}class en extends u{constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new E,this.apiSet_=new On(Do),this.pool_=e;const i=this.controller_.rack;i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),i.emitter.on("inputchange",this.onRackInputChange_),i.emitter.on("monitorupdate",this.onRackMonitorUpdate_),i.children.forEach(a=>{this.setUpApi_(a)})}get children(){return this.controller_.rack.children.map(t=>me(this.apiSet_,t))}addInput(t,e,i){const a=i??{},p=this.controller_.view.element.ownerDocument,b=this.pool_.createInput(p,Zr(t,e,a.presetKey),a),P=new Fn(b);return this.add(P,a.index)}addMonitor(t,e,i){const a=i??{},p=this.controller_.view.element.ownerDocument,b=this.pool_.createMonitor(p,Zr(t,e),a),P=new Bn(b);return this.add(P,a.index)}addFolder(t){return Lo(this,t)}addButton(t){return No(this,t)}addSeparator(t){return Ro(this,t)}addTab(t){return To(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const i=this.apiSet_.find(a=>a.controller_===t.controller_);return i&&this.apiSet_.remove(i),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,i=this.pool_.createBlade(e,t),a=this.pool_.createBladeApi(i);return this.add(a,t.index)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}setUpApi_(t){this.apiSet_.find(i=>i.controller_===t)||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=me(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof ht){const i=me(this.apiSet_,e),a=e.binding;this.emitter_.emit("change",{event:new h(i,a.target.read(),a.target.presetKey,t.options.last)})}else if(e instanceof Xt){const i=me(this.apiSet_,e);this.emitter_.emit("change",{event:new h(i,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof Pt))throw w.shouldNeverHappen();const e=me(this.apiSet_,t.bladeController),i=t.bladeController.binding;this.emitter_.emit("update",{event:new d(e,i.target.read(),i.target.presetKey)})}}class $n extends In{constructor(t,e){super(t,new en(t.rackController,e)),this.emitter_=new E,this.controller_.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",{event:new m(this,i.sender.rawValue)})}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",{event:i})}),this.rackApi_.on("update",i=>{this.emitter_.emit("update",{event:i})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,i){return this.rackApi_.addInput(t,e,i)}addMonitor(t,e,i){return this.rackApi_.addMonitor(t,e,i)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}}class Kn extends pe{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class Io{constructor(t,e){const i=g(e.viewName);this.element=t.createElement("div"),this.element.classList.add(i()),e.viewProps.bindClassModifiers(this.element)}}function Oo(n,t){for(let e=0;e<n.length;e++){const i=n[e];if(i instanceof ht&&i.binding===t)return i}return null}function Fo(n,t){for(let e=0;e<n.length;e++){const i=n[e];if(i instanceof Pt&&i.binding===t)return i}return null}function Bo(n,t){for(let e=0;e<n.length;e++){const i=n[e];if(i instanceof Xt&&i.value===t)return i}return null}function Un(n){return n instanceof be?n.rack:n instanceof Kn?n.rackController.rack:null}function $o(n){const t=Un(n);return t?t.bcSet_:null}class Ko{constructor(t){var e,i;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new E,this.blade_=(e=t.blade)!==null&&e!==void 0?e:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=t.viewProps,this.bcSet_=new On($o),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){var i;(i=t.parent)===null||i===void 0||i.remove(t),y(t,"parent")?t.parent=this:(t.parent_=this,Ln({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(t,e)}remove(t){y(t,"parent")?t.parent=null:(t.parent_=null,Ln({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter(e=>e instanceof t)}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const i=t.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),i instanceof ht)i.binding.emitter.on("change",this.onChildInputChange_);else if(i instanceof Pt)i.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(i instanceof Xt)i.value.emitter.on("change",this.onChildValueChange_);else{const a=Un(i);if(a){const p=a.emitter;p.on("layout",this.onDescendantLayout_),p.on("inputchange",this.onDescendantInputChange_),p.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const i=t.item;if(i instanceof ht)i.binding.emitter.off("change",this.onChildInputChange_);else if(i instanceof Pt)i.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(i instanceof Xt)i.value.emitter.off("change",this.onChildValueChange_);else{const a=Un(i);if(a){const p=a.emitter;p.off("layout",this.onDescendantLayout_),p.off("inputchange",this.onDescendantInputChange_),p.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter(a=>!a.viewProps.get("hidden")),e=t[0],i=t[t.length-1];this.bcSet_.items.forEach(a=>{const p=[];a===e&&(p.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&p.push("veryfirst")),a===i&&(p.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&p.push("verylast")),a.blade.set("positions",p)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(e=>e.viewProps.get("disposed")).forEach(e=>{this.bcSet_.remove(e)})}onChildInputChange_(t){const e=Oo(this.find(ht),t.sender);if(!e)throw w.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=Fo(this.find(Pt),t.sender);if(!e)throw w.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=Bo(this.find(Xt),t.sender);if(!e)throw w.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class be extends pe{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Io(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const i=new Ko({blade:e.root?void 0:e.blade,viewProps:e.viewProps});i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),this.rack=i,this.viewProps.handleDispose(()=>{for(let a=this.rack.children.length-1;a>=0;a--)this.rack.children[a].viewProps.set("disposed",!0)})}onRackAdd_(t){t.isRoot&&Gr(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.isRoot&&Yr(t.bladeController.view.element)}}const ti=g("cnt");class Uo{constructor(t,e){var i;this.className_=g((i=e.viewName)!==null&&i!==void 0?i:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),ti()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),T(this.foldable_,"completed",F(this.element,this.className_(void 0,"cpl")));const a=t.createElement("button");a.classList.add(this.className_("b")),T(e.props,"title",N=>{_(N)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),e.viewProps.bindDisabled(a),this.element.appendChild(a),this.buttonElement=a;const p=t.createElement("div");p.classList.add(this.className_("i")),this.element.appendChild(p);const b=t.createElement("div");b.classList.add(this.className_("t")),H(e.props.value("title"),b),this.buttonElement.appendChild(b),this.titleElement=b;const P=t.createElement("div");P.classList.add(this.className_("m")),this.buttonElement.appendChild(P);const A=e.containerElement;A.classList.add(this.className_("c")),this.element.appendChild(A),this.containerElement=A}}class Hn extends Kn{constructor(t,e){var i;const a=ve.create((i=e.expanded)!==null&&i!==void 0?i:!0),p=new be(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:p,view:new Uo(t,{containerElement:p.view.element,foldable:a,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=a,Dn(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Ho={id:"folder",type:"blade",accept(n){const t=K,e=G(n,{title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean});return e?{params:e}:null},controller(n){return new Hn(n.document,{blade:n.blade,expanded:n.params.expanded,props:R.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof Hn?new $n(n.controller,n.pool):null}};class Wt extends Xt{constructor(t,e){const i=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new Qr(t,{props:e.props,viewProps:i}),viewProps:i})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class ei extends u{}const ni=g("spr");class jo{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ni()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("hr");i.classList.add(ni("r")),this.element.appendChild(i)}}class ri extends pe{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new jo(t,{viewProps:e.viewProps})}))}}const zo={id:"separator",type:"blade",accept(n){const e=G(n,{view:K.required.constant("separator")});return e?{params:e}:null},controller(n){return new ri(n.document,{blade:n.blade,viewProps:n.viewProps})},api(n){return n.controller instanceof ri?new ei(n.controller):null}},_e=g("tbi");class qo{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(_e()),e.viewProps.bindClassModifiers(this.element),T(e.props,"selected",p=>{p?this.element.classList.add(_e(void 0,"sel")):this.element.classList.remove(_e(void 0,"sel"))});const i=t.createElement("button");i.classList.add(_e("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const a=t.createElement("div");a.classList.add(_e("t")),H(e.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a}}class Go{constructor(t,e){this.emitter=new E,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new qo(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ii{constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Go(t,{props:e.itemProps,viewProps:mt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new be(t,{blade:fe(),viewProps:mt.create()}),this.props=e.props,T(this.props,"selected",i=>{this.itemController.props.set("selected",i),this.contentController.viewProps.set("hidden",!i)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class si{constructor(t,e){this.controller_=t,this.rackApi_=e}get title(){var t;return(t=this.controller_.itemController.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,i){return this.rackApi_.addInput(t,e,i)}addMonitor(t,e,i){return this.rackApi_.addMonitor(t,e,i)}addBlade(t){return this.rackApi_.addBlade(t)}}class oi extends In{constructor(t,e){super(t,new en(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new E,this.pageApiMap_=new Map,this.rackApi_.on("change",i=>{this.emitter_.emit("change",{event:i})}),this.rackApi_.on("update",i=>{this.emitter_.emit("update",{event:i})}),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(i=>{this.setUpPageApi_(i)})}get pages(){return this.controller_.pageSet.items.map(t=>{const e=this.pageApiMap_.get(t);if(!e)throw w.shouldNeverHappen();return e})}addPage(t){const e=this.controller_.view.element.ownerDocument,i=new ii(e,{itemProps:R.fromObject({selected:!1,title:t.title}),props:R.fromObject({selected:!1})});this.controller_.add(i,t.index);const a=this.pageApiMap_.get(i);if(!a)throw w.shouldNeverHappen();return a}removePage(t){this.controller_.remove(t)}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find(a=>a.controller_===t.contentController);if(!e)throw w.shouldNeverHappen();const i=new si(t,e);this.pageApiMap_.set(t,i)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw w.shouldNeverHappen();this.pageApiMap_.delete(t.item)}onSelect_(t){this.emitter_.emit("select",{event:new f(this,t.rawValue)})}}const ai=-1;class Yo{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=z(!0),this.selectedIndex=z(ai),this.items_=[]}add(t,e){const i=e??this.items_.length;this.items_.splice(i,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=ai,this.empty.rawValue=!0;return}const t=this.items_.findIndex(e=>e.rawValue);t<0?(this.items_.forEach((e,i)=>{e.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((e,i)=>{e.rawValue=i===t}),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex(i=>i===t.sender);this.items_.forEach((i,a)=>{i.rawValue=a===e}),this.selectedIndex.rawValue=e}else this.keepSelection_()}}const ge=g("tab");class Xo{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ge(),ti()),e.viewProps.bindClassModifiers(this.element),D(e.empty,F(this.element,ge(void 0,"nop")));const i=t.createElement("div");i.classList.add(ge("t")),this.element.appendChild(i),this.itemsElement=i;const a=t.createElement("div");a.classList.add(ge("i")),this.element.appendChild(a);const p=e.contentsElement;p.classList.add(ge("c")),this.element.appendChild(p),this.contentsElement=p}}class li extends Kn{constructor(t,e){const i=new be(t,{blade:e.blade,viewProps:e.viewProps}),a=new Yo;super({blade:e.blade,rackController:i,view:new Xo(t,{contentsElement:i.view.element,empty:a.empty,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new On(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=a}get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,e)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}onPageAdd_(t){const e=t.item;Gr(this.view.itemsElement,e.itemController.view.element,t.index),e.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(e.contentController,t.index),this.tab.add(e.props.value("selected"))}onPageRemove_(t){const e=t.item;Yr(e.itemController.view.element),e.itemController.viewProps.set("parent",null),this.rackController.rack.remove(e.contentController),this.tab.remove(e.props.value("selected"))}}const ui={id:"tab",type:"blade",accept(n){const t=K,e=G(n,{pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")});return!e||e.pages.length===0?null:{params:e}},controller(n){const t=new li(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(e=>{const i=new ii(n.document,{itemProps:R.fromObject({selected:!1,title:e.title}),props:R.fromObject({selected:!1})});t.add(i)}),t},api(n){return n.controller instanceof li?new oi(n.controller,n.pool):null}};function Wo(n,t){const e=n.accept(t.params);if(!e)return null;const i=K.optional.boolean(t.params.disabled).value,a=K.optional.boolean(t.params.hidden).value;return n.controller({blade:fe(),document:t.document,params:Object.assign(Object.assign({},e.params),{disabled:i,hidden:a}),viewProps:mt.create({disabled:i,hidden:a})})}class Qo{constructor(){this.disabled=!1,this.emitter=new E}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Jo{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new E,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Zo{constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new E,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}read(){const t=this.target.read();t!==void 0&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}function ci(n,t){for(;n.length<t;)n.push(void 0)}function ta(n){const t=[];return ci(t,n),z(t)}function ea(n){const t=n.indexOf(void 0);return t<0?n:n.slice(0,t)}function na(n,t){const e=[...ea(n),t];return e.length>n.length?e.splice(0,e.length-n.length):ci(e,n.length),e}class ra{constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new E,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(t===void 0)return;const e=this.value.rawValue,i=this.reader_(t);this.value.rawValue=na(e,i),this.emitter.emit("update",{rawValue:i,sender:this})}onTick_(t){this.read()}}class we{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce((e,i)=>i.constrain(e),t)}}function bt(n,t){if(n instanceof t)return n;if(n instanceof we){const e=n.constraints.reduce((i,a)=>i||(a instanceof t?a:null),null);if(e)return e}return null}class Qt{constructor(t){this.values=R.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(t,i),e)}}class xe{constructor(t){this.values=R.fromObject({options:t})}get options(){return this.values.get("options")}constrain(t){const e=this.values.get("options");return e.length===0||e.filter(a=>a.value===t).length>0?t:e[0].value}}class hi{constructor(t){this.values=R.fromObject({max:t.max,min:t.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(t){const e=this.values.get("max"),i=this.values.get("min");let a=t;return _(i)||(a=Math.max(a,i)),_(e)||(a=Math.min(a,e)),a}}class nn{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step,i=Math.round((t-e)/this.step);return e+i*this.step}}const jn=g("lst");class ia{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(jn()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("select");i.classList.add(jn("s")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const a=t.createElement("div");a.classList.add(jn("m")),a.appendChild(Ze(t,"dropdown")),this.element.appendChild(a),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,T(this.props_,"options",p=>{Xr(this.selectElement),p.forEach(b=>{const P=t.createElement("option");P.textContent=b.text,this.selectElement.appendChild(P)}),this.update_()})}update_(){const t=this.props_.get("options").map(e=>e.value);this.selectElement.selectedIndex=t.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class ye{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ia(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=t.currentTarget;this.value.rawValue=this.props.get("options")[e.selectedIndex].value}}const pi=g("pop");class sa{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(pi()),e.viewProps.bindClassModifiers(this.element),D(e.shows,F(this.element,pi(void 0,"v")))}}class di{constructor(t,e){this.shows=z(!1),this.viewProps=e.viewProps,this.view=new sa(t,{shows:this.shows,viewProps:this.viewProps})}}const fi=g("txt");class oa{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(fi()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const i=t.createElement("input");i.classList.add(fi("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class rn{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new oa(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const i=t.currentTarget.value,a=this.parser_(i);_(a)||(this.value.rawValue=a),this.view.refresh()}}function aa(n){return String(n)}function vi(n){return n==="false"?!1:!!n}function mi(n){return aa(n)}class la{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const ua={"**":(n,t)=>Math.pow(n,t),"*":(n,t)=>n*t,"/":(n,t)=>n/t,"%":(n,t)=>n%t,"+":(n,t)=>n+t,"-":(n,t)=>n-t,"<<":(n,t)=>n<<t,">>":(n,t)=>n>>t,">>>":(n,t)=>n>>>t,"&":(n,t)=>n&t,"^":(n,t)=>n^t,"|":(n,t)=>n|t};class ca{constructor(t,e,i){this.left=e,this.operator=t,this.right=i}evaluate(){const t=ua[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const ha={"+":n=>n,"-":n=>-n,"~":n=>~n};class pa{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=ha[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function zn(n){return(t,e)=>{for(let i=0;i<n.length;i++){const a=n[i](t,e);if(a!=="")return a}return""}}function Ce(n,t){var e;const i=n.substr(t).match(/^\s+/);return(e=i&&i[0])!==null&&e!==void 0?e:""}function da(n,t){const e=n.substr(t,1);return e.match(/^[1-9]$/)?e:""}function Pe(n,t){var e;const i=n.substr(t).match(/^[0-9]+/);return(e=i&&i[0])!==null&&e!==void 0?e:""}function fa(n,t){const e=Pe(n,t);if(e!=="")return e;const i=n.substr(t,1);if(t+=1,i!=="-"&&i!=="+")return"";const a=Pe(n,t);return a===""?"":i+a}function qn(n,t){const e=n.substr(t,1);if(t+=1,e.toLowerCase()!=="e")return"";const i=fa(n,t);return i===""?"":e+i}function bi(n,t){const e=n.substr(t,1);if(e==="0")return e;const i=da(n,t);return t+=i.length,i===""?"":i+Pe(n,t)}function va(n,t){const e=bi(n,t);if(t+=e.length,e==="")return"";const i=n.substr(t,1);if(t+=i.length,i!==".")return"";const a=Pe(n,t);return t+=a.length,e+i+a+qn(n,t)}function ma(n,t){const e=n.substr(t,1);if(t+=e.length,e!==".")return"";const i=Pe(n,t);return t+=i.length,i===""?"":e+i+qn(n,t)}function ba(n,t){const e=bi(n,t);return t+=e.length,e===""?"":e+qn(n,t)}const _a=zn([va,ma,ba]);function ga(n,t){var e;const i=n.substr(t).match(/^[01]+/);return(e=i&&i[0])!==null&&e!==void 0?e:""}function wa(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0b")return"";const i=ga(n,t);return i===""?"":e+i}function xa(n,t){var e;const i=n.substr(t).match(/^[0-7]+/);return(e=i&&i[0])!==null&&e!==void 0?e:""}function ya(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0o")return"";const i=xa(n,t);return i===""?"":e+i}function Ca(n,t){var e;const i=n.substr(t).match(/^[0-9a-f]+/i);return(e=i&&i[0])!==null&&e!==void 0?e:""}function Pa(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0x")return"";const i=Ca(n,t);return i===""?"":e+i}const Ea=zn([wa,ya,Pa]),ka=zn([Ea,_a]);function Sa(n,t){const e=ka(n,t);return t+=e.length,e===""?null:{evaluable:new la(e),cursor:t}}function Va(n,t){const e=n.substr(t,1);if(t+=e.length,e!=="(")return null;const i=gi(n,t);if(!i)return null;t=i.cursor,t+=Ce(n,t).length;const a=n.substr(t,1);return t+=a.length,a!==")"?null:{evaluable:i.evaluable,cursor:t}}function Aa(n,t){var e;return(e=Sa(n,t))!==null&&e!==void 0?e:Va(n,t)}function _i(n,t){const e=Aa(n,t);if(e)return e;const i=n.substr(t,1);if(t+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const a=_i(n,t);return a?(t=a.cursor,{cursor:t,evaluable:new pa(i,a.evaluable)}):null}function Ma(n,t,e){e+=Ce(t,e).length;const i=n.filter(a=>t.startsWith(a,e))[0];return i?(e+=i.length,e+=Ce(t,e).length,{cursor:e,operator:i}):null}function Na(n,t){return(e,i)=>{const a=n(e,i);if(!a)return null;i=a.cursor;let p=a.evaluable;for(;;){const b=Ma(t,e,i);if(!b)break;i=b.cursor;const P=n(e,i);if(!P)return null;i=P.cursor,p=new ca(b.operator,p,P.evaluable)}return p?{cursor:i,evaluable:p}:null}}const La=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,t)=>Na(n,t),_i);function gi(n,t){return t+=Ce(n,t).length,La(n,t)}function Ra(n){const t=gi(n,0);return!t||t.cursor+Ce(n,t.cursor).length!==n.length?null:t.evaluable}function _t(n){var t;const e=Ra(n);return(t=e==null?void 0:e.evaluate())!==null&&t!==void 0?t:null}function wi(n){if(typeof n=="number")return n;if(typeof n=="string"){const t=_t(n);if(!_(t))return t}return 0}function Ta(n){return String(n)}function Y(n){return t=>t.toFixed(Math.max(Math.min(n,20),0))}const Da=Y(0);function sn(n){return Da(n)+"%"}function xi(n){return String(n)}function Gn(n){return n}function Ee({primary:n,secondary:t,forward:e,backward:i}){let a=!1;function p(b){a||(a=!0,b(),a=!1)}n.emitter.on("change",b=>{p(()=>{t.setRawValue(e(n,t),b.options)})}),t.emitter.on("change",b=>{p(()=>{n.setRawValue(i(n,t),b.options)}),p(()=>{t.setRawValue(e(n,t),b.options)})}),p(()=>{t.setRawValue(e(n,t),{forceEmit:!1,last:!0})})}function rt(n,t){const e=n*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+e:t.downKey?-e:0}function ke(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function gt(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function Ia(n){return n==="ArrowUp"||n==="ArrowDown"}function yi(n){return Ia(n)||n==="ArrowLeft"||n==="ArrowRight"}function Yn(n,t){var e,i;const a=t.ownerDocument.defaultView,p=t.getBoundingClientRect();return{x:n.pageX-(((e=a&&a.scrollX)!==null&&e!==void 0?e:0)+p.left),y:n.pageY-(((i=a&&a.scrollY)!==null&&i!==void 0?i:0)+p.top)}}class Dt{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new E,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),(e=t.currentTarget)===null||e===void 0||e.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Yn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Yn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Yn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-i.left,y:e.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const i=(e=t.targetTouches.item(0))!==null&&e!==void 0?e:this.lastTouch_,a=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(i?{x:i.clientX-a.left,y:i.clientY-a.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function U(n,t,e,i,a){const p=(n-t)/(e-t);return i+p*(a-i)}function Ci(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function q(n,t,e){return Math.min(Math.max(n,t),e)}function Pi(n,t){return(n%t+t)%t}const ot=g("txt");class Oa{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(ot(),ot(void 0,"num")),e.arrayPosition&&this.element.classList.add(ot(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(ot("i")),i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ot()),this.inputElement.classList.add(ot("i"));const a=t.createElement("div");a.classList.add(ot("k")),this.element.appendChild(a),this.knobElement=a;const p=t.createElementNS(ct,"svg");p.classList.add(ot("g")),this.knobElement.appendChild(p);const b=t.createElementNS(ct,"path");b.classList.add(ot("gb")),p.appendChild(b),this.guideBodyElem_=b;const P=t.createElementNS(ct,"path");P.classList.add(ot("gh")),p.appendChild(P),this.guideHeadElem_=P;const A=t.createElement("div");A.classList.add(g("tt")()),this.knobElement.appendChild(A),this.tooltipElem_=A,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(t.rawValue===null){this.element.classList.remove(ot(void 0,"drg"));return}this.element.classList.add(ot(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),i=e+(e>0?-1:e<0?1:0),a=q(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+a},0 L${i},4 L${i+a},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const p=this.props_.get("formatter");this.tooltipElem_.textContent=p(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Se{constructor(t,e){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=(i=e.sliderProps)!==null&&i!==void 0?i:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=z(null),this.view=new Oa(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const a=new Dt(this.view.knobElement);a.emitter.on("down",this.onPointerDown_),a.emitter.on("move",this.onPointerMove_),a.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,i;const a=(e=this.sliderProps_)===null||e===void 0?void 0:e.get("minValue"),p=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("maxValue");let b=t;return a!==void 0&&(b=Math.max(b,a)),p!==void 0&&(b=Math.min(b,p)),b}onInputChange_(t){const i=t.currentTarget.value,a=this.parser_(i);_(a)||(this.value.rawValue=this.constrainValue_(a)),this.view.refresh()}onInputKeyDown_(t){const e=rt(this.baseStep_,ke(t));e!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){rt(this.baseStep_,ke(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Xn=g("sld");class Fa{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Xn()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(Xn("t")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const a=t.createElement("div");a.classList.add(Xn("k")),this.trackElement.appendChild(a),this.knobElement=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=q(U(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}}class Ba{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new Fa(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Dt(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(U(q(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=rt(this.baseStep_,gt(t));e!==0&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){rt(this.baseStep_,gt(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Wn=g("sldtxt");class $a{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Wn());const i=t.createElement("div");i.classList.add(Wn("s")),this.sliderView_=e.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const a=t.createElement("div");a.classList.add(Wn("t")),this.textView_=e.textView,a.appendChild(this.textView_.element),this.element.appendChild(a)}}class Qn{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new Ba(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new Se(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new $a(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Ve(n,t){n.write(t)}function on(n){const t=K;if(Array.isArray(n))return t.required.array(t.required.object({text:t.required.string,value:t.required.raw}))(n).value;if(typeof n=="object")return t.required.raw(n).value}function Ei(n){if(n==="inline"||n==="popup")return n}function Et(n){const t=K;return t.required.object({max:t.optional.number,min:t.optional.number,step:t.optional.number})(n).value}function ki(n){if(Array.isArray(n))return n;const t=[];return Object.keys(n).forEach(e=>{t.push({text:e,value:n[e]})}),t}function Jn(n){return _(n)?null:new xe(ki(n))}function Ka(n){const t=n?bt(n,nn):null;return t?t.step:null}function an(n,t){const e=n&&bt(n,nn);return e?Ci(e.step):Math.max(Ci(t),2)}function Jt(n){const t=Ka(n);return t??1}function Zt(n,t){var e;const i=n&&bt(n,nn),a=Math.abs((e=i==null?void 0:i.step)!==null&&e!==void 0?e:t);return a===0?.1:Math.pow(10,Math.floor(Math.log10(a))-1)}const ln=g("ckb");class Ua{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ln()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("label");i.classList.add(ln("l")),this.element.appendChild(i);const a=t.createElement("input");a.classList.add(ln("i")),a.type="checkbox",i.appendChild(a),this.inputElement=a,e.viewProps.bindDisabled(this.inputElement);const p=t.createElement("div");p.classList.add(ln("w")),i.appendChild(p);const b=Ze(t,"check");p.appendChild(b),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Ha{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Ua(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked}}function ja(n){const t=[],e=Jn(n.options);return e&&t.push(e),new we(t)}const za={id:"input-bool",type:"input",accept:(n,t)=>{if(typeof n!="boolean")return null;const i=G(t,{options:K.optional.custom(on)});return i?{initialValue:n,params:i}:null},binding:{reader:n=>vi,constraint:n=>ja(n.params),writer:n=>Ve},controller:n=>{const t=n.document,e=n.value,i=n.constraint,a=i&&bt(i,xe);return a?new ye(t,{props:new R({options:a.values.value("options")}),value:e,viewProps:n.viewProps}):new Ha(t,{value:e,viewProps:n.viewProps})}},It=g("col");class qa{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(It()),e.foldable.bindExpandedClass(this.element,It(void 0,"expanded")),T(e.foldable,"completed",F(this.element,It(void 0,"cpl")));const i=t.createElement("div");i.classList.add(It("h")),this.element.appendChild(i);const a=t.createElement("div");a.classList.add(It("s")),i.appendChild(a),this.swatchElement=a;const p=t.createElement("div");if(p.classList.add(It("t")),i.appendChild(p),this.textElement=p,e.pickerLayout==="inline"){const b=t.createElement("div");b.classList.add(It("p")),this.element.appendChild(b),this.pickerElement=b}else this.pickerElement=null}}function Ga(n,t,e){const i=q(n/255,0,1),a=q(t/255,0,1),p=q(e/255,0,1),b=Math.max(i,a,p),P=Math.min(i,a,p),A=b-P;let N=0,B=0;const $=(P+b)/2;return A!==0&&(B=A/(1-Math.abs(b+P-1)),i===b?N=(a-p)/A:a===b?N=2+(p-i)/A:N=4+(i-a)/A,N=N/6+(N<0?1:0)),[N*360,B*100,$*100]}function Ya(n,t,e){const i=(n%360+360)%360,a=q(t/100,0,1),p=q(e/100,0,1),b=(1-Math.abs(2*p-1))*a,P=b*(1-Math.abs(i/60%2-1)),A=p-b/2;let N,B,$;return i>=0&&i<60?[N,B,$]=[b,P,0]:i>=60&&i<120?[N,B,$]=[P,b,0]:i>=120&&i<180?[N,B,$]=[0,b,P]:i>=180&&i<240?[N,B,$]=[0,P,b]:i>=240&&i<300?[N,B,$]=[P,0,b]:[N,B,$]=[b,0,P],[(N+A)*255,(B+A)*255,($+A)*255]}function Xa(n,t,e){const i=q(n/255,0,1),a=q(t/255,0,1),p=q(e/255,0,1),b=Math.max(i,a,p),P=Math.min(i,a,p),A=b-P;let N;A===0?N=0:b===i?N=60*(((a-p)/A%6+6)%6):b===a?N=60*((p-i)/A+2):N=60*((i-a)/A+4);const B=b===0?0:A/b,$=b;return[N,B*100,$*100]}function Si(n,t,e){const i=Pi(n,360),a=q(t/100,0,1),p=q(e/100,0,1),b=p*a,P=b*(1-Math.abs(i/60%2-1)),A=p-b;let N,B,$;return i>=0&&i<60?[N,B,$]=[b,P,0]:i>=60&&i<120?[N,B,$]=[P,b,0]:i>=120&&i<180?[N,B,$]=[0,b,P]:i>=180&&i<240?[N,B,$]=[0,P,b]:i>=240&&i<300?[N,B,$]=[P,0,b]:[N,B,$]=[b,0,P],[(N+A)*255,(B+A)*255,($+A)*255]}function Wa(n,t,e){const i=e+t*(100-Math.abs(2*e-100))/200;return[n,i!==0?t*(100-Math.abs(2*e-100))/i:0,e+t*(100-Math.abs(2*e-100))/(2*100)]}function Qa(n,t,e){const i=100-Math.abs(e*(200-t)/100-100);return[n,i!==0?t*e/i:0,e*(200-t)/(2*100)]}function Ot(n){return[n[0],n[1],n[2]]}function Vi(n,t){return[n[0],n[1],n[2],t]}const Ja={hsl:{hsl:(n,t,e)=>[n,t,e],hsv:Wa,rgb:Ya},hsv:{hsl:Qa,hsv:(n,t,e)=>[n,t,e],rgb:Si},rgb:{hsl:Ga,hsv:Xa,rgb:(n,t,e)=>[n,t,e]}};function un(n,t){return[t==="float"?1:n==="rgb"?255:360,t==="float"?1:n==="rgb"?255:100,t==="float"?1:n==="rgb"?255:100]}function Za(n,t){return n===t?t:Pi(n,t)}function tl(n,t,e){var i;const a=un(t,e);return[t==="rgb"?q(n[0],0,a[0]):Za(n[0],a[0]),q(n[1],0,a[1]),q(n[2],0,a[2]),q((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function Ai(n,t,e,i){const a=un(t,e),p=un(t,i);return n.map((b,P)=>b/a[P]*p[P])}function el(n,t,e){const i=Ai(n,t.mode,t.type,"int"),a=Ja[t.mode][e.mode](...i);return Ai(a,e.mode,"int",e.type)}function cn(n,t){return typeof n!="object"||_(n)?!1:t in n&&typeof n[t]=="number"}class I{static black(t="int"){return new I([0,0,0],"rgb",t)}static fromObject(t,e="int"){const i="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new I(i,"rgb",e)}static toRgbaObject(t,e="int"){return t.toRgbaObject(e)}static isRgbColorObject(t){return cn(t,"r")&&cn(t,"g")&&cn(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&cn(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode!==e.mode)return!1;const i=t.comps_,a=e.comps_;for(let p=0;p<i.length;p++)if(i[p]!==a[p])return!1;return!0}constructor(t,e,i="int"){this.mode=e,this.type=i,this.comps_=tl(t,e,i)}getComponents(t,e="int"){return Vi(el(Ot(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:e}),this.comps_[3])}toRgbaObject(t="int"){const e=this.getComponents("rgb",t);return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const kt=g("colp");class nl{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(kt()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(kt("hsv"));const a=t.createElement("div");a.classList.add(kt("sv")),this.svPaletteView_=e.svPaletteView,a.appendChild(this.svPaletteView_.element),i.appendChild(a);const p=t.createElement("div");p.classList.add(kt("h")),this.hPaletteView_=e.hPaletteView,p.appendChild(this.hPaletteView_.element),i.appendChild(p),this.element.appendChild(i);const b=t.createElement("div");if(b.classList.add(kt("rgb")),this.textView_=e.textView,b.appendChild(this.textView_.element),this.element.appendChild(b),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const P=t.createElement("div");P.classList.add(kt("a"));const A=t.createElement("div");A.classList.add(kt("ap")),A.appendChild(this.alphaViews_.palette.element),P.appendChild(A);const N=t.createElement("div");N.classList.add(kt("at")),N.appendChild(this.alphaViews_.text.element),P.appendChild(N),this.element.appendChild(P)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(e=>e.inputElement)];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function rl(n){return n==="int"?"int":n==="float"?"float":void 0}function Zn(n){const t=K;return G(n,{alpha:t.optional.boolean,color:t.optional.object({alpha:t.optional.boolean,type:t.optional.custom(rl)}),expanded:t.optional.boolean,picker:t.optional.custom(Ei)})}function Ft(n){return n?.1:1}function Bt(n){var t;return(t=n.color)===null||t===void 0?void 0:t.type}function il(n,t){return n.alpha===t.alpha&&n.mode===t.mode&&n.notation===t.notation&&n.type===t.type}function at(n,t){const e=n.match(/^(.+)%$/);return Math.min(e?parseFloat(e[1])*.01*t:parseFloat(n),t)}const sl={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function Mi(n){const t=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(n);const e=parseFloat(t[1]),i=t[2];return sl[i](e)}function Ni(n){const t=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[at(t[1],255),at(t[2],255),at(t[3],255)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Li(n){return t=>{const e=Ni(t);return e?new I(e,"rgb",n):null}}function Ri(n){const t=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[at(t[1],255),at(t[2],255),at(t[3],255),at(t[4],1)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function Ti(n){return t=>{const e=Ri(t);return e?new I(e,"rgb",n):null}}function Di(n){const t=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[Mi(t[1]),at(t[2],100),at(t[3],100)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Ii(n){return t=>{const e=Di(t);return e?new I(e,"hsl",n):null}}function Oi(n){const t=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[Mi(t[1]),at(t[2],100),at(t[3],100),at(t[4],1)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function Fi(n){return t=>{const e=Oi(t);return e?new I(e,"hsl",n):null}}function Bi(n){const t=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];const e=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}function ol(n){const t=Bi(n);return t?new I(t,"rgb","int"):null}function $i(n){const t=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),U(parseInt(t[4]+t[4],16),0,255,0,1)];const e=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),U(parseInt(e[4],16),0,255,0,1)]:null}function al(n){const t=$i(n);return t?new I(t,"rgb","int"):null}function Ki(n){const t=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const e=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Ui(n){return t=>{const e=Ki(t);return e?new I(e,"rgb",n):null}}function Hi(n){const t=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const e=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function ji(n){return t=>{const e=Hi(t);return e?new I(e,"rgb",n):null}}const ll=[{parser:Bi,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:$i,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Ni,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Ri,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Di,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Oi,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Ki,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Hi,result:{alpha:!0,mode:"rgb",notation:"object"}}];function ul(n){return ll.reduce((t,{parser:e,result:i})=>t||(e(n)?i:null),null)}function tr(n,t="int"){const e=ul(n);return e?e.notation==="hex"&&t!=="float"?Object.assign(Object.assign({},e),{type:"int"}):e.notation==="func"?Object.assign(Object.assign({},e),{type:t}):null:null}const zi={int:[ol,al,Li("int"),Ti("int"),Ii("int"),Fi("int"),Ui("int"),ji("int")],float:[Li("float"),Ti("float"),Ii("float"),Fi("float"),Ui("float"),ji("float")]};function cl(n){const t=zi[n];return e=>{if(typeof e!="string")return I.black(n);const i=t.reduce((a,p)=>a||p(e),null);return i??I.black(n)}}function er(n){const t=zi[n];return e=>t.reduce((i,a)=>i||a(e),null)}function qi(n){const t=q(Math.floor(n),0,255).toString(16);return t.length===1?`0${t}`:t}function Gi(n,t="#"){const e=Ot(n.getComponents("rgb")).map(qi).join("");return`${t}${e}`}function nr(n,t="#"){const e=n.getComponents("rgb"),i=[e[0],e[1],e[2],e[3]*255].map(qi).join("");return`${t}${i}`}function Yi(n,t){const e=Y(t==="float"?2:0);return`rgb(${Ot(n.getComponents("rgb",t)).map(a=>e(a)).join(", ")})`}function hl(n){return t=>Yi(t,n)}function hn(n,t){const e=Y(2),i=Y(t==="float"?2:0);return`rgba(${n.getComponents("rgb",t).map((p,b)=>(b===3?e:i)(p)).join(", ")})`}function pl(n){return t=>hn(t,n)}function dl(n){const t=[Y(0),sn,sn];return`hsl(${Ot(n.getComponents("hsl")).map((i,a)=>t[a](i)).join(", ")})`}function fl(n){const t=[Y(0),sn,sn,Y(2)];return`hsla(${n.getComponents("hsl").map((i,a)=>t[a](i)).join(", ")})`}function Xi(n,t){const e=Y(t==="float"?2:0),i=["r","g","b"];return`{${Ot(n.getComponents("rgb",t)).map((p,b)=>`${i[b]}: ${e(p)}`).join(", ")}}`}function vl(n){return t=>Xi(t,n)}function Wi(n,t){const e=Y(2),i=Y(t==="float"?2:0),a=["r","g","b","a"];return`{${n.getComponents("rgb",t).map((b,P)=>{const A=P===3?e:i;return`${a[P]}: ${A(b)}`}).join(", ")}}`}function ml(n){return t=>Wi(t,n)}const bl=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Gi},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:nr},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:dl},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:fl},...["int","float"].reduce((n,t)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"func",type:t},stringifier:hl(t)},{format:{alpha:!0,mode:"rgb",notation:"func",type:t},stringifier:pl(t)},{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:vl(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:ml(t)}],[])];function rr(n){return bl.reduce((t,e)=>t||(il(e.format,n)?e.stringifier:null),null)}const Ae=g("apl");class _l{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Ae()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(Ae("b")),this.element.appendChild(i);const a=t.createElement("div");a.classList.add(Ae("c")),i.appendChild(a),this.colorElem_=a;const p=t.createElement("div");p.classList.add(Ae("m")),this.element.appendChild(p),this.markerElem_=p;const b=t.createElement("div");b.classList.add(Ae("p")),this.markerElem_.appendChild(b),this.previewElem_=b,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),i=new I([e[0],e[1],e[2],0],"rgb"),a=new I([e[0],e[1],e[2],255],"rgb"),p=["to right",hn(i),hn(a)];this.colorElem_.style.background=`linear-gradient(${p.join(",")})`,this.previewElem_.style.backgroundColor=hn(t);const b=U(e[3],0,1,0,100);this.markerElem_.style.left=`${b}%`}onValueChange_(){this.update_()}}class gl{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new _l(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Dt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=t.point.x/t.bounds.width,a=this.value.rawValue,[p,b,P]=a.getComponents("hsv");this.value.setRawValue(new I([p,b,P,i],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=rt(Ft(!0),gt(t));if(e===0)return;const i=this.value.rawValue,[a,p,b,P]=i.getComponents("hsv");this.value.setRawValue(new I([a,p,b,P+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){rt(Ft(!0),gt(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const te=g("coltxt");function wl(n){const t=n.createElement("select"),e=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return t.appendChild(e.reduce((i,a)=>{const p=n.createElement("option");return p.textContent=a.text,p.value=a.value,i.appendChild(p),i},n.createDocumentFragment())),t}class xl{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(te()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(te("m")),this.modeElem_=wl(t),this.modeElem_.classList.add(te("ms")),i.appendChild(this.modeSelectElement),e.viewProps.bindDisabled(this.modeElem_);const a=t.createElement("div");a.classList.add(te("mm")),a.appendChild(Ze(t,"dropdown")),i.appendChild(a),this.element.appendChild(i);const p=t.createElement("div");p.classList.add(te("w")),this.element.appendChild(p),this.textsElem_=p,this.textViews_=e.textViews,this.applyTextViews_(),D(e.colorMode,b=>{this.modeElem_.value=b})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){Xr(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach(e=>{const i=t.createElement("div");i.classList.add(te("c")),i.appendChild(e.element),this.textsElem_.appendChild(i)})}}function yl(n){return Y(n==="float"?2:0)}function Cl(n,t,e){const i=un(n,t)[e];return new Qt({min:0,max:i})}function ir(n,t,e){return new Se(n,{arrayPosition:e===0?"fst":e===3-1?"lst":"mid",baseStep:Ft(!1),parser:t.parser,props:R.fromObject({draggingScale:t.colorType==="float"?.01:1,formatter:yl(t.colorType)}),value:z(0,{constraint:Cl(t.colorMode,t.colorType,e)}),viewProps:t.viewProps})}class Pl{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=z(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new xl(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},i=[ir(t,e,0),ir(t,e,1),ir(t,e,2)];return i.forEach((a,p)=>{Ee({primary:this.value,secondary:a.value,forward:b=>b.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[p],backward:(b,P)=>{const A=this.colorMode.rawValue,N=b.rawValue.getComponents(A,this.colorType_);return N[p]=P.rawValue,new I(Vi(Ot(N),N[3]),A,this.colorType_)}})}),i}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const sr=g("hpl");class El{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(sr()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("div");i.classList.add(sr("c")),this.element.appendChild(i);const a=t.createElement("div");a.classList.add(sr("m")),this.element.appendChild(a),this.markerElem_=a,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=Yi(new I([e,100,100],"hsv"));const i=U(e,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}}class kl{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new El(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Dt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=U(q(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),a=this.value.rawValue,[,p,b,P]=a.getComponents("hsv");this.value.setRawValue(new I([i,p,b,P],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=rt(Ft(!1),gt(t));if(e===0)return;const i=this.value.rawValue,[a,p,b,P]=i.getComponents("hsv");this.value.setRawValue(new I([a+e,p,b,P],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){rt(Ft(!1),gt(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const or=g("svp"),Qi=64;class Sl{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(or()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const i=t.createElement("canvas");i.height=Qi,i.width=Qi,i.classList.add(or("c")),this.element.appendChild(i),this.canvasElement=i;const a=t.createElement("div");a.classList.add(or("m")),this.element.appendChild(a),this.markerElem_=a,this.update_()}update_(){const t=Eo(this.canvasElement);if(!t)return;const i=this.value.rawValue.getComponents("hsv"),a=this.canvasElement.width,p=this.canvasElement.height,b=t.getImageData(0,0,a,p),P=b.data;for(let B=0;B<p;B++)for(let $=0;$<a;$++){const $t=U($,0,a,0,100),Ne=U(B,0,p,100,0),Le=Si(i[0],$t,Ne),pn=(B*a+$)*4;P[pn]=Le[0],P[pn+1]=Le[1],P[pn+2]=Le[2],P[pn+3]=255}t.putImageData(b,0,0);const A=U(i[1],0,100,0,100);this.markerElem_.style.left=`${A}%`;const N=U(i[2],0,100,100,0);this.markerElem_.style.top=`${N}%`}onValueChange_(){this.update_()}}class Vl{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Sl(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Dt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=U(t.point.x,0,t.bounds.width,0,100),a=U(t.point.y,0,t.bounds.height,100,0),[p,,,b]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new I([p,i,a,b],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){yi(t.key)&&t.preventDefault();const[e,i,a,p]=this.value.rawValue.getComponents("hsv"),b=Ft(!1),P=rt(b,gt(t)),A=rt(b,ke(t));P===0&&A===0||this.value.setRawValue(new I([e,i+P,a+A,p],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=Ft(!1),i=rt(e,gt(t)),a=rt(e,ke(t));i===0&&a===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Al{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new kl(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Vl(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new gl(t,{value:this.value,viewProps:this.viewProps}),text:new Se(t,{parser:_t,baseStep:.1,props:R.fromObject({draggingScale:.01,formatter:Y(2)}),value:z(0,{constraint:new Qt({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ee({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.rawValue.getComponents()[3],backward:(i,a)=>{const p=i.rawValue.getComponents();return p[3]=a.rawValue,new I(p,i.rawValue.mode)}}),this.textC_=new Pl(t,{colorType:e.colorType,parser:_t,value:this.value,viewProps:this.viewProps}),this.view=new nl(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}get textController(){return this.textC_}}const ar=g("colsw");class Ml{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(ar()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(ar("sw")),this.element.appendChild(i),this.swatchElem_=i;const a=t.createElement("button");a.classList.add(ar("b")),e.viewProps.bindDisabled(a),this.element.appendChild(a),this.buttonElement=a,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=nr(t)}onValueChange_(){this.update_()}}class Nl{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Ml(t,{value:this.value,viewProps:this.viewProps})}}class lr{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=ve.create(e.expanded),this.swatchC_=new Nl(t,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new rn(t,{parser:e.parser,props:R.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new qa(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=e.pickerLayout==="popup"?new di(t,{viewProps:this.viewProps}):null;const a=new Al(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});a.view.allFocusableElements.forEach(p=>{p.addEventListener("blur",this.onPopupChildBlur_),p.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=a,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(a.view.element),Ee({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:p=>p.rawValue,backward:(p,b)=>b.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Dn(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=Wr(t);i&&e.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!Tn(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function Ll(n,t){return I.isColorObject(n)?I.fromObject(n,t):I.black(t)}function Rl(n){return Ot(n.getComponents("rgb")).reduce((t,e)=>t<<8|Math.floor(e)&255,0)}function Tl(n){return n.getComponents("rgb").reduce((t,e,i)=>{const a=Math.floor(i===3?e*255:e)&255;return t<<8|a},0)>>>0}function Dl(n){return new I([n>>16&255,n>>8&255,n&255],"rgb")}function Il(n){return new I([n>>24&255,n>>16&255,n>>8&255,U(n&255,0,255,0,1)],"rgb")}function Ol(n){return typeof n!="number"?I.black():Dl(n)}function Fl(n){return typeof n!="number"?I.black():Il(n)}function Bl(n){const t=rr(n);return t?(e,i)=>{Ve(e,t(i))}:null}function $l(n){const t=n?Tl:Rl;return(e,i)=>{Ve(e,t(i))}}function Kl(n,t,e){const i=t.toRgbaObject(e);n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b),n.writeProperty("a",i.a)}function Ul(n,t,e){const i=t.toRgbaObject(e);n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b)}function Hl(n,t){return(e,i)=>{n?Kl(e,i,t):Ul(e,i,t)}}function ur(n){var t;return!!(n!=null&&n.alpha||!((t=n==null?void 0:n.color)===null||t===void 0)&&t.alpha)}function jl(n){return n?t=>nr(t,"0x"):t=>Gi(t,"0x")}function zl(n){return"color"in n||"view"in n&&n.view==="color"}const ql={id:"input-color-number",type:"input",accept:(n,t)=>{if(typeof n!="number"||!zl(t))return null;const e=Zn(t);return e?{initialValue:n,params:e}:null},binding:{reader:n=>ur(n.params)?Fl:Ol,equals:I.equals,writer:n=>$l(ur(n.params))},controller:n=>{const t=ur(n.params),e="expanded"in n.params?n.params.expanded:void 0,i="picker"in n.params?n.params.picker:void 0;return new lr(n.document,{colorType:"int",expanded:e??!1,formatter:jl(t),parser:er("int"),pickerLayout:i??"popup",supportsAlpha:t,value:n.value,viewProps:n.viewProps})}};function Gl(n){return I.isRgbaColorObject(n)}function Yl(n){return t=>Ll(t,n)}function Xl(n,t){return e=>n?Wi(e,t):Xi(e,t)}const Wl={id:"input-color-object",type:"input",accept:(n,t)=>{if(!I.isColorObject(n))return null;const e=Zn(t);return e?{initialValue:n,params:e}:null},binding:{reader:n=>Yl(Bt(n.params)),equals:I.equals,writer:n=>Hl(Gl(n.initialValue),Bt(n.params))},controller:n=>{var t;const e=I.isRgbaColorObject(n.initialValue),i="expanded"in n.params?n.params.expanded:void 0,a="picker"in n.params?n.params.picker:void 0,p=(t=Bt(n.params))!==null&&t!==void 0?t:"int";return new lr(n.document,{colorType:p,expanded:i??!1,formatter:Xl(e,p),parser:er(p),pickerLayout:a??"popup",supportsAlpha:e,value:n.value,viewProps:n.viewProps})}},Ql={id:"input-color-string",type:"input",accept:(n,t)=>{if(typeof n!="string"||"view"in t&&t.view==="text")return null;const e=tr(n,Bt(t));if(!e||!rr(e))return null;const a=Zn(t);return a?{initialValue:n,params:a}:null},binding:{reader:n=>{var t;return cl((t=Bt(n.params))!==null&&t!==void 0?t:"int")},equals:I.equals,writer:n=>{const t=tr(n.initialValue,Bt(n.params));if(!t)throw w.shouldNeverHappen();const e=Bl(t);if(!e)throw w.notBindable();return e}},controller:n=>{const t=tr(n.initialValue,Bt(n.params));if(!t)throw w.shouldNeverHappen();const e=rr(t);if(!e)throw w.shouldNeverHappen();const i="expanded"in n.params?n.params.expanded:void 0,a="picker"in n.params?n.params.picker:void 0;return new lr(n.document,{colorType:t.type,expanded:i??!1,formatter:e,parser:er(t.type),pickerLayout:a??"popup",supportsAlpha:t.alpha,value:n.value,viewProps:n.viewProps})}};class St{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map((i,a)=>{var p,b;return(b=(p=this.components[a])===null||p===void 0?void 0:p.constrain(i))!==null&&b!==void 0?b:i});return this.asm_.fromComponents(e)}}const Ji=g("pndtxt");class Jl{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Ji()),this.textViews.forEach(i=>{const a=t.createElement("div");a.classList.add(Ji("a")),a.appendChild(i.element),this.element.appendChild(a)})}}function Zl(n,t,e){return new Se(n,{arrayPosition:e===0?"fst":e===t.axes.length-1?"lst":"mid",baseStep:t.axes[e].baseStep,parser:t.parser,props:t.axes[e].textProps,value:z(0,{constraint:t.axes[e].constraint}),viewProps:t.viewProps})}class cr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map((i,a)=>Zl(t,e,a)),this.acs_.forEach((i,a)=>{Ee({primary:this.value,secondary:i.value,forward:p=>e.assembly.toComponents(p.rawValue)[a],backward:(p,b)=>{const P=e.assembly.toComponents(p.rawValue);return P[a]=b.rawValue,e.assembly.fromComponents(P)}})}),this.view=new Jl(t,{textViews:this.acs_.map(i=>i.view)})}}function Zi(n,t){return"step"in n&&!_(n.step)?new nn(n.step,t):null}function ts(n){return!_(n.max)&&!_(n.min)?new Qt({max:n.max,min:n.min}):!_(n.max)||!_(n.min)?new hi({max:n.max,min:n.min}):null}function tu(n){const t=bt(n,Qt);if(t)return[t.values.get("min"),t.values.get("max")];const e=bt(n,hi);return e?[e.minValue,e.maxValue]:[void 0,void 0]}function eu(n,t){const e=[],i=Zi(n,t);i&&e.push(i);const a=ts(n);a&&e.push(a);const p=Jn(n.options);return p&&e.push(p),new we(e)}const nu={id:"input-number",type:"input",accept:(n,t)=>{if(typeof n!="number")return null;const e=K,i=G(t,{format:e.optional.function,max:e.optional.number,min:e.optional.number,options:e.optional.custom(on),step:e.optional.number});return i?{initialValue:n,params:i}:null},binding:{reader:n=>wi,constraint:n=>eu(n.params,n.initialValue),writer:n=>Ve},controller:n=>{var t;const e=n.value,i=n.constraint,a=i&&bt(i,xe);if(a)return new ye(n.document,{props:new R({options:a.values.value("options")}),value:e,viewProps:n.viewProps});const p=(t="format"in n.params?n.params.format:void 0)!==null&&t!==void 0?t:Y(an(i,e.rawValue)),b=i&&bt(i,Qt);return b?new Qn(n.document,{baseStep:Jt(i),parser:_t,sliderProps:new R({maxValue:b.values.value("max"),minValue:b.values.value("min")}),textProps:R.fromObject({draggingScale:Zt(i,e.rawValue),formatter:p}),value:e,viewProps:n.viewProps}):new Se(n.document,{baseStep:Jt(i),parser:_t,props:R.fromObject({draggingScale:Zt(i,e.rawValue),formatter:p}),value:e,viewProps:n.viewProps})}};class Vt{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(_(t))return!1;const e=t.x,i=t.y;return!(typeof e!="number"||typeof i!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const es={toComponents:n=>n.getComponents(),fromComponents:n=>new Vt(...n)},ee=g("p2d");class ru{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ee()),e.viewProps.bindClassModifiers(this.element),D(e.expanded,F(this.element,ee(void 0,"expanded")));const i=t.createElement("div");i.classList.add(ee("h")),this.element.appendChild(i);const a=t.createElement("button");a.classList.add(ee("b")),a.appendChild(Ze(t,"p2dpad")),e.viewProps.bindDisabled(a),i.appendChild(a),this.buttonElement=a;const p=t.createElement("div");if(p.classList.add(ee("t")),i.appendChild(p),this.textElement=p,e.pickerLayout==="inline"){const b=t.createElement("div");b.classList.add(ee("p")),this.element.appendChild(b),this.pickerElement=b}else this.pickerElement=null}}const At=g("p2dp");class iu{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(At()),e.layout==="popup"&&this.element.classList.add(At(void 0,"p")),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("div");i.classList.add(At("p")),e.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const a=t.createElementNS(ct,"svg");a.classList.add(At("g")),this.padElement.appendChild(a),this.svgElem_=a;const p=t.createElementNS(ct,"line");p.classList.add(At("ax")),p.setAttributeNS(null,"x1","0"),p.setAttributeNS(null,"y1","50%"),p.setAttributeNS(null,"x2","100%"),p.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(p);const b=t.createElementNS(ct,"line");b.classList.add(At("ax")),b.setAttributeNS(null,"x1","50%"),b.setAttributeNS(null,"y1","0"),b.setAttributeNS(null,"x2","50%"),b.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(b);const P=t.createElementNS(ct,"line");P.classList.add(At("l")),P.setAttributeNS(null,"x1","50%"),P.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(P),this.lineElem_=P;const A=t.createElement("div");A.classList.add(At("m")),this.padElement.appendChild(A),this.markerElem_=A,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),i=this.maxValue_,a=U(t,-i,+i,0,100),p=U(e,-i,+i,0,100),b=this.invertsY_?100-p:p;this.lineElem_.setAttributeNS(null,"x2",`${a}%`),this.lineElem_.setAttributeNS(null,"y2",`${b}%`),this.markerElem_.style.left=`${a}%`,this.markerElem_.style.top=`${b}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function ns(n,t,e){return[rt(t[0],gt(n)),rt(t[1],ke(n))*(e?1:-1)]}class su{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new iu(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Dt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const i=this.maxValue_,a=U(t.point.x,0,t.bounds.width,-i,+i),p=U(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-i,+i);this.value.setRawValue(new Vt(a,p),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){yi(t.key)&&t.preventDefault();const[e,i]=ns(t,this.baseSteps_,this.invertsY_);e===0&&i===0||this.value.setRawValue(new Vt(this.value.rawValue.x+e,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,i]=ns(t,this.baseSteps_,this.invertsY_);e===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class ou{constructor(t,e){var i,a;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=ve.create(e.expanded),this.popC_=e.pickerLayout==="popup"?new di(t,{viewProps:this.viewProps}):null;const p=new su(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});p.view.allFocusableElements.forEach(b=>{b.addEventListener("blur",this.onPopupChildBlur_),b.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=p,this.textC_=new cr(t,{assembly:es,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new ru(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(a=this.view.buttonElement)===null||a===void 0||a.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ee({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:b=>b.rawValue,backward:(b,P)=>P.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Dn(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,i=t.relatedTarget;(!i||!e.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,i=Wr(t);i&&e.contains(i)||i&&i===this.view.buttonElement&&!Tn(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.view.buttonElement.focus()}}class ne{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(_(t))return!1;const e=t.x,i=t.y,a=t.z;return!(typeof e!="number"||typeof i!="number"||typeof a!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const rs={toComponents:n=>n.getComponents(),fromComponents:n=>new ne(...n)};function au(n){return ne.isObject(n)?new ne(n.x,n.y,n.z):new ne}function lu(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y),n.writeProperty("z",t.z)}function uu(n,t){return new St({assembly:rs,components:[wt("x"in n?n.x:void 0,t.x),wt("y"in n?n.y:void 0,t.y),wt("z"in n?n.z:void 0,t.z)]})}function hr(n,t){return{baseStep:Jt(t),constraint:t,textProps:R.fromObject({draggingScale:Zt(t,n),formatter:Y(an(t,n))})}}const cu={id:"input-point3d",type:"input",accept:(n,t)=>{if(!ne.isObject(n))return null;const e=K,i=G(t,{x:e.optional.custom(Et),y:e.optional.custom(Et),z:e.optional.custom(Et)});return i?{initialValue:n,params:i}:null},binding:{reader:n=>au,constraint:n=>uu(n.params,n.initialValue),equals:ne.equals,writer:n=>lu},controller:n=>{const t=n.value,e=n.constraint;if(!(e instanceof St))throw w.shouldNeverHappen();return new cr(n.document,{assembly:rs,axes:[hr(t.rawValue.x,e.components[0]),hr(t.rawValue.y,e.components[1]),hr(t.rawValue.z,e.components[2])],parser:_t,value:t,viewProps:n.viewProps})}};class re{constructor(t=0,e=0,i=0,a=0){this.x=t,this.y=e,this.z=i,this.w=a}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(_(t))return!1;const e=t.x,i=t.y,a=t.z,p=t.w;return!(typeof e!="number"||typeof i!="number"||typeof a!="number"||typeof p!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const is={toComponents:n=>n.getComponents(),fromComponents:n=>new re(...n)};function hu(n){return re.isObject(n)?new re(n.x,n.y,n.z,n.w):new re}function pu(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y),n.writeProperty("z",t.z),n.writeProperty("w",t.w)}function du(n,t){return new St({assembly:is,components:[wt("x"in n?n.x:void 0,t.x),wt("y"in n?n.y:void 0,t.y),wt("z"in n?n.z:void 0,t.z),wt("w"in n?n.w:void 0,t.w)]})}function fu(n,t){return{baseStep:Jt(t),constraint:t,textProps:R.fromObject({draggingScale:Zt(t,n),formatter:Y(an(t,n))})}}const vu={id:"input-point4d",type:"input",accept:(n,t)=>{if(!re.isObject(n))return null;const e=K,i=G(t,{x:e.optional.custom(Et),y:e.optional.custom(Et),z:e.optional.custom(Et),w:e.optional.custom(Et)});return i?{initialValue:n,params:i}:null},binding:{reader:n=>hu,constraint:n=>du(n.params,n.initialValue),equals:re.equals,writer:n=>pu},controller:n=>{const t=n.value,e=n.constraint;if(!(e instanceof St))throw w.shouldNeverHappen();return new cr(n.document,{assembly:is,axes:t.rawValue.getComponents().map((i,a)=>fu(i,e.components[a])),parser:_t,value:t,viewProps:n.viewProps})}};function mu(n){const t=[],e=Jn(n.options);return e&&t.push(e),new we(t)}const bu={id:"input-string",type:"input",accept:(n,t)=>{if(typeof n!="string")return null;const i=G(t,{options:K.optional.custom(on)});return i?{initialValue:n,params:i}:null},binding:{reader:n=>xi,constraint:n=>mu(n.params),writer:n=>Ve},controller:n=>{const t=n.document,e=n.value,i=n.constraint,a=i&&bt(i,xe);return a?new ye(t,{props:new R({options:a.values.value("options")}),value:e,viewProps:n.viewProps}):new rn(t,{parser:p=>p,props:R.fromObject({formatter:Gn}),value:e,viewProps:n.viewProps})}},Me={monitor:{defaultInterval:200,defaultLineCount:3}},ss=g("mll");class _u{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(ss()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("textarea");i.classList.add(ss("i")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,i.readOnly=!0,e.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,i=[];this.value.rawValue.forEach(a=>{a!==void 0&&i.push(this.formatter_(a))}),t.textContent=i.join(`
`),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class pr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new _u(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const os=g("sgl");class gu{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(os()),e.viewProps.bindClassModifiers(this.element);const i=t.createElement("input");i.classList.add(os("i")),i.readOnly=!0,i.type="text",e.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=e!==void 0?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class dr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new gu(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const wu={id:"monitor-bool",type:"monitor",accept:(n,t)=>{if(typeof n!="boolean")return null;const i=G(t,{lineCount:K.optional.number});return i?{initialValue:n,params:i}:null},binding:{reader:n=>vi},controller:n=>{var t;return n.value.rawValue.length===1?new dr(n.document,{formatter:mi,value:n.value,viewProps:n.viewProps}):new pr(n.document,{formatter:mi,lineCount:(t=n.params.lineCount)!==null&&t!==void 0?t:Me.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}},Mt=g("grl");class xu{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Mt()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=t.createElementNS(ct,"svg");i.classList.add(Mt("g")),i.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const a=t.createElementNS(ct,"polyline");this.svgElem_.appendChild(a),this.lineElem_=a;const p=t.createElement("div");p.classList.add(Mt("t"),g("tt")()),this.element.appendChild(p),this.tooltipElem_=p,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,i=this.props_.get("minValue"),a=this.props_.get("maxValue"),p=[];this.value.rawValue.forEach((B,$)=>{if(B===void 0)return;const $t=U($,0,e,0,t.width),Ne=U(B,i,a,t.height,0);p.push([$t,Ne].join(","))}),this.lineElem_.setAttributeNS(null,"points",p.join(" "));const b=this.tooltipElem_,P=this.value.rawValue[this.cursor_.rawValue];if(P===void 0){b.classList.remove(Mt("t","a"));return}const A=U(this.cursor_.rawValue,0,e,0,t.width),N=U(P,i,a,t.height,0);b.style.left=`${A}px`,b.style.top=`${N}px`,b.textContent=`${this.formatter_(P)}`,b.classList.contains(Mt("t","a"))||(b.classList.add(Mt("t","a"),Mt("t","in")),Je(b),b.classList.remove(Mt("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class yu{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=z(-1),this.view=new xu(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!Tn(t))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Dt(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(U(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){if(!t.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(U(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function fr(n){return"format"in n&&!_(n.format)?n.format:Y(2)}function Cu(n){var t;return n.value.rawValue.length===1?new dr(n.document,{formatter:fr(n.params),value:n.value,viewProps:n.viewProps}):new pr(n.document,{formatter:fr(n.params),lineCount:(t=n.params.lineCount)!==null&&t!==void 0?t:Me.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}function Pu(n){var t,e,i;return new yu(n.document,{formatter:fr(n.params),lineCount:(t=n.params.lineCount)!==null&&t!==void 0?t:Me.monitor.defaultLineCount,props:R.fromObject({maxValue:(e="max"in n.params?n.params.max:null)!==null&&e!==void 0?e:100,minValue:(i="min"in n.params?n.params.min:null)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function as(n){return"view"in n&&n.view==="graph"}const Eu={id:"monitor-number",type:"monitor",accept:(n,t)=>{if(typeof n!="number")return null;const e=K,i=G(t,{format:e.optional.function,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number,view:e.optional.string});return i?{initialValue:n,params:i}:null},binding:{defaultBufferSize:n=>as(n)?64:1,reader:n=>wi},controller:n=>as(n.params)?Pu(n):Cu(n)},ku={id:"monitor-string",type:"monitor",accept:(n,t)=>{if(typeof n!="string")return null;const e=K,i=G(t,{lineCount:e.optional.number,multiline:e.optional.boolean});return i?{initialValue:n,params:i}:null},binding:{reader:n=>xi},controller:n=>{var t;const e=n.value;return e.rawValue.length>1||"multiline"in n.params&&n.params.multiline?new pr(n.document,{formatter:Gn,lineCount:(t=n.params.lineCount)!==null&&t!==void 0?t:Me.monitor.defaultLineCount,value:e,viewProps:n.viewProps}):new dr(n.document,{formatter:Gn,value:e,viewProps:n.viewProps})}};function Su(n,t){var e;const i=n.accept(t.target.read(),t.params);if(_(i))return null;const a=K,p={target:t.target,initialValue:i.initialValue,params:i.params},b=n.binding.reader(p),P=n.binding.constraint?n.binding.constraint(p):void 0,A=z(b(i.initialValue),{constraint:P,equals:n.binding.equals}),N=new Zo({reader:b,target:t.target,value:A,writer:n.binding.writer(p)}),B=a.optional.boolean(t.params.disabled).value,$=a.optional.boolean(t.params.hidden).value,$t=n.controller({constraint:P,document:t.document,initialValue:i.initialValue,params:i.params,value:N.value,viewProps:mt.create({disabled:B,hidden:$})});return new ht(t.document,{binding:N,blade:fe(),props:R.fromObject({label:"label"in t.params?(e=a.optional.string(t.params.label).value)!==null&&e!==void 0?e:null:t.target.key}),valueController:$t})}function Vu(n,t){return t===0?new Qo:new Jo(n,t??Me.monitor.defaultInterval)}function Au(n,t){var e,i,a;const p=K,b=n.accept(t.target.read(),t.params);if(_(b))return null;const P={target:t.target,initialValue:b.initialValue,params:b.params},A=n.binding.reader(P),N=(i=(e=p.optional.number(t.params.bufferSize).value)!==null&&e!==void 0?e:n.binding.defaultBufferSize&&n.binding.defaultBufferSize(b.params))!==null&&i!==void 0?i:1,B=p.optional.number(t.params.interval).value,$=new ra({reader:A,target:t.target,ticker:Vu(t.document,B),value:ta(N)}),$t=p.optional.boolean(t.params.disabled).value,Ne=p.optional.boolean(t.params.hidden).value,Le=n.controller({document:t.document,params:b.params,value:$.value,viewProps:mt.create({disabled:$t,hidden:Ne})});return new Pt(t.document,{binding:$,blade:fe(),props:R.fromObject({label:"label"in t.params?(a=p.optional.string(t.params.label).value)!==null&&a!==void 0?a:null:t.target.key}),valueController:Le})}class Mu{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){t.type==="blade"?this.pluginsMap_.blades.unshift(t):t.type==="input"?this.pluginsMap_.inputs.unshift(t):t.type==="monitor"&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,i){const a=e.read();if(_(a))throw new w({context:{key:e.key},type:"nomatchingcontroller"});const p=this.pluginsMap_.inputs.reduce((b,P)=>b??Su(P,{document:t,target:e,params:i}),null);if(p)return p;throw new w({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,i){const a=this.pluginsMap_.monitors.reduce((p,b)=>p??Au(b,{document:t,params:i,target:e}),null);if(a)return a;throw new w({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const i=this.pluginsMap_.blades.reduce((a,p)=>a??Wo(p,{document:t,params:e}),null);if(!i)throw new w({type:"nomatchingview",context:{params:e}});return i}createBladeApi(t){if(t instanceof ht)return new Fn(t);if(t instanceof Pt)return new Bn(t);if(t instanceof be)return new en(t,this);const e=this.pluginsMap_.blades.reduce((i,a)=>i??a.api({controller:t,pool:this}),null);if(!e)throw w.shouldNeverHappen();return e}}function Nu(){const n=new Mu;return[Ou,cu,vu,bu,nu,Ql,Wl,ql,za,wu,ku,Eu,Ao,Ho,zo,ui].forEach(t=>{n.register(t)}),n}function Lu(n){return Vt.isObject(n)?new Vt(n.x,n.y):new Vt}function Ru(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y)}function wt(n,t){if(!n)return;const e=[],i=Zi(n,t);i&&e.push(i);const a=ts(n);return a&&e.push(a),new we(e)}function Tu(n,t){return new St({assembly:es,components:[wt("x"in n?n.x:void 0,t.x),wt("y"in n?n.y:void 0,t.y)]})}function ls(n,t){const[e,i]=n?tu(n):[];if(!_(e)||!_(i))return Math.max(Math.abs(e??0),Math.abs(i??0));const a=Jt(n);return Math.max(Math.abs(a)*10,Math.abs(t)*10)}function Du(n,t){const e=t instanceof St?t.components[0]:void 0,i=t instanceof St?t.components[1]:void 0,a=ls(e,n.x),p=ls(i,n.y);return Math.max(a,p)}function us(n,t){return{baseStep:Jt(t),constraint:t,textProps:R.fromObject({draggingScale:Zt(t,n),formatter:Y(an(t,n))})}}function Iu(n){if(!("y"in n))return!1;const t=n.y;return t&&"inverted"in t?!!t.inverted:!1}const Ou={id:"input-point2d",type:"input",accept:(n,t)=>{if(!Vt.isObject(n))return null;const e=K,i=G(t,{expanded:e.optional.boolean,picker:e.optional.custom(Ei),x:e.optional.custom(Et),y:e.optional.object({inverted:e.optional.boolean,max:e.optional.number,min:e.optional.number,step:e.optional.number})});return i?{initialValue:n,params:i}:null},binding:{reader:n=>Lu,constraint:n=>Tu(n.params,n.initialValue),equals:Vt.equals,writer:n=>Ru},controller:n=>{const t=n.document,e=n.value,i=n.constraint;if(!(i instanceof St))throw w.shouldNeverHappen();const a="expanded"in n.params?n.params.expanded:void 0,p="picker"in n.params?n.params.picker:void 0;return new ou(t,{axes:[us(e.rawValue.x,i.components[0]),us(e.rawValue.y,i.components[1])],expanded:a??!1,invertsY:Iu(n.params),maxValue:Du(e.rawValue,i),parser:_t,pickerLayout:p??"popup",value:e,viewProps:n.viewProps})}};class cs extends u{constructor(t){super(t),this.emitter_=new E,this.controller_.valueController.value.emitter.on("change",e=>{this.emitter_.emit("change",{event:new h(this,e.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}}class hs extends u{constructor(t){super(t),this.emitter_=new E,this.controller_.valueController.value.emitter.on("change",e=>{this.emitter_.emit("change",{event:new h(this,e.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}}class ps extends u{constructor(t){super(t),this.emitter_=new E,this.controller_.valueController.value.emitter.on("change",e=>{this.emitter_.emit("change",{event:new h(this,e.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const i=e.bind(this);return this.emitter_.on(t,a=>{i(a.event)}),this}}const Fu=function(){return{id:"list",type:"blade",accept(n){const t=K,e=G(n,{options:t.required.custom(on),value:t.required.raw,view:t.required.constant("list"),label:t.optional.string});return e?{params:e}:null},controller(n){const t=new xe(ki(n.params.options)),e=z(n.params.value,{constraint:t}),i=new ye(n.document,{props:new R({options:t.values.value("options")}),value:e,viewProps:n.viewProps});return new Wt(n.document,{blade:n.blade,props:R.fromObject({label:n.params.label}),valueController:i})},api(n){return!(n.controller instanceof Wt)||!(n.controller.valueController instanceof ye)?null:new cs(n.controller)}}}();function Bu(n){return n.reduce((t,e)=>Object.assign(t,{[e.presetKey]:e.read()}),{})}function $u(n,t){n.forEach(e=>{const i=t[e.target.presetKey];i!==void 0&&e.writer(e.target,e.reader(i))})}class Ku extends $n{constructor(t,e){super(t,e)}get element(){return this.controller_.view.element}importPreset(t){const e=this.controller_.rackController.rack.find(ht).map(i=>i.binding);$u(e,t),this.refresh()}exportPreset(){const t=this.controller_.rackController.rack.find(ht).map(e=>e.binding.target);return Bu(t)}refresh(){this.controller_.rackController.rack.find(ht).forEach(t=>{t.binding.read()}),this.controller_.rackController.rack.find(Pt).forEach(t=>{t.binding.read()})}}class Uu extends Hn{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const Hu={id:"slider",type:"blade",accept(n){const t=K,e=G(n,{max:t.required.number,min:t.required.number,view:t.required.constant("slider"),format:t.optional.function,label:t.optional.string,value:t.optional.number});return e?{params:e}:null},controller(n){var t,e;const i=(t=n.params.value)!==null&&t!==void 0?t:0,a=new Qt({max:n.params.max,min:n.params.min}),p=new Qn(n.document,{baseStep:1,parser:_t,sliderProps:new R({maxValue:a.values.value("max"),minValue:a.values.value("min")}),textProps:R.fromObject({draggingScale:Zt(void 0,i),formatter:(e=n.params.format)!==null&&e!==void 0?e:Ta}),value:z(i,{constraint:a}),viewProps:n.viewProps});return new Wt(n.document,{blade:n.blade,props:R.fromObject({label:n.params.label}),valueController:p})},api(n){return!(n.controller instanceof Wt)||!(n.controller.valueController instanceof Qn)?null:new hs(n.controller)}},ju=function(){return{id:"text",type:"blade",accept(n){const t=K,e=G(n,{parse:t.required.function,value:t.required.raw,view:t.required.constant("text"),format:t.optional.function,label:t.optional.string});return e?{params:e}:null},controller(n){var t;const e=new rn(n.document,{parser:n.params.parse,props:R.fromObject({formatter:(t=n.params.format)!==null&&t!==void 0?t:i=>String(i)}),value:z(n.params.value),viewProps:n.viewProps});return new Wt(n.document,{blade:n.blade,props:R.fromObject({label:n.params.label}),valueController:e})},api(n){return!(n.controller instanceof Wt)||!(n.controller.valueController instanceof rn)?null:new ps(n.controller)}}}();function zu(n){const t=n.createElement("div");return t.classList.add(g("dfw")()),n.body&&n.body.appendChild(t),t}function ds(n,t,e){if(n.querySelector(`style[data-tp-style=${t}]`))return;const i=n.createElement("style");i.dataset.tpStyle=t,i.textContent=e,n.head.appendChild(i)}class qu extends Ku{constructor(t){var e,i;const a=t??{},p=(e=a.document)!==null&&e!==void 0?e:Po(),b=Nu(),P=new Uu(p,{expanded:a.expanded,blade:fe(),props:R.fromObject({title:a.title}),viewProps:mt.create()});super(P,b),this.pool_=b,this.containerElem_=(i=a.container)!==null&&i!==void 0?i:zu(p),this.containerElem_.appendChild(this.element),this.doc_=p,this.usesDefaultWrapper_=!a.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw w.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw w.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach(i=>{this.pool_.register(i),this.embedPluginStyle_(i)})}embedPluginStyle_(t){t.css&&ds(this.document,`plugin-${t.id}`,t.css)}setUpDefaultPlugins_(){ds(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(t=>{this.embedPluginStyle_(t)}),this.registerPlugin({plugins:[Hu,Fu,ui,ju]})}}const Gu=new l("3.1.10");o.BladeApi=u,o.ButtonApi=S,o.FolderApi=$n,o.InputBindingApi=Fn,o.ListApi=cs,o.MonitorBindingApi=Bn,o.Pane=qu,o.SeparatorApi=ei,o.SliderApi=hs,o.TabApi=oi,o.TabPageApi=si,o.TextApi=ps,o.TpChangeEvent=h,o.VERSION=Gu,Object.defineProperty(o,"__esModule",{value:!0})})})(Sr,Sr.exports);var qd=Sr.exports;function Gd(r,s){const o=r+1,l=s+1,u=Array.from({length:o*l},(v,_)=>({index:_})),c=[];for(let v=0;v<s;v++)for(let _=0;_<r;_++){const x=v*r+_;c.push({index:x,vertices:[x+v,x+v+1,x+v+r+2,x+v+r+1]})}function h(v,_){return _*o+v}const d=[],m=[],f=[];for(let v=0;v<l;v++)for(let _=0;_<o;_++)_>0&&(f.push({source:h(_-1,v),target:h(_,v)}),v<l-1&&m.push({source:h(_-1,v),target:h(_,v+1),stitch:h(_,v)-(v+1)}),v<l-1&&m.push({source:h(_,v),target:h(_-1,v+1),stitch:h(_,v)-(v+1)}),_<o-1&&d.push({source:h(_-1,v),target:h(_+1,v)})),v>0&&(f.push({source:h(_,v-1),target:h(_,v)}),v<l-1&&d.push({source:h(_,v-1),target:h(_,v+1)}));return{faces:c,vertices:u,strutLinks:d,shearLinks:m,stretchLinks:f}}const _r={default:{width:20,height:20,enableStretch:!0,edge_length:49,K_STRETCH:4,enableShear:!0,shear_ratio:.5,K_SHEAR:.5,enableStrut:!0,K_STRUT:2.5,enableCharge:!0,chargeStrength:-25,maxChargeDistance:.5,backgroundColor:"#192d3a",showFaces:!0,faceColor:"#327aa87c",showVertices:!1,vertexColor:"#16363867",vertexRadius:3,showStretch:!0,stretchColor:"#3078a67c",showShear:!1,shearColor:"#3a7d227c",showStrut:!1,strutColor:"#b062a57c",forceStrokeWidth:1,enableCollision:!1,iterations:3},linkageThing:{width:2,height:3,enableStretch:!0,edge_length:196.38,K_STRETCH:5,enableShear:!1,shear_ratio:.5,K_SHEAR:.5,enableStrut:!1,K_STRUT:2.5,enableCharge:!1,chargeStrength:-25,maxChargeDistance:.5,backgroundColor:"#efbd59",showFaces:!1,faceColor:"#327aa87c",showVertices:!0,vertexColor:"#16363867",vertexRadius:12,showStretch:!0,stretchColor:"#3078a67c",showShear:!1,shearColor:"#3a7d227c",showStrut:!1,strutColor:"#b062a57c",forceStrokeWidth:24,enableCollision:!0,iterations:3},allForces:{width:20,height:20,enableStretch:!0,edge_length:31,K_STRETCH:4,enableShear:!0,shear_ratio:.5,K_SHEAR:.5,enableStrut:!0,K_STRUT:2.5,enableCharge:!0,chargeStrength:-25,maxChargeDistance:.5,backgroundColor:"#ffffff",showFaces:!0,faceColor:"#327aa87c",showVertices:!0,vertexColor:"#4553aab9",vertexRadius:3,showStretch:!0,stretchColor:"#3078a67c",showShear:!0,shearColor:"#3a7d227c",showStrut:!0,strutColor:"#b062a57c",forceStrokeWidth:1,enableCollision:!1,iterations:3},bubbles:{width:15,height:15,enableStretch:!0,edge_length:52,K_STRETCH:4,enableShear:!0,shear_ratio:.5,K_SHEAR:.5,enableStrut:!0,K_STRUT:2.5,enableCharge:!1,chargeStrength:-95,maxChargeDistance:2.7,backgroundColor:"#a24747",showFaces:!1,faceColor:"#327aa87c",showVertices:!0,vertexColor:"#95a3ffb9",vertexRadius:23,showStretch:!0,stretchColor:"#3078a67c",showShear:!0,shearColor:"#3a7d227c",showStrut:!0,strutColor:"#b062a57c",forceStrokeWidth:1,enableCollision:!0,iterations:3},wispy:{width:30,height:30,enableStretch:!0,edge_length:32.73,K_STRETCH:5,enableShear:!1,shear_ratio:.5,K_SHEAR:.5,enableStrut:!0,K_STRUT:2.5,enableCharge:!1,chargeStrength:-25,maxChargeDistance:.5,backgroundColor:"#d59f9f",showFaces:!0,faceColor:"#cfe7f67c",showVertices:!1,vertexColor:"#16363867",vertexRadius:3,showStretch:!0,stretchColor:"#a5304f7c",showShear:!1,shearColor:"#3a7d227c",showStrut:!1,strutColor:"#b062a57c",forceStrokeWidth:1,enableCollision:!1,iterations:3},wireframe:{width:10,height:10,enableStretch:!0,edge_length:98.19,K_STRETCH:4,enableShear:!0,shear_ratio:.5,K_SHEAR:.5,enableStrut:!0,K_STRUT:2.5,enableCharge:!0,chargeStrength:-150,maxChargeDistance:10,backgroundColor:"#00436f",showFaces:!0,faceColor:"#327aa87c",showVertices:!0,vertexColor:"#061a64aa",vertexRadius:7,showStretch:!0,stretchColor:"#c0b690b9",showShear:!0,shearColor:"#96a78f1f",showStrut:!0,strutColor:"#d1b47a32",forceStrokeWidth:4,enableCollision:!1,iterations:3},nofoldy:{width:15,height:20,enableStretch:!0,edge_length:44,K_STRETCH:5,enableShear:!0,shear_ratio:1,K_SHEAR:3,enableStrut:!0,K_STRUT:4,enableCharge:!0,chargeStrength:-780,maxChargeDistance:10,backgroundColor:"#74c7c9",showFaces:!0,faceColor:"#a76d317c",showVertices:!1,vertexColor:"#16363867",vertexRadius:3,showStretch:!0,stretchColor:"#a530307c",showShear:!0,shearColor:"#e0bc368c",showStrut:!1,strutColor:"#b062a57c",forceStrokeWidth:1,enableCollision:!1,iterations:3}},le=Oe("svg");let X,oo,Rt,Br,$r,Kr,zt,qt,Gt,He,Yt,ao=window.innerWidth,lo=window.innerHeight,dt=!1;const k={width:20,height:20,enableShear:!0,K_SHEAR:.5,shear_ratio:.5,enableStretch:!0,K_STRETCH:4,edge_length:20,enableStrut:!0,K_STRUT:2.5,enableCharge:!0,chargeStrength:-25,maxChargeDistance:.5,showFaces:!0,showVertices:!1,backgroundColor:"#192d3a",faceColor:"#327aa87c",vertexColor:"#16363867",vertexRadius:3,showStretch:!0,stretchColor:"#3078a67c",showStrut:!1,strutColor:"#b062a57c",showShear:!1,shearColor:"#3a7d227c",forceStrokeWidth:1,enableCollision:!1,iterations:3},Ct=new qd.Pane({title:"Wabric"});Ct.addBlade({view:"list",label:"Load Preset",options:Object.keys(_r).map(r=>({value:r,text:r})),value:Object.keys(_r)[0]}).on("change",r=>{dt=!0,bo(),Object.entries(_r[r.value]).forEach(([s,o])=>k[s]=o),Ct.refresh(),dt=!1,Mn()});Ct.addInput(k,"width",{min:1,step:1}).on("change",Mn);Ct.addInput(k,"height",{min:1,step:1}).on("change",Mn);const et=Ct.addFolder({title:"Forces"});et.addInput(k,"enableStretch",{label:"Stretch Forces"}).on("change",st);et.addInput(k,"edge_length",{label:"Edge Length",min:10,max:200,step:1}).on("change",st);et.addInput(k,"K_STRETCH",{label:"K_stretch"}).on("change",st);et.addSeparator();et.addInput(k,"enableShear",{label:"Shear Forces"}).on("change",st);et.addInput(k,"shear_ratio",{label:"Shear Ratio"}).on("change",st);et.addInput(k,"K_SHEAR",{label:"K_shear"}).on("change",st);et.addSeparator();et.addInput(k,"enableStrut",{label:"Strut Forces"}).on("change",st);et.addInput(k,"K_STRUT",{label:"K_strut"}).on("change",st);et.addSeparator();et.addInput(k,"enableCharge",{label:"Charge"}).on("change",st);et.addInput(k,"chargeStrength",{label:"Charge Strength",min:-1e3,max:0,step:5}).on("change",st);et.addInput(k,"maxChargeDistance",{label:"Max Charge Distance",min:0,max:10,step:.1}).on("change",st);const W=Ct.addFolder({title:"Viz"});W.addInput(k,"backgroundColor",{label:"Background Color"}).on("change",mo);W.addInput(k,"showFaces",{label:"Draw Faces"}).on("change",()=>{ho(),ue()});W.addInput(k,"faceColor",{label:"Face Color"}).on("change",()=>{He&&He.attr("fill",k.faceColor)});W.addSeparator();W.addInput(k,"showVertices",{label:"Draw Vertices"}).on("change",()=>{co(),ue()});W.addInput(k,"vertexColor",{label:"Vertex Color"}).on("change",()=>{Yt&&Yt.attr("fill",k.vertexColor)});W.addInput(k,"vertexRadius",{label:"Vertex Radius",min:2,max:30,step:1}).on("change",()=>{Yt&&Yt.attr("r",k.vertexRadius)});W.addSeparator();W.addInput(k,"showStretch",{label:"Draw Stretch"}).on("change",()=>{po(),ue()});W.addInput(k,"stretchColor",{label:"Stretch Color"}).on("change",()=>{zt&&zt.attr("stroke",k.stretchColor)});W.addInput(k,"showShear",{label:"Draw Shear"}).on("change",()=>{fo(),ue()});W.addInput(k,"shearColor",{label:"Shear Color"}).on("change",()=>{qt&&qt.attr("stroke",k.shearColor)});W.addInput(k,"showStrut",{label:"Draw Strut"}).on("change",()=>{vo(),ue()});W.addInput(k,"strutColor",{label:"Strut Color"}).on("change",()=>{Gt&&Gt.attr("stroke",k.strutColor)});W.addInput(k,"forceStrokeWidth",{label:"Link Stroke Width",min:1,max:30,step:1}).on("change",()=>{zt&&zt.attr("stroke-width",k.forceStrokeWidth),qt&&qt.attr("stroke-width",k.forceStrokeWidth),Gt&&Gt.attr("stroke-width",k.forceStrokeWidth)});(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&(Ct.expanded=!1,et.expanded=!1,W.expanded=!1);const Ur=Ct.addFolder({title:"Advanced",expanded:!1});Ur.addInput(k,"enableCollision",{label:"Vertex Collision"}).on("change",st);Ur.addInput(k,"iterations",{label:"Iterations",min:1,max:15,step:1}).on("change",st);Ur.addButton({title:"Copy settings to clipboard"}).on("click",()=>{navigator.clipboard.writeText(JSON.stringify(Ct.exportPreset()))});function Yd(r){return Fr(r).distance(2*k.edge_length).strength(k.K_STRUT).iterations(k.iterations)}function Xd(r){return Fr(r).distance(k.shear_ratio*Math.sqrt(2*Math.pow(k.edge_length,2))).strength(k.K_SHEAR).iterations(k.iterations)}function Wd(r){return Fr(r).distance(k.edge_length).strength(k.K_STRETCH).iterations(k.iterations)}function uo(r){return md(ao/2,lo/2).strength(r??1)}function Qd(){return so().strength(k.chargeStrength).distanceMax(k.maxChargeDistance*k.edge_length)}function Jd(){return Dd().radius(k.vertexRadius)}function Zd(){return so().strength(-150).distanceMax(5*k.edge_length)}function st(){dt||(X.force("strut",k.enableStrut?Yd(Kr):null),X.force("shear",k.enableShear?Xd($r):null),X.force("stretch",k.enableStretch?Wd(Br):null),X.force("charge",k.enableCharge?Qd():null),X.force("collision",k.enableCollision?Jd():null),X.restart(),X.alpha(.4))}function co(){dt||(k.showVertices?(Yt=le.append("g").attr("class","vertices").selectAll().data(Rt).join("circle").attr("r",k.vertexRadius).attr("fill",k.vertexColor),Yt.call(qe().on("start",r=>Ye(r,"vertex")).on("drag",r=>Xe(r,"vertex")).on("end",r=>We(r,"vertex")))):ze(".vertices").remove())}function ho(){dt||(k.showFaces?(He=le.append("g").attr("class","faces").selectAll().data(oo).join("polygon").attr("fill",k.faceColor),He.call(qe().on("start",r=>Ye(r,"face")).on("drag",r=>Xe(r,"face")).on("end",r=>We(r,"face")))):ze(".faces").remove())}function po(){dt||(k.showStretch?(zt=le.append("g").attr("class","stretch").selectAll("line").data(Br).enter().append("line").attr("stroke-linecap","round").attr("stroke",k.stretchColor).attr("stroke-width",k.forceStrokeWidth),zt.call(qe().on("start",r=>Ye(r,"link")).on("drag",r=>Xe(r,"link")).on("end",r=>We(r,"link")))):ze(".stretch").remove())}function fo(){dt||(k.showShear?(qt=le.append("g").attr("class","shear").selectAll("line").data($r).enter().append("line").attr("stroke-linecap","round").attr("stroke",k.shearColor).attr("stroke-width",k.forceStrokeWidth),qt.call(qe().on("start",r=>Ye(r,"link")).on("drag",r=>Xe(r,"link")).on("end",r=>We(r,"link")))):ze(".shear").remove())}function vo(){dt||(k.showStrut?(Gt=le.append("g").attr("class","strut").selectAll("line").data(Kr).enter().append("line").attr("stroke-linecap","round").attr("stroke",k.strutColor).attr("stroke-width",k.forceStrokeWidth),Gt.call(qe().on("start",r=>Ye(r,"link")).on("drag",r=>Xe(r,"link")).on("end",r=>We(r,"link")))):ze(".strut").remove())}function ue(){dt||(k.showStretch&&zt.attr("x1",r=>r.source.x).attr("y1",r=>r.source.y).attr("x2",r=>r.target.x).attr("y2",r=>r.target.y),k.showShear&&qt.attr("x1",r=>r.source.x).attr("y1",r=>r.source.y).attr("x2",r=>r.target.x).attr("y2",r=>r.target.y),k.showStrut&&Gt.attr("x1",r=>r.source.x).attr("y1",r=>r.source.y).attr("x2",r=>r.target.x).attr("y2",r=>r.target.y),k.showVertices&&Yt.attr("cx",r=>r.x).attr("cy",r=>r.y),k.showFaces&&He.attr("points",r=>r.vertices.reduce((s,o)=>`${s} ${Rt[o].x},${Rt[o].y}`,"")))}function Ye(r,s){r.active||X.alphaTarget(.3).restart(),X.force("center",null);let o=r.subject;s=="face"?o.vertices.forEach(l=>{const u=Rt[l];u.fx=u.x,u.fy=u.y}):s=="vertex"?(o.fx=o.x,o.fy=o.y):s=="link"&&(o.source.fx=o.source.x,o.source.fy=o.source.y,o.target.fx=o.target.x,o.target.fy=o.target.y)}function Xe(r,s){let o=r.subject;s=="face"?o.vertices.forEach(l=>{const u=Rt[l];u.fx+=r.dx,u.fy+=r.dy}):s=="vertex"?(o.fx=r.x,o.fy=r.y):s=="link"&&(o.source.fx+=r.dx,o.source.fy+=r.dy,o.target.fx+=r.dx,o.target.fy+=r.dy)}function We(r,s){r.active||X.alphaTarget(0),X.force("center",uo(.05));let o=r.subject;s=="face"?o.vertices.forEach(l=>{const u=Rt[l];u.fx=null,u.fy=null}):s=="vertex"?(o.fx=null,o.fy=null):s=="link"&&(o.source.fx=null,o.source.fy=null,o.target.fx=null,o.target.fy=null)}function mo(){document.body.style.backgroundColor=k.backgroundColor}function tf(){k.edge_length=.9*Math.min(lo,ao)/Math.max(k.width,k.height)}function ef(){X.force("unfold",Zd()),setTimeout(()=>{X.force("unfold",null)},"300")}function bo(){X&&(X.stop(),X=null),le.selectChildren().remove()}function Mn(){dt||(bo(),tf(),{faces:oo,vertices:Rt,stretchLinks:Br,shearLinks:$r,strutLinks:Kr}=Gd(k.width,k.height),X=jd(Rt).force("center",uo(1)).on("tick",ue),mo(),ho(),fo(),vo(),po(),co(),st(),ef())}window.onload=()=>{Mn()};
